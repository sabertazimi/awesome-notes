<svg xmlns="http://www.w3.org/2000/svg" width="900" height="550" viewBox="0 0 900 550"><defs><linearGradient id="bgGrad3" x1="0%" x2="100%" y1="0%" y2="100%"><stop offset="0%" style="stop-color:#1e293b"/><stop offset="100%" style="stop-color:#0f172a"/></linearGradient><marker id="arrowCyan" markerHeight="10" markerWidth="10" orient="auto" refX="9" refY="3"><path fill="#06b6d4" d="M0,0 L0,6 L9,3 z"/></marker><marker id="arrowPurple" markerHeight="10" markerWidth="10" orient="auto" refX="9" refY="3"><path fill="#a855f7" d="M0,0 L0,6 L9,3 z"/></marker><marker id="arrowGreen2" markerHeight="10" markerWidth="10" orient="auto" refX="9" refY="3"><path fill="#22c55e" d="M0,0 L0,6 L9,3 z"/></marker></defs><rect width="900" height="550" fill="url(#bgGrad3)"/><text x="450" y="35" fill="#f8fafc" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" text-anchor="middle">How useEffectEvent Actually Works</text><text x="450" y="55" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="13" text-anchor="middle">(It&apos;s the same pattern as useRef, but React does it for you!)</text><g transform="translate(150, 150)"><text x="0" y="-30" fill="#06b6d4" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Step 1: Stable Wrapper</text><rect width="200" height="120" x="-100" y="-10" fill="#164e63" stroke="#06b6d4" stroke-width="3" rx="10"/><text x="0" y="15" fill="#67e8f9" font-family="Monaco, monospace" font-size="11" text-anchor="middle">stableWrapper</text><text x="0" y="35" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="10" text-anchor="middle">Same function identity</text><text x="0" y="50" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="10" text-anchor="middle">across ALL renders</text><rect width="80" height="35" x="-40" y="60" fill="#0e7490" rx="4"/><text x="0" y="82" fill="#fff" font-family="Monaco, monospace" font-size="11" text-anchor="middle">(...args)</text><text x="0" y="125" fill="#22d3ee" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle">Created once, never changes</text></g><g transform="translate(450, 150)"><text x="0" y="-30" fill="#a855f7" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Step 2: Internal Ref</text><rect width="220" height="120" x="-110" y="-10" fill="#3b0764" stroke="#a855f7" stroke-width="3" rx="10"/><text x="0" y="15" fill="#c084fc" font-family="Monaco, monospace" font-size="11" text-anchor="middle">latestCallbackRef</text><text x="0" y="35" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="10" text-anchor="middle">Hidden ref managed by React</text><rect width="180" height="50" x="-90" y="50" fill="#581c87" stroke="#a855f7" stroke-width="2" rx="6"/><text x="0" y="70" fill="#e9d5ff" font-family="Monaco, monospace" font-size="10" text-anchor="middle">.current = () =&gt; {</text><text x="0" y="85" fill="#4ade80" font-family="Monaco, monospace" font-size="10" text-anchor="middle">// latest closure!</text><text x="0" y="95" fill="#e9d5ff" font-family="Monaco, monospace" font-size="10" text-anchor="middle">}</text><text x="0" y="125" fill="#c084fc" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle">Updated after EVERY render</text></g><g transform="translate(750, 150)"><text x="0" y="-30" fill="#22c55e" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Step 3: Your Effect</text><rect width="200" height="120" x="-100" y="-10" fill="#14532d" stroke="#22c55e" stroke-width="3" rx="10"/><text x="0" y="15" fill="#4ade80" font-family="Monaco, monospace" font-size="11" text-anchor="middle">useEffect(() =&gt; {</text><text x="0" y="35" fill="#94a3b8" font-family="Monaco, monospace" font-size="10" text-anchor="middle">socket.on(&apos;msg&apos;,</text><text x="0" y="52" fill="#67e8f9" font-family="Monaco, monospace" font-size="11" text-anchor="middle">stableWrapper</text><text x="0" y="68" fill="#94a3b8" font-family="Monaco, monospace" font-size="10" text-anchor="middle">);</text><text x="0" y="85" fill="#4ade80" font-family="Monaco, monospace" font-size="11" text-anchor="middle">}, [roomId]);</text><text x="0" y="125" fill="#22c55e" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle">Registered ONCE</text></g><line x1="260" x2="330" y1="180" y2="180" stroke="#a855f7" stroke-dasharray="6 3" stroke-width="2" marker-end="url(#arrowPurple)"/><text x="295" y="170" fill="#c084fc" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle">delegates to</text><line x1="570" x2="640" y1="180" y2="180" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowGreen2)"/><text x="605" y="170" fill="#4ade80" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle">passes</text><g transform="translate(450, 350)"><rect width="800" height="180" x="-400" y="-40" fill="#0f172a" stroke="#475569" stroke-width="2" rx="12"/><text x="0" y="-15" fill="#f8fafc" font-family="system-ui, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">The &quot;Magic&quot; Revealed: What Happens When Called</text><g transform="translate(-300, 30)"><rect width="130" height="50" x="0" y="0" fill="#164e63" stroke="#06b6d4" stroke-width="2" rx="6"/><text x="65" y="20" fill="#67e8f9" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Event Fires</text><text x="65" y="38" fill="#94a3b8" font-family="Monaco, monospace" font-size="10" text-anchor="middle">socket message</text></g><line x1="-160" x2="-100" y1="55" y2="55" stroke="#64748b" stroke-width="2" marker-end="url(#arrowCyan)"/><g transform="translate(-30, 30)"><rect width="130" height="50" x="0" y="0" fill="#164e63" stroke="#06b6d4" stroke-width="2" rx="6"/><text x="65" y="20" fill="#67e8f9" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Wrapper Called</text><text x="65" y="38" fill="#94a3b8" font-family="Monaco, monospace" font-size="10" text-anchor="middle">stableWrapper()</text></g><line x1="110" x2="170" y1="55" y2="55" stroke="#a855f7" stroke-width="2" marker-end="url(#arrowPurple)"/><g transform="translate(240, 30)"><rect width="160" height="50" x="0" y="0" fill="#3b0764" stroke="#a855f7" stroke-width="2" rx="6"/><text x="80" y="20" fill="#c084fc" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Reads .current</text><text x="80" y="38" fill="#94a3b8" font-family="Monaco, monospace" font-size="10" text-anchor="middle">latestCallbackRef</text></g><g transform="translate(80, 100)"><rect width="240" height="45" x="0" y="0" fill="#166534" stroke="#22c55e" stroke-width="2" rx="6"/><text x="120" y="18" fill="#4ade80" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Executes Latest Callback</text><text x="120" y="35" fill="#86efac" font-family="Monaco, monospace" font-size="10" text-anchor="middle">with current props/state!</text></g><line x1="320" x2="200" y1="85" y2="95" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowGreen2)"/></g><text x="450" y="525" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="14" text-anchor="middle"><tspan fill="#f8fafc" font-weight="bold">Not magic</tspan> - just the useRef pattern, abstracted into a cleaner API by React.</text></svg>