"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[63334],{37168:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"web/react/hooks/best-practices","title":"Best Practices","description":"\u5982\u679c\u5c06\u4e00\u4e2a\u51fd\u6570\u4efb\u610f\u5730\u5c06\u5176\u653e\u5728 useEffect Deps List \u4e2d","source":"@site/content/web/react/hooks/best-practices.md","sourceDirName":"web/react/hooks","slug":"/web/react/hooks/best-practices","permalink":"/notes/web/react/hooks/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/react/hooks/best-practices.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"React","permalink":"/notes/tags/react"},{"inline":true,"label":"Hook","permalink":"/notes/tags/hook"},{"inline":true,"label":"Best Practice","permalink":"/notes/tags/best-practice"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":50,"frontMatter":{"sidebar_position":50,"tags":["Web","React","Hook","Best Practice"]},"sidebar":"tutorialSidebar","previous":{"title":"Store","permalink":"/notes/web/react/hooks/store"},"next":{"title":"Internals","permalink":"/notes/web/react/hooks/internals"}}');var o=n(35656),r=n(86145);const i={sidebar_position:50,tags:["Web","React","Hook","Best Practice"]},c="Best Practices",a={},l=[];function d(e){const t={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"best-practices",children:"Best Practices"})}),"\n",(0,o.jsx)(t.p,{children:"\u5982\u679c\u5c06\u4e00\u4e2a\u51fd\u6570\u4efb\u610f\u5730\u5c06\u5176\u653e\u5728 useEffect Deps List \u4e2d\n\u53ef\u80fd\u4f1a\u5bfc\u81f4\u91cd\u590d\u65e0\u610f\u4e49\u7684 useEffect \u6267\u884c\n(\u56e0\u4e3a\u6bcf\u6b21 render \u671f\u95f4\u7684\u6b64\u51fd\u6570\u90fd\u4f1a\u91cd\u65b0\u5b9a\u4e49).\n\u6709\u4e24\u4e2a\u89e3\u51b3\u529e\u6cd5:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"\u5bf9\u4e8e\u88ab\u591a\u6b21\u590d\u7528 Utils \u51fd\u6570 (\u4e14\u4e0d\u4f9d\u8d56\u7ec4\u4ef6\u7684\u4efb\u4f55\u503c),\n\u5e94\u8be5\u63d0\u5230\u7ec4\u4ef6\u5916\u9762\u7684\u516c\u5171\u533a\u57df\u53bb\u5b9a\u4e49."}),"\n",(0,o.jsx)(t.li,{children:"\u5bf9\u4e8e\u53ea\u88ab\u7279\u5b9a Effect Hook \u8c03\u7528\u7684 Utils \u51fd\u6570,\n\u53ef\u4ee5\u653e\u5230 useEffect \u5185\u90e8\u5b9a\u4e49."}),"\n",(0,o.jsx)(t.li,{children:"\u5bf9\u4e8e\u5176\u4ed6\u9700\u8981\u5728\u7ec4\u4ef6\u5185(\u6216\u81ea\u5b9a\u4e49 Hooks \u5185)\u5b9a\u4e49\u7684\u51fd\u6570,\n\u53ef\u4f7f\u7528 useCallback \u5305\u88f9\u51fd\u6570, \u5e76\u8bbe\u7f6e\u6b63\u786e\u7684 Deps List,\n\u5c3d\u53ef\u80fd\u5730\u51cf\u5c11 render \u65f6\u91cd\u65b0\u5b9a\u4e49\u6b64\u51fd\u6570."}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-ts",children:"// \u2705 Not affected by the data flow\nfunction getFetchUrl(query) {\n  return `https://hn.algolia.com/api/v1/search?query=${query}`\n}\n\nfunction SearchResults() {\n  useEffect(() => {\n    const url = getFetchUrl('react')\n    // ... Fetch data and do something ...\n  }, []) // \u2705 Deps are OK\n\n  useEffect(() => {\n    const url = getFetchUrl('redux')\n    // ... Fetch data and do something ...\n  }, []) // \u2705 Deps are OK\n\n  // ...\n}\n"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Don't forget to cleanup side effects (return function in useEffect)"}),"\n",(0,o.jsxs)(t.li,{children:["Set correct deps list for useEffect:","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"avoid object deps (should use object property)."}),"\n",(0,o.jsx)(t.li,{children:"enough deps list to avoid infinite loop rendering pitfall."}),"\n",(0,o.jsx)(t.li,{children:"enough deps list to avoid stale closure."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"setState(state => state + 1) is better (avoid outdated state)."}),"\n",(0,o.jsxs)(t.li,{children:["Change ",(0,o.jsx)(t.code,{children:"useState"})," to ",(0,o.jsx)(t.code,{children:"useRef"})," when values not for rendering."]}),"\n",(0,o.jsxs)(t.li,{children:["Don't put any ",(0,o.jsx)(t.code,{children:"if"})," statement before hooks function."]}),"\n",(0,o.jsx)(t.li,{children:"Only call Hooks at the top level (don't inside loops, conditions or nested functions)."}),"\n",(0,o.jsx)(t.li,{children:"Only call Hooks from React function components."}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},86145:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>c});var s=n(57140);const o={},r=s.createContext(o);function i(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);