"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[92126],{50286:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"web/security/xss","title":"XSS","description":"Attack","source":"@site/content/web/security/xss.md","sourceDirName":"web/security","slug":"/web/security/xss","permalink":"/notes/web/security/xss","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/security/xss.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"Security","permalink":"/notes/tags/security"},{"inline":true,"label":"XSS","permalink":"/notes/tags/xss"},{"inline":true,"label":"Vulnerability","permalink":"/notes/tags/vulnerability"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":10,"frontMatter":{"sidebar_position":10,"tags":["Web","Security","XSS","Vulnerability"]},"sidebar":"tutorialSidebar","previous":{"title":"Zero Trust","permalink":"/notes/web/security/zero-trust"},"next":{"title":"CSRF","permalink":"/notes/web/security/csrf"}}');var r=s(35656),c=s(86145);const t={sidebar_position:10,tags:["Web","Security","XSS","Vulnerability"]},l="XSS",d={},o=[{value:"Attack",id:"attack",level:2},{value:"Protection",id:"protection",level:2},{value:"mXSS",id:"mxss",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"xss",children:"XSS"})}),"\n",(0,r.jsx)(n.h2,{id:"attack",children:"Attack"}),"\n",(0,r.jsx)(n.p,{children:"Cross-site scripting (\u8de8\u7ad9\u811a\u672c):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Reflected XSS:\nurl input (search pages)\n",(0,r.jsx)(n.code,{children:"http://localhost:8080/test?name=<script>alert('attack')<\/script>"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Stored XSS:\nstore script into database."}),"\n",(0,r.jsxs)(n.li,{children:["Inject script in HTML/CSS/JavaScript/JSON/HTTP:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<a href=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<base href=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<bgsound src=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<body background=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'<frameset><frame src="javascript:..."></frameset>'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<iframe src=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<img src=x onerror=...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<input type=image src=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<layer src=...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'<link href="javascript:..." rel="stylesheet" type="text/css">'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'<meta http-equiv="refresh" content="0;url=javascript:...">'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<object type=text/x-scriptlet data=...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<script>...<\/script>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<style type=text/javascript>alert('xss')</style>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<table background=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<td background=javascript:...>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'<button onmouseover="alert(/1/)" onclick="alert(/2/)"></button>'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'<button form="test" formaction="javascript:alert(1)">'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<button form=test onformchange=alert(2)>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<input onfocus=write(1) autofocus>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<form id=test onforminput=alert(1)><input></form>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<audio onerror=javascript:alert(1)>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'<audio><source onerror="javascript:alert(1)"></audio>'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<video onerror=javascript:alert(1)>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'<video><source onerror="javascript:alert(1)"></video>'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'@import ""'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'background: url("")'}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"window.name"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"window.location"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"document.domain"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"document.referrer"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"document.location.assign()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"document.location.replace()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"document.write()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"element.innerHTML"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"element.outerHTML"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"cookie"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"localStorage"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"protection",children:"Protection"}),"\n",(0,r.jsx)(n.p,{children:"Don't trust user:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Escape control characters (\u8f93\u5165\u6821\u9a8c):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"'})," -> ",(0,r.jsx)(n.code,{children:"&quot;"}),", ",(0,r.jsx)(n.code,{children:"&"})," -> ",(0,r.jsx)(n.code,{children:"&amp;"}),", ",(0,r.jsx)(n.code,{children:"'"})," -> ",(0,r.jsx)(n.code,{children:"&apos;"}),", ",(0,r.jsx)(n.code,{children:"<"})," -> ",(0,r.jsx)(n.code,{children:"&lt;"}),", ",(0,r.jsx)(n.code,{children:">"})," -> ",(0,r.jsx)(n.code,{children:"&gt;"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"input.trim()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Use a well-vetted HTML sanitization library,\ne.g. ",(0,r.jsx)(n.code,{children:"DOMPurify.sanitize(input)"}),", instead of ad-hoc regex replacements."]}),"\n",(0,r.jsx)(n.li,{children:"React DOM escapes any values embedded in JSX before rendering them."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Secure encode output result (\u8f93\u51fa\u7f16\u7801):\n\u4fdd\u8bc1",(0,r.jsx)(n.strong,{children:"\u7f16\u7801\u65b9\u5f0f\u4e00\u81f4"}),", e.g. \u6df7\u7528\u5355\u5b57\u8282\u7f16\u7801\u4e0e\u591a\u5b57\u8282\u7f16\u7801, \u5bfc\u81f4\u653b\u51fb\u8005\u7ed5\u8fc7 ",(0,r.jsx)(n.code,{children:"\\"})," \u7cfb\u7edf\u8f6c\u4e49\u7b26."]}),"\n",(0,r.jsxs)(n.li,{children:["\u4efb\u4f55\u7528\u6237\u63d0\u4f9b\u7684 URL \u5728\u8fdb\u4e00\u6b65\u5904\u7406\u524d (e.g. \u4fdd\u5b58\u5230\u6570\u636e\u5e93),\n\u5e94\u5148\u505a\u65e0\u5bb3\u5316\u5904\u7406 (",(0,r.jsx)(n.code,{children:"SanitizeUrl"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Check HTTP ",(0,r.jsx)(n.code,{children:"Content-Type"})," header."]}),"\n",(0,r.jsxs)(n.li,{children:["Content security policy: ",(0,r.jsx)(n.code,{children:"script-src 'self' https://apis.google.com"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Use mature template engine: built-in XSS protection feature."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"mxss",children:"mXSS"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://www.sonarsource.com/blog/mxss-the-vulnerability-hiding-in-your-code",children:"Mutation XSS"}),"\nutilize mutation in HTML is any kind of change made to the markup:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["When a parser fixes a broken markup: ",(0,r.jsx)(n.code,{children:"<p>test"})," \u2192 ",(0,r.jsx)(n.code,{children:"<p>test</p>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Normalizing attribute quotes: ",(0,r.jsx)(n.code,{children:"<a alt=test>"})," \u2192 ",(0,r.jsx)(n.code,{children:"<a alt=\u201dtest\u201d>"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Rearranging elements: ",(0,r.jsx)(n.code,{children:"<table><a>"})," \u2192 ",(0,r.jsx)(n.code,{children:"<a></a><table></table>"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},86145:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(57140);const r={},c=i.createContext(r);function t(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);