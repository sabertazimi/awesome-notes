"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[13578],{44940:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"web/typescript/utility","title":"Utility","description":"Null","source":"@site/content/web/typescript/utility.md","sourceDirName":"web/typescript","slug":"/web/typescript/utility","permalink":"/notes/web/typescript/utility","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/typescript/utility.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"TypeScript","permalink":"/notes/tags/type-script"},{"inline":true,"label":"Utility","permalink":"/notes/tags/utility"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":15,"frontMatter":{"sidebar_position":15,"tags":["Web","TypeScript","Utility"]},"sidebar":"tutorialSidebar","previous":{"title":"Moving","permalink":"/notes/web/typescript/moving"},"next":{"title":"Narrowing","permalink":"/notes/web/typescript/narrowing"}}');var r=t(35656),s=t(86145);const l={sidebar_position:15,tags:["Web","TypeScript","Utility"]},a="Utility",o={},d=[{value:"Null",id:"null",level:2},{value:"Boolean",id:"boolean",level:2},{value:"Primitive",id:"primitive",level:2},{value:"Promise",id:"promise",level:2},{value:"Proxy",id:"proxy",level:2},{value:"Recursive",id:"recursive",level:2},{value:"Nominal Brand",id:"nominal-brand",level:2},{value:"Lodash",id:"lodash",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"utility",children:"Utility"})}),"\n",(0,r.jsx)(n.h2,{id:"null",children:"Null"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type Nullish = null | undefined\ntype Nullable<T> = T | null\ntype NonUndefinedable<A> = A extends undefined ? never : A\ntype NonNullable<T> = T extends null | undefined ? never : T\n"})}),"\n",(0,r.jsx)(n.h2,{id:"boolean",children:"Boolean"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type Falsy = false | '' | 0 | null | undefined\nconst isFalsy = (val: unknown): val is Falsy => !val\n"})}),"\n",(0,r.jsx)(n.h2,{id:"primitive",children:"Primitive"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type Primitive = string | number | boolean | bigint | symbol | null | undefined\n\nfunction isPrimitive(val: unknown): val is Primitive {\n  if (val === null || val === undefined)\n    return true\n\n  const typeDef = typeof val\n\n  const primitiveNonNullishTypes = [\n    'string',\n    'number',\n    'bigint',\n    'boolean',\n    'symbol',\n  ]\n\n  return primitiveNonNullishTypes.includes(typeDef)\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"promise",children:"Promise"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// TypeScript 4.5.\n// Get naked Promise<T> type.\ntype Awaited<T> = T extends Promise<infer U> ? Awaited<U> : T\n\n// A = string.\ntype A = Awaited<Promise<string>>\n\n// B = number.\ntype B = Awaited<Promise<Promise<number>>>\n\n// C = boolean | number.\ntype C = Awaited<boolean | Promise<number>>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type Sync<T> = {\n  [K in keyof T]: T[K] extends (...args: any[]) => Promise<infer Result>\n    ? (...args: Parameters<T[K]>) => Result\n    : T[K]\n}\n\ninterface AsyncInterface {\n  compute: (arg: number) => Promise<boolean>\n  createString: () => Promise<string>\n}\n\ntype SyncInterface = Sync<AsyncInterface>\n// type SyncInterface = {\n//     compute: (arg: number) => boolean;\n//     createString: () => String;\n// }\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Better types for ",(0,r.jsx)(n.a,{href:"https://spin.atomicobject.com/better-promise-all",children:(0,r.jsx)(n.code,{children:"Promise.all()"})}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type ShallowPromisify<T>\n  = T extends Array<infer V>\n    ? Array<Promise<V>>\n    : T extends object\n      ? { [K in keyof T]: Promise<T[K]> }\n      : Promise<T>\n\ntype ShallowSettled<T>\n  = T extends Array<infer V>\n    ? Array<PromiseSettledResult<V>>\n    : T extends object\n      ? { [K in keyof T]: PromiseSettledResult<T[K]> }\n      : PromiseSettledResult<T>\n\ntype DeepAwaited<T>\n  = T extends Promise<infer U>\n    ? DeepAwaited<U>\n    : T extends Array<infer V>\n      ? Array<DeepAwaited<V>>\n      : T extends object\n        ? { [K in keyof T]: DeepAwaited<T[K]> }\n        : T\n\ntype DeepSettled<T>\n  = T extends Promise<infer U>\n    ? PromiseSettledResult<DeepSettled<U>>\n    : T extends Array<infer V>\n      ? Array<DeepSettled<V>>\n      : T extends object\n        ? { [K in keyof T]: DeepSettled<T[K]> }\n        : T\n"})}),"\n",(0,r.jsx)(n.h2,{id:"proxy",children:"Proxy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"interface Proxy<T> {\n  get: () => T\n  set: (value: T) => void\n}\n\ntype Proxify<T> = { [P in keyof T]: Proxy<T[P]> }\n"})}),"\n",(0,r.jsx)(n.h2,{id:"recursive",children:"Recursive"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type DeepReadonly<T> = {\n  +readonly [P in keyof T]: T[P] extends object ? DeepReadonly<T[P]> : T[P]\n}\n\ntype DeepMutable<T> = {\n  -readonly [P in keyof T]: T[P] extends object ? DeepMutable<T[P]> : T[P]\n}\n\ntype DeepPartial<T> = {\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]\n}\n\ntype DeepRequired<T> = {\n  [P in keyof T]-?: T[P] extends object | undefined ? DeepRequired<T[P]> : T[P]\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"nominal-brand",children:"Nominal Brand"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/microsoft/TypeScript/issues/202",children:"Nominal type system"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"interface FooId extends string {\n  _fooIdBrand: string\n}\n\ninterface BarId extends string {\n  _barIdBrand: string\n}\n\nlet fooId: FooId\nlet barId: BarId\n\n// \u7c7b\u578b\u5b89\u5168\nfooId = barId // error\nbarId = fooId // error\nfooId = barId as FooId // error\nbarId = fooId as BarId // error\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const typeSym = Symbol('type')\nconst valueSym = Symbol('value')\n\ntype Brand<B extends string, T> = T extends\n  | undefined\n  | null\n  | number\n  | boolean\n  | bigint\n  ? { [typeSym]: B, [valueSym]: T }\n  : T & { [typeSym]: B }\n\ntype Flavor<F extends string, T> = T & {\n  [typeSym]?: F\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"lodash",children:"Lodash"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"type Flatten<Type> = Type extends Array<infer Item> ? Item : Type\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},86145:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var i=t(57140);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);