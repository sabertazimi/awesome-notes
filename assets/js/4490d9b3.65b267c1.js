"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[68816],{16125:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"language/rust/error","title":"Error","description":"Result","source":"@site/content/language/rust/error.md","sourceDirName":"language/rust","slug":"/language/rust/error","permalink":"/notes/language/rust/error","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/language/rust/error.md","tags":[{"inline":true,"label":"Language","permalink":"/notes/tags/language"},{"inline":true,"label":"Rust","permalink":"/notes/tags/rust"},{"inline":true,"label":"Error","permalink":"/notes/tags/error"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":20,"frontMatter":{"sidebar_position":20,"tags":["Language","Rust","Error"]},"sidebar":"tutorialSidebar","previous":{"title":"Iterator","permalink":"/notes/language/rust/iterator"},"next":{"title":"Concurrency","permalink":"/notes/language/rust/concurrency"}}');var o=n(35656),s=n(86145);const i={sidebar_position:20,tags:["Language","Rust","Error"]},l="Error",d={},c=[{value:"Result",id:"result",level:2},{value:"Compositor",id:"compositor",level:2},{value:"Macro",id:"macro",level:2},{value:"Trait",id:"trait",level:2},{value:"Conversion",id:"conversion",level:2}];function a(r){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"error",children:"Error"})}),"\n",(0,o.jsx)(e.h2,{id:"result",children:"Result"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-rust",children:'use std::fs::File;\nuse std::io::ErrorKind;\n\nfn main() {\n    let f = File::open("hello.txt");\n\n    let f = match f {\n        Ok(file) => file,\n        Err(error) => match error.kind() {\n            ErrorKind::NotFound => match File::create("hello.txt") {\n                Ok(fc) => fc,\n                Err(e) => panic!("Problem creating the file: {:?}", e),\n            },\n            other_error => panic!("Problem opening the file: {:?}", other_error),\n        },\n    };\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"compositor",children:"Compositor"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"or"}),": logic or."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"and"}),": logic and."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"or_else"}),": logic or function."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"and_then"}),": logic and function."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"filter"}),": ",(0,o.jsx)(e.code,{children:"Option"})," filter function."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"map"}),": ",(0,o.jsx)(e.code,{children:"Ok"}),"/",(0,o.jsx)(e.code,{children:"Some"})," map function."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"map_or"}),": ",(0,o.jsx)(e.code,{children:"Ok"}),"/",(0,o.jsx)(e.code,{children:"Some"})," map function with defaults value."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"map_or_else"}),": ",(0,o.jsx)(e.code,{children:"Ok"}),"/",(0,o.jsx)(e.code,{children:"Some"})," map function with defaults function."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"map_err"}),": ",(0,o.jsx)(e.code,{children:"Err"})," map function."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"ok_or"}),": ",(0,o.jsx)(e.code,{children:"Option"})," -> ",(0,o.jsx)(e.code,{children:"Result"})," with error message."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"ok_or_else"}),": ",(0,o.jsx)(e.code,{children:"Option"})," -> ",(0,o.jsx)(e.code,{children:"Result"})," with error message function."]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"macro",children:"Macro"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"?"})," for ",(0,o.jsx)(e.code,{children:"Result"})," type:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-rust",children:'use std::fs::File;\nuse std::io;\nuse std::io::Read;\n\nfn open_file() -> Result<File, Box<dyn std::error::Error>> {\n    let mut f = File::open("hello.txt")?;\n    Ok(f)\n}\n\nfn read_username_from_file() -> Result<String, io::Error> {\n    let mut s = String::new();\n    File::open("hello.txt")?.read_to_string(&mut s)?;\n    Ok(s)\n}\n'})}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"?"})," for ",(0,o.jsx)(e.code,{children:"Option"})," type:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-rust",children:"fn last_char_of_first_line(text: &str) -> Option<char> {\n    text.lines().next()?.chars().last()\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"trait",children:"Trait"}),"\n",(0,o.jsx)(e.p,{children:"Standard error trait:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-rust",children:"use std::fmt::{Debug, Display};\n\npub trait Error: Debug + Display {\n    fn source(&self) -> Option<&(Error + 'static)> { ... }\n}\n"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-rust",children:'use std::fs::read_to_string;\nuse std::error::Error;\n\nfn main() -> Result<(), Box<dyn Error>> {\n    let html = render()?;\n    println!("{}", html);\n    Ok(())\n}\n\nfn render() -> Result<String, Box<dyn Error>> {\n    let file = std::env::var("MARKDOWN")?;\n    let source = read_to_string(file)?;\n    Ok(source)\n}\n'})}),"\n",(0,o.jsx)(e.p,{children:"Custom error type:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-rust",children:'use std::error;\nuse std::fmt;\n\n#[derive(Debug)]\nstruct AppError;\n\nimpl fmt::Display for AppError {\n    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n        write!(f, "An Error Occurred, Please Try Again!")\n    }\n}\n\nimpl error::Error for AppError {\n    fn description(&self) -> &str {\n        "Invalid App"\n    }\n\n    fn source(&self) -> Option<&(dyn error::Error + \'static)> {\n        None\n    }\n\n    fn cause(&self) -> Option<&dyn error::Error> {\n        None\n    }\n}\n\nfn produce_error() -> Result<(), AppError> {\n    Err(AppError)\n}\n\nfn main(){\n    match produce_error() {\n        Err(e) => eprintln!("{}", e),\n        _ => println!("No error"),\n    }\n\n    eprintln!("{:?}", produce_error()); // Err({ file: src/main.rs, line: 17 })\n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"conversion",children:"Conversion"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-rust",children:'use std::fs::File;\nuse std::io::{self, Read};\nuse std::num;\n\n#[derive(Debug)]\nstruct AppError {\n    kind: String,\n    message: String,\n}\n\nimpl From<io::Error> for AppError {\n    fn from(error: io::Error) -> Self {\n        AppError {\n            kind: String::from("io"),\n            message: error.to_string(),\n        }\n    }\n}\n\nimpl From<num::ParseIntError> for AppError {\n    fn from(error: num::ParseIntError) -> Self {\n        AppError {\n            kind: String::from("parse"),\n            message: error.to_string(),\n        }\n    }\n}\n\nfn main() -> Result<(), AppError> {\n    let mut file = File::open("hello_world.txt")?;\n\n    let mut content = String::new();\n    file.read_to_string(&mut content)?;\n\n    let _number: usize;\n    _number = content.parse()?;\n\n    Ok(())\n}\n\n// --------------- \u4e0a\u8ff0\u4ee3\u7801\u8fd0\u884c\u540e\u7684\u53ef\u80fd\u8f93\u51fa ---------------\n// 01. \u82e5 hello_world.txt \u6587\u4ef6\u4e0d\u5b58\u5728\n// Error: AppError { kind: "io", message: "No such file or directory" }\n// 02. \u82e5\u7528\u6237\u6ca1\u6709\u76f8\u5173\u7684\u6743\u9650\u8bbf\u95ee hello_world.txt\n// Error: AppError { kind: "io", message: "Permission denied" }\n// 03. \u82e5 hello_world.txt \u5305\u542b\u6709\u975e\u6570\u5b57\u7684\u5185\u5bb9\uff0c\u4f8b\u5982 Hello, world!\n// Error: AppError { kind: "parse", message: "invalid digit found in string" }\n'})})]})}function u(r={}){const{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,o.jsx)(e,{...r,children:(0,o.jsx)(a,{...r})}):a(r)}},86145:(r,e,n)=>{n.d(e,{R:()=>i,x:()=>l});var t=n(57140);const o={},s=t.createContext(o);function i(r){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof r?r(e):{...e,...r}}),[e,r])}function l(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:i(r.components),t.createElement(s.Provider,{value:e},r.children)}}}]);