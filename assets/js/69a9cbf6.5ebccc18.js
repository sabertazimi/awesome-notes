"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[53877],{77371:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>t,frontMatter:()=>c,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"language/assembly/assembly","title":"Assembly","description":"Execution Model","source":"@site/content/language/assembly/assembly.md","sourceDirName":"language/assembly","slug":"/language/assembly/","permalink":"/notes/language/assembly/","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/language/assembly/assembly.md","tags":[{"inline":true,"label":"Language","permalink":"/notes/tags/language"},{"inline":true,"label":"Assembly","permalink":"/notes/tags/assembly"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"frontMatter":{"tags":["Language","Assembly"]},"sidebar":"tutorialSidebar","previous":{"title":"Language","permalink":"/notes/language/"},"next":{"title":"C","permalink":"/notes/language/c/"}}');var i=l(35656),d=l(86145);const c={tags:["Language","Assembly"]},r="Assembly",a={},h=[{value:"Execution Model",id:"execution-model",level:2},{value:"Bitwise",id:"bitwise",level:2},{value:"Address",id:"address",level:2},{value:"Read",id:"read",level:2},{value:"Jump",id:"jump",level:2},{value:"If",id:"if",level:2},{value:"Switch",id:"switch",level:2},{value:"Stack Frame",id:"stack-frame",level:2},{value:"Array",id:"array",level:2},{value:"Gcc",id:"gcc",level:2},{value:"Gdb",id:"gdb",level:2},{value:"Masm",id:"masm",level:2},{value:"Link",id:"link",level:2},{value:"Turbo Debugger",id:"turbo-debugger",level:2},{value:"Alt",id:"alt",level:3},{value:"\u4ee3\u7801\u533a",id:"\u4ee3\u7801\u533a",level:3},{value:"\u6570\u636e\u533a",id:"\u6570\u636e\u533a",level:3},{value:"Make",id:"make",level:2},{value:"Objdump",id:"objdump",level:2}];function x(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"assembly",children:"Assembly"})}),"\n",(0,i.jsx)(n.h2,{id:"execution-model",children:"Execution Model"}),"\n",(0,i.jsx)(n.p,{children:"Load-ALU-Store \u6a21\u5f0f - \u8bfb\u5165\u5bc4\u5b58\u5668\uff0c\u7b97\u672f\u903b\u8f91\u5355\u5143\u8fd0\u7b97\uff0c\u56de\u5199\u81f3\u5185\u5b58"}),"\n",(0,i.jsx)(n.h2,{id:"bitwise",children:"Bitwise"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"^"}),"\uff1a\u65e0\u8fdb\u4f4d"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"p && *p++"})," : NULL \u68c0\u67e5"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\uff1a2^n e.g. \u4e00\u526f\u724c\u7684\u7f16\u7801 2 \u4f4d\u724c\u8272\u4f4d+4 \u4f4d\u6570\u5b57\u4f4d"}),"\n",(0,i.jsx)(n.h2,{id:"address",children:"Address"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"movX src dest"}),": X \u53ef\u4e3a b/w/l/q \uff081/2/4/8 \u5b57\u8282\uff09"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"D(Rb, Ri, S)"}),": ",(0,i.jsx)(n.code,{children:"MEM[ Reg[Rb] + S * Reg[Ri] + D]"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"leal"})," \u547d\u4ee4:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"leal D(Rb, Ri, S) dest"})," - \u5c06\u5730\u5740\u6a21\u5f0f\u8868\u8fbe\u5f0f\u7684\u5740\u5b58\u5165 dest.\n\u4f5c\u7528\u4e3a\u5feb\u901f\u7ed9\u6307\u9488\u8d4b\u503c",(0,i.jsx)(n.code,{children:"p = &x[i]"})," \u5373",(0,i.jsx)(n.code,{children:"Mem[Reg[x] + i * size]->(x, size, I)"}),",\n\u5feb\u901f\u8ba1\u7b97\u4e8c\u6b21\u591a\u9879\u5f0f ",(0,i.jsx)(n.code,{children:"x + i * k"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"read",children:"Read"}),"\n",(0,i.jsx)(n.p,{children:"\u5185\u5b58\u6570\u636e\u91cd\u590d\u8bfb\u5165\u5bc4\u5b58\u5668 - \u4f7f\u5f97\u6c47\u7f16\u4ee3\u7801\u4e0e\u4e0a\u4e0b\u6587\u65e0\u5173,\u51cf\u5c11 BUG \u4ea7\u751f\u53ef\u80fd\u6027"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"R1 = MEM[SP + 8]\n\u2026\u2026\nR1 = MEM[SP + 8]\n\u2026\u2026\nR1 = MEM[SP + 8]\n\u2026\u2026\n"})}),"\n",(0,i.jsx)(n.h2,{id:"jump",children:"Jump"}),"\n",(0,i.jsx)(n.p,{children:"Flags"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"CF\uff1aCarry Flag(unsigned) \u8fdb\u4f4d\u6807\u5fd7\u2014\u2014\u5f53\u6709\u8fdb\u4f4d\u65f6\u8bbe\u4e3a 1"}),"\n",(0,i.jsx)(n.li,{children:"OF\uff1aOverFlow Flag(signed) \u6ea2\u51fa\u6807\u5fd7\u2014\u2014\u5f53\u8865\u7801\u6ea2\u51fa\u65f6\u8bbe\u4e3a 1"}),"\n",(0,i.jsxs)(n.li,{children:["SF\uff1aSign Flag(signed) \u7b26\u53f7\u6807\u5fd7\u2014\u2014\u5f53 ",(0,i.jsx)(n.code,{children:"t < 0"})," \u65f6\u8bbe\u4e3a 1"]}),"\n",(0,i.jsxs)(n.li,{children:["ZF\uff1aZero Flag \u96f6\u6807\u5fd7\u2014\u2014\u5f53 ",(0,i.jsx)(n.code,{children:"t == 0"})," \u65f6\u8bbe\u4e3a 1"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["cmpX \u547d\u4ee4: ",(0,i.jsx)(n.code,{children:"cmpl Src2, Src1"}),",\n\u6839\u636e Src1 \u2013 Src2(subl Src2, Src1)\u7684\u7ed3\u679c\u8bbe\u7f6e\u6807\u5fd7\u5bc4\u5b58\u5668\u7684\u503c"]}),"\n",(0,i.jsxs)(n.p,{children:["testX \u547d\u4ee4: ",(0,i.jsx)(n.code,{children:"testl Src2, Src1"}),",\n\u6839\u636e Src1 & Src2(andl Src2, Src1)\u7684\u7ed3\u679c\u8bbe\u7f6e\u6807\u5fd7\u5bc4\u5b58\u5668\u7684\u503c"]}),"\n",(0,i.jsx)(n.p,{children:"e.g. testl %eax, %eax \u5b9e\u73b0\u7b26\u53f7\u51fd\u6570"}),"\n",(0,i.jsxs)(n.p,{children:["setX \u547d\u4ee4: ",(0,i.jsx)(n.code,{children:"setX dest"}),",\n\u6839\u636e\u6807\u5fd7\u5bc4\u5b58\u5668\u8fd0\u7b97\u503c\uff0c\u5c06\u503c\u5b58\u5165 dest"]}),"\n",(0,i.jsx)(n.h2,{id:"if",children:"If"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"cmovC src, dest"}),"(C \u8868\u793a Conditional\u2014\u2014e/ne \u7b49)\n\u5f53\u6761\u4ef6\u6210\u7acb\u65f6\uff0csrc->dest src \u4e0e dest \u53ef\u5206\u522b\u7528\u4e8e\u5b58\u653e\u4e24\u79cd\u60c5\u51b5\u7684\u503c"]}),"\n",(0,i.jsx)(n.h2,{id:"switch",children:"Switch"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Jump Table"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"break; \u2192 leave"}),"\n",(0,i.jsx)(n.code,{children:"ret"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"fallThrough(without break)"}),"\n",(0,i.jsx)(n.li,{children:"mixing(\u8fde\u5192\u53f7)"}),"\n",(0,i.jsx)(n.li,{children:"missing case"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"stack-frame",children:"Stack Frame"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"# \u51c6\u5907\u9636\u6bb5\n# Caller-Save: %eax %ecx %edx\n# Callee-Save: %ebx %esi %edi\n# \u4f20\u53c2\u987a\u5e8f: rdi, dsi, rdx, rcx, r8, r9, stack\n\npushl %ebp\nmovl %esp, %ebp\npushl %ebx\n\n# \u7ed3\u675f\u9636\u6bb5\n\nmovl -4(%ebp), %ebx\nmovl %ebp, %esp\npopl %ebp\nret\n"})}),"\n",(0,i.jsx)(n.h2,{id:"array",children:"Array"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"int get_sea_digit(int index, int dig) {\n    return sea[index][dig];\n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"# \u8bbf\u95ee\u4e8c\u7ef4\u6570\u7ec4\u5143\u7d20\n# %ecx = dig\n# %eax = index\nleal 0(,%ecx,4), %edx        # 4 * dig\nleal (%eax,%eax,4), %eax     # 5 * index\nmovl sea(%edx,%eax,4), %eax  # * (sea + 4 * dig + 20 * index)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"gcc",children:"Gcc"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"gcc -01/-02/-03 source.c"})," \u2014\u2014 \u7f16\u8bd1\u4f18\u5316\u7b49\u7ea7"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"gcc -S source.c"})," \u2014\u2014 \u7f16\u8bd1\u6210\u6c47\u7f16\u4ee3\u7801(\u6587\u672c\u6587\u4ef6)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"gcc -o source.c"})," \u2014\u2014 \u7f16\u8bd1\u6210 Object \u4ee3\u7801(\u4e8c\u8fdb\u5236\u6587\u4ef6)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"gdb",children:"Gdb"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"si"})," \u5355\u6307\u4ee4\u6267\u884c"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"x/i $pc"})," \u6267\u884c si \u547d\u4ee4\u65f6\u6253\u5370\u6c47\u7f16\u4ee3\u7801"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"disas"})," \u663e\u793a\u6c47\u7f16\u4ee3\u7801"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bt"})," \u67e5\u770b\u51fd\u6570\u5806\u6808"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"step1"})," \u4e0b\u4e00\u6761\u6c47\u7f16\u6307\u4ee4"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"info register"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"x /numsizeformat $pc/rsp/rbp"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"masm",children:"Masm"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"masm /Zi/Zd src dist\nmasm /I(path)           // \u5f15\u7528 \u6807\u51c6\u5e93/\u5b8f\nmasm /I..\\include\n"})}),"\n",(0,i.jsx)(n.h2,{id:"link",children:"Link"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"link /DEBUG src\n"})}),"\n",(0,i.jsx)(n.h2,{id:"turbo-debugger",children:"Turbo Debugger"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tab"})," \u5207\u6362\u5206\u533a"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"alt"})," \u529f\u80fd\u952e"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ctrl"})," \u5b50\u529f\u80fd\u952e"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"F2"}),": break"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"F7"}),": step into"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"F8"}),": step over"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"alt",children:"Alt"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Alt+F5"})," : \u4e34\u65f6\u8df3\u8f6c\u81f3 dos \u754c\u9762"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Alt+Enter"}),": \u5168\u5c4f"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Alt+X"})," : \u9000\u51fa"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u533a",children:"\u4ee3\u7801\u533a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-A>"})," Assemble: \u4e34\u65f6\u4fee\u6539\u6c47\u7f16\u6307\u4ee4"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-C>"})," Caller : \u4ece\u5b50\u7a0b\u5e8f\u5904\u8df3\u56de\u81f3 Caller \u5904"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-F>"})," Follow : \u67e5\u770b CALL/JMP/INT \u8df3\u8f6c\u81f3\u7684\u5b50\u7a0b\u5e8f\u5904"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-O>"})," Origin : \u8df3\u8f6c\u81f3 cs",":ip"," \u6307\u5411\u6307\u4ee4\u5904"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u6570\u636e\u533a",children:"\u6570\u636e\u533a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-C>"})," Change: \u4e34\u65f6\u4fee\u6539\u6570\u636e"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-D>"})," Display: \u9009\u62e9\u663e\u793a\u683c\u5f0f e.g. Byte/Word/Long/Comp/Float/Real/Double/Extended"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-G>"})," Goto: \u8df3\u8f6c\u81f3\u6307\u5b9a\u5730\u5740\u533a"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"make",children:"Make"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$<"}),": \u6e90\u6587\u4ef6\u540d"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$?"}),": \u6240\u6709\u6e90\u6587\u4ef6\u540d"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$@"}),": \u5168\u8def\u5f84\u7684\u76ee\u6807\u6587\u4ef6"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$*"}),": \u9664\u53bb\u6269\u5c55\u540d\u7684\u5168\u8def\u5f84\u7684\u76ee\u6807\u6587\u4ef6"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-makefile",children:"EXE = $(NAME).exe\nOBJS = $(NAME).obj\nSRCS = $(NAME).asm\nSIMPLE_MODE = ;\n\nLINK_FLAG = /subsystem:windows\nML_FLAG = /c/coff/Zi\nMASM_FLAG = /Zi/Zd\n\n$(EXE): $(OBJS)\n    link $(LINK_FLAG) $(OBJS) $(SIMPLE_MODE)\n\n$(OBJS): $(SRCS)\n    masm $(MASM_FLAG) $(SRCS) $(SIMPLE_MODE)\n\nclean:\n    del *.obj\n    del *.tr\n\ntest:\n    td $(EXE)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"objdump",children:"Objdump"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"AT&T"}),"\u53cd\u6c47\u7f16\u5de5\u5177"]})]})}function t(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}},86145:(e,n,l)=>{l.d(n,{R:()=>c,x:()=>r});var s=l(57140);const i={},d=s.createContext(i);function c(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);