"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[76556],{92215:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"cs/compilers/ast","title":"Abstract Syntax Tree","description":"\u8bed\u6cd5\u5236\u5bfc\u7ffb\u8bd1","source":"@site/content/cs/compilers/ast.md","sourceDirName":"cs/compilers","slug":"/cs/compilers/ast","permalink":"/notes/cs/compilers/ast","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/cs/compilers/ast.md","tags":[{"inline":true,"label":"CS","permalink":"/notes/tags/cs"},{"inline":true,"label":"Compiler","permalink":"/notes/tags/compiler"},{"inline":true,"label":"Syntax","permalink":"/notes/tags/syntax"},{"inline":true,"label":"AST","permalink":"/notes/tags/ast"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"tags":["CS","Compiler","Syntax","AST"]},"sidebar":"tutorialSidebar","previous":{"title":"Bottom-Up Parsing","permalink":"/notes/cs/compilers/bottom-up"},"next":{"title":"Semantic Analysis","permalink":"/notes/cs/compilers/semantic"}}');var s=t(35656),i=t(86145);const a={sidebar_position:5,tags:["CS","Compiler","Syntax","AST"]},l="Abstract Syntax Tree",c={},p=[{value:"\u8bed\u6cd5\u5236\u5bfc\u7ffb\u8bd1",id:"\u8bed\u6cd5\u5236\u5bfc\u7ffb\u8bd1",level:2},{value:"\u62bd\u8c61\u8bed\u6cd5",id:"\u62bd\u8c61\u8bed\u6cd5",level:2},{value:"Data Structure",id:"data-structure",level:2},{value:"Algorithms",id:"algorithms",level:2},{value:"Construction",id:"construction",level:2}];function o(n){const e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"abstract-syntax-tree",children:"Abstract Syntax Tree"})}),"\n",(0,s.jsx)(e.admonition,{type:"tip",children:(0,s.jsx)(e.mermaid,{value:'flowchart LR\n    A["Tokens + Grammar"] --\x3e|Syntax Analysis| B["AST"]'})}),"\n",(0,s.jsx)(e.h2,{id:"\u8bed\u6cd5\u5236\u5bfc\u7ffb\u8bd1",children:"\u8bed\u6cd5\u5236\u5bfc\u7ffb\u8bd1"}),"\n",(0,s.jsx)(e.p,{children:"Syntax-directed translation,\n\u5728\u8fdb\u884c\u5f52\u7ea6(reduce)\u7684\u540c\u65f6, \u8fdb\u884c\u8bed\u4e49\u52a8\u4f5c:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u7ed9\u6bcf\u6761\u4ea7\u751f\u89c4\u5219\u9644\u52a0\u4e00\u4e2a\u8bed\u4e49\u52a8\u4f5c"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bison",children:"exp : exp '+' exp { $$ = $1 + $3; }\n;\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5728\u5206\u6790\u6808\u4e2d\u538b\u5165 symbol, value, state (\u539f\u672c\u53ea\u538b\u5165 symbol, state)"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:"push(right side symbol);\npush(right side value);\npush(next state);\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u62bd\u8c61\u8bed\u6cd5",children:"\u62bd\u8c61\u8bed\u6cd5"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u8868\u8fbe\u8bed\u6cd5\u7ed3\u6784\u7684\u5185\u90e8\u8868\u793a, \u4f5c\u4e3a\u524d\u7aef(\u8bcd\u6cd5\u8bed\u6cd5\u5206\u6790)\u548c\u540e\u7aef(\u4ee3\u7801\u751f\u6210)\u7684\u4e2d\u95f4\u4ef6:"}),"\n"]}),"\n",(0,s.jsx)(e.mermaid,{value:'flowchart LR\n    A["tokens"] --\x3e|\u8bed\u6cd5\u5206\u6790\u5668| B["\u62bd\u8c61\u8bed\u6cd5(\u6811)"]\n    B --\x3e|\u4ee3\u7801\u751f\u6210\u5668| C["\u76ee\u6807\u4ee3\u7801"]'}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u62bd\u8c61\u8bed\u6cd5\u65e0\u9700\u8003\u8651\u5de6/\u53f3\u9012\u5f52, \u5de6\u516c\u56e0\u5b50\u63d0\u53d6, \u5206\u9694\u7b26\u7b49"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:"// \u5177\u4f53\u8bed\u6cd5\nE: E + T\n | T\n ;\nT: T * F\n | F\n ;\nF: n\n | (E)\n ;\n\n// \u62bd\u8c61\u8bed\u6cd5\nE: n\n | E + E\n | E * E\n"})}),"\n",(0,s.jsx)(e.h2,{id:"data-structure",children:"Data Structure"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:"E: n\n | E + E\n | E * E\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:"enum kind {\n  E_INT,\n  E_ADD,\n  E_TIMES\n};\n\nstruct exp {\n  enum kind kind;\n};\n\nstruct exp_int {\n  enum kind kind;\n  int value;\n};\n\nstruct exp_add {\n  enum kind kind;\n  struct exp *left;\n  struct exp *right;\n};\n\nstruct exp_times {\n  enum kind kind;\n  struct exp *left;\n  struct exp *right;\n};\n\nstruct exp_int *new_exp_int(int value) {\n  struct exp_int *p = (struct exp_int *)malloc(sizeof(struct exp_int));\n  if (!p) throw new Error();\n  p->kind = E_INT;\n  p->value = value;\n  return p;\n}\n\nstruct exp_add *new_exp_add(exp *left, exp *right) {\n  struct exp_add *p = (struct exp_add *)malloc(sizeof(struct exp_add));\n  if (!p) throw new Error();\n  p->kind = E_ADD;\n  p->left = left;\n  p->right = right;\n  return p;\n}\n\nstruct exp_times *new_exp_times(exp *left, exp *right) {\n  struct exp_times *p = (struct exp_times *)malloc(sizeof(struct exp_times));\n  if (!p) throw new Error();\n  p->kind = E_TIMES;\n  p->left = left;\n  p->right = right;\n  return p;\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"algorithms",children:"Algorithms"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:'int nodes_num(exp *e) {\n  switch (e->kind) {\n    case E_INT:\n      return 1;\n    case E_ADD: // fall through\n    case E_TIMES:\n      return 1 + nodes_num(e->left) + nodes_num(e->right);\n    default:\n      throw new SyntaxError("compile bug");\n  }\n}\n'})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:'int pretty_print(exp *e) {\n  switch (e->kind) {\n    case E_INT:\n      printf("%d", e->value);\n      return 1;\n    case E_ADD:\n      printf("(");\n      pretty_print(e->left);\n      printf(")");\n      printf("+");\n      printf("(");\n      pretty_print(e->right);\n      printf(")");\n      return 1;\n    case E_TIMES:\n      printf("(");\n      pretty_print(e->left);\n      printf(")");\n      printf("*");\n      printf("(");\n      pretty_print(e->right);\n      printf(")");\n      return 1;\n    default:\n      throw new SyntaxError();\n      break;\n  }\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"construction",children:"Construction"}),"\n",(0,s.jsx)(e.p,{children:"\u5229\u7528\u8bed\u6cd5\u5236\u5bfc\u7ffb\u8bd1, \u5728\u8bed\u6cd5\u52a8\u4f5c(action)/\u8bed\u6cd5\u5f52\u7ea6(reduce)\u4e2d\u52a0\u5165\u751f\u6210\u8bed\u6cd5\u6811\u7684\u4ee3\u7801(\u81ea\u5e95(\u53f6\u5b50)\u5411\u4e0a(\u6839)\u6784\u9020\u51fd\u6570)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-cpp",children:"E: E + E { $$ = new_exp_add($1, $3); }\n | E * E { $$ = new_exp_times($1, $3); }\n | n     { $$ = new_exp_int($1); }\n ;\n"})})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(o,{...n})}):o(n)}},86145:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>l});var r=t(57140);const s={},i=r.createContext(s);function a(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);