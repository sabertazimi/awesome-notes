"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[2824],{37011:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"web/javascript/media","title":"Media","description":"Oscillator","source":"@site/content/web/javascript/media.md","sourceDirName":"web/javascript","slug":"/web/javascript/media","permalink":"/notes/web/javascript/media","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/media.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Media","permalink":"/notes/tags/media"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":55,"frontMatter":{"sidebar_position":55,"tags":["Web","JavaScript","ECMAScript","Media"]},"sidebar":"tutorialSidebar","previous":{"title":"Canvas","permalink":"/notes/web/javascript/canvas"},"next":{"title":"Storage","permalink":"/notes/web/javascript/storage"}}');var i=t(35656),o=t(86145);const s={sidebar_position:55,tags:["Web","JavaScript","ECMAScript","Media"]},r="Media",l={},c=[{value:"Oscillator",id:"oscillator",level:2},{value:"Music",id:"music",level:2},{value:"Audio",id:"audio",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"media",children:"Media"})}),"\n",(0,i.jsx)(n.h2,{id:"oscillator",children:"Oscillator"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"                         -3  -1   1       4   6       9   11\n                       -4  -2   0   2   3   5   7   8   10  12\n  .___________________________________________________________________________.\n  :  | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  :\n  :  | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  :\n  :  | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  :\n<-:  |_|  |  |_| |_|  |  |_| |_| |_|  |  |_| |_|  |  |_| |_| |_|  |  |_| |_|  :->\n  :   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   :\n  : A | B | C | D | E | F | G | A | B | C | D | E | F | G | A | B | C | D | E :\n  :___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___:\n    ^                           ^           ^               ^           ^\n  220 Hz                      440 Hz      523.25 Hz       880 Hz     1174.65 Hz\n(-1 Octave)                 (middle A)                 (+1 Octave)\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const audioContext = new AudioContext()\n\nconst baseFrequency = 440\nconst getNoteFreq = (base, pitch) => base * 2 ** (pitch / 12)\n// oscillator.frequency.value = getNoteFreq(440, 7);\n\nconst getNoteDetune = pitch => pitch * 100\n// oscillator.detune.value = getNoteDetune(7);\n\nfunction play(type, delay, pitch, duration) {\n  const oscillator = audioContext.createOscillator()\n  oscillator.connect(audioContext.destination)\n\n  oscillator.type = type\n  oscillator.detune.value = getNoteDetune(pitch)\n\n  const startTime = audioContext.currentTime + delay\n  const stopTime = startTime + duration\n  oscillator.start(startTime)\n  oscillator.stop(stopTime)\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"music",children:"Music"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const sampleSize = 1024 // number of samples to collect before analyzing data\nconst audioUrl = 'viper.mp3'\n\nlet audioData = null\nlet audioPlaying = false\n\nconst audioContext = new AudioContext()\nconst sourceNode = audioContext.createBufferSource()\nconst analyserNode = audioContext.createAnalyser()\nconst javascriptNode = audioContext.createScriptProcessor(sampleSize, 1, 1)\n\n// Create the array for the data values\nconst amplitudeArray = new Uint8Array(analyserNode.frequencyBinCount)\n\n// Now connect the nodes together\nsourceNode.connect(audioContext.destination)\nsourceNode.connect(analyserNode)\nanalyserNode.connect(javascriptNode)\njavascriptNode.connect(audioContext.destination)\n\n// setup the event handler that is triggered\n// every time enough samples have been collected\n// trigger the audio analysis and draw the results\njavascriptNode.onaudioprocess = function () {\n  // get the Time Domain data for this sample\n  analyserNode.getByteTimeDomainData(amplitudeArray)\n\n  // draw the display if the audio is playing\n  // if (audioPlaying === true) {\n  // requestAnimFrame(drawTimeDomain);\n  // }\n}\n\n// Load the audio from the URL via AJAX and store it in global variable audioData\n// Note that the audio load is asynchronous\nfunction loadSound(url) {\n  fetch(url)\n    .then((response) => {\n      audioContext.decodeAudioData(response, (buffer) => {\n        audioData = buffer\n        playSound(audioData)\n      })\n    })\n    .catch((error) => {\n      console.error(error)\n    })\n}\n\n// Play the audio and loop until stopped\nfunction playSound(buffer) {\n  sourceNode.buffer = buffer\n  sourceNode.start(0) // Play the sound now\n  sourceNode.loop = true\n  audioPlaying = true\n}\n\nfunction stopSound() {\n  sourceNode.stop(0)\n  audioPlaying = false\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"audio",children:"Audio"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/AnalyserNode/getByteFrequencyData",children:"AnalyserNode.getByteFrequencyData API"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/bogdan-cornianu/swave/blob/master/src/visualizer.ts",children:"Github Demo"})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const WIDTH = this.canvas.clientWidth\nconst HEIGHT = this.canvas.clientHeight\nthis.analyserNode.fftSize = 256\nconst bufferLengthAlt = this.analyserNode.frequencyBinCount\nconst dataArrayAlt = new Uint8Array(bufferLengthAlt)\n\nthis.ctx.clearRect(0, 0, WIDTH, HEIGHT)\n\nfunction draw() {\n  const drawVisual = requestAnimationFrame(draw)\n  this.analyserNode.getByteFrequencyData(dataArrayAlt)\n\n  this.ctx.fillStyle = 'rgb(255, 255, 255)'\n  this.ctx.fillRect(0, 0, WIDTH, HEIGHT)\n\n  const barWidth = (WIDTH / bufferLengthAlt) * 2.5\n  let barHeight\n  let x = 0\n\n  for (let i = 0; i < bufferLengthAlt; i++) {\n    barHeight = dataArrayAlt[i]\n\n    this.ctx.fillStyle = `rgb(${barHeight + 100},15,156)`\n    this.ctx.fillRect(x, HEIGHT - barHeight / 2, barWidth, barHeight / 2)\n\n    x += barWidth + 1\n  }\n}\n\ndraw()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["W3C media session ",(0,i.jsx)(n.a,{href:"https://w3c.github.io/mediasession",children:"specification"})]}),"\n",(0,i.jsxs)(n.li,{children:["MDN media session ",(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/MediaSession",children:"documentation"})]}),"\n",(0,i.jsxs)(n.li,{children:["Google media session ",(0,i.jsx)(n.a,{href:"https://web.dev/media-session",children:"blog"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},86145:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var a=t(57140);const i={},o=a.createContext(i);function s(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);