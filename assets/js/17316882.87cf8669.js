"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[59691],{42199:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"web/devops/webpack","title":"Webpack","description":"Workflow","source":"@site/content/web/devops/webpack.md","sourceDirName":"web/devops","slug":"/web/devops/webpack","permalink":"/notes/web/devops/webpack","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/devops/webpack.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"DevOps","permalink":"/notes/tags/dev-ops"},{"inline":true,"label":"Webpack","permalink":"/notes/tags/webpack"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":12,"frontMatter":{"sidebar_position":12,"tags":["Web","DevOps","Webpack"]},"sidebar":"tutorialSidebar","previous":{"title":"Babel","permalink":"/notes/web/devops/babel"},"next":{"title":"Bundlers","permalink":"/notes/web/devops/bundler"}}');var l=s(35656),i=s(86145);const t={sidebar_position:12,tags:["Web","DevOps","Webpack"]},o="Webpack",a={},c=[{value:"Workflow",id:"workflow",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Hot Module Replacement",id:"hot-module-replacement",level:2},{value:"Watch",id:"watch",level:2},{value:"Resolve Path",id:"resolve-path",level:2},{value:"Flags",id:"flags",level:2},{value:"Source Map",id:"source-map",level:2},{value:"Output",id:"output",level:2},{value:"Babel",id:"babel",level:2},{value:"CSS",id:"css",level:2},{value:"Static Assets",id:"static-assets",level:2},{value:"Resource",id:"resource",level:3},{value:"Inline",id:"inline",level:3},{value:"Source",id:"source",level:3},{value:"Thread",id:"thread",level:2},{value:"Web Worker",id:"web-worker",level:2},{value:"Plugins",id:"plugins",level:2},{value:"Code",id:"code",level:3},{value:"Image",id:"image",level:3},{value:"Build",id:"build",level:3},{value:"GUI",id:"gui",level:3},{value:"Migration",id:"migration",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"webpack",children:"Webpack"})}),"\n",(0,l.jsx)(n.h2,{id:"workflow",children:"Workflow"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://segmentfault.com/a/1190000039956437",children:"Webpack workflow"}),":"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Webpack Workflow",src:s(19178).A+"",title:"Webpack Workflow",width:"1156",height:"453"})}),"\n",(0,l.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsx)(n.p,{children:"Enable webpack configuration types intellisense:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm i -D webpack webpack-cli webpack-dev-server\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Enable ",(0,l.jsx)(n.code,{children:"devServer"})," type intellisense:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Add `devServer` type to `webpack.Configuration`\nnpm i -D @types/webpack-dev-server\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"/** @type {import('webpack').Configuration} */\nmodule.exports = {\n  entry: {\n    main: './src/index.ts',\n  },\n  output: {\n    filename: devMode ? '[name].js' : '[name].[contenthash].js',\n    path: path.resolve(__dirname, 'build'),\n  },\n  mode: devMode ? 'development' : 'production',\n  devServer: {\n    hot: true,\n    open: true,\n    port: 2333,\n  },\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"hot-module-replacement",children:"Hot Module Replacement"}),"\n",(0,l.jsx)(n.p,{children:"HMR:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4f7f\u7528 WDS \u6258\u7ba1\u9759\u6001\u8d44\u6e90, \u540c\u65f6\u4ee5 Runtime \u65b9\u5f0f\u6ce8\u5165 HMR \u5ba2\u6237\u7aef\u4ee3\u7801 (HMR Runtime)."}),"\n",(0,l.jsx)(n.li,{children:"\u6d4f\u89c8\u5668\u52a0\u8f7d\u9875\u9762\u540e, \u4e0e WDS \u5efa\u7acb WebSocket \u8fde\u63a5."}),"\n",(0,l.jsx)(n.li,{children:"Webpack \u76d1\u542c\u5230\u6587\u4ef6\u53d8\u5316\u540e, \u589e\u91cf\u6784\u5efa\u53d1\u751f\u53d8\u66f4\u7684\u6a21\u5757, \u5e76\u901a\u8fc7 WebSocket \u53d1\u9001 hash \u4e8b\u4ef6."}),"\n",(0,l.jsxs)(n.li,{children:["\u6d4f\u89c8\u5668\u63a5\u6536\u5230 hash \u4e8b\u4ef6\u540e, \u8bf7\u6c42 manifest (",(0,l.jsx)(n.code,{children:"[hash].hot-update.json"}),") \u8d44\u6e90\u6587\u4ef6, \u786e\u8ba4\u589e\u91cf\u53d8\u66f4\u8303\u56f4."]}),"\n",(0,l.jsx)(n.li,{children:"\u6d4f\u89c8\u5668\u52a0\u8f7d\u53d1\u751f\u53d8\u66f4\u7684\u589e\u91cf\u6a21\u5757."}),"\n",(0,l.jsxs)(n.li,{children:["\u6d4f\u89c8\u5668\u4e2d\u6ce8\u5165\u7684 HMR Runtime \u89e6\u53d1\u53d8\u66f4\u6a21\u5757\u7684 ",(0,l.jsx)(n.code,{children:"module.hot.accept"})," \u56de\u8c03, \u6267\u884c\u4ee3\u7801\u53d8\u66f4\u903b\u8f91."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Hot Module Replacement",src:s(52594).A+"",title:"Hot Module Replacement",width:"805",height:"837"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"module.hot.accept"})," \u6709\u4e24\u79cd\u8c03\u7528\u6a21\u5f0f:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u65e0\u53c2\u8c03\u7528\u6a21\u5f0f ",(0,l.jsx)(n.code,{children:"module.hot.accept()"}),": \u5f53\u524d\u6587\u4ef6\u4fee\u6539\u540e, \u91cd\u5934\u6267\u884c\u5f53\u524d\u6587\u4ef6\u4ee3\u7801."]}),"\n",(0,l.jsxs)(n.li,{children:["\u56de\u8c03\u8c03\u7528\u6a21\u5f0f ",(0,l.jsx)(n.code,{children:"module.hot.accept(path, callback)"}),": \u5e38\u7528\u6a21\u5f0f, \u76d1\u542c\u6a21\u5757\u53d8\u66f4, \u6267\u884c\u4ee3\u7801\u53d8\u66f4\u903b\u8f91."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"// \u8be5\u6a21\u5757\u4fee\u6539\u540e, `console.log('bar')` \u4f1a\u91cd\u65b0\u6267\u884c\nconsole.log('bar')\nmodule.hot.accept()\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"import component from './component'\n\nlet demoComponent = component()\ndocument.body.appendChild(demoComponent)\n\nif (module.hot) {\n  module.hot.accept('./component', () => {\n    const nextComponent = component()\n    document.body.replaceChild(nextComponent, demoComponent)\n    demoComponent = nextComponent\n  })\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"react-refresh-webpack-plugin"}),"/",(0,l.jsx)(n.code,{children:"vue-loader"}),"/",(0,l.jsx)(n.code,{children:"style-loader"}),"\n\u5229\u7528 ",(0,l.jsx)(n.code,{children:"module.hot.accept"})," \u5b9e\u73b0\u4e86 HMR (forceUpdate),\n\u65e0\u9700\u5f00\u53d1\u8005\u7f16\u5199\u70ed\u6a21\u5757\u66f4\u65b0\u903b\u8f91."]}),"\n",(0,l.jsx)(n.h2,{id:"watch",children:"Watch"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"echo fs.notify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n"})}),"\n",(0,l.jsx)(n.h2,{id:"resolve-path",children:"Resolve Path"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const TsconfigPathsPlugin = require('tsconfig-paths-webpack-plugin')\n\nmodule.exports = {\n  resolve: {\n    alias: {\n      '#': path.resolve(__dirname, '/'),\n      '~': path.resolve(__dirname, 'src'),\n      '@': path.resolve(__dirname, 'src'),\n      '~@': path.resolve(__dirname, 'src'),\n      'vendor': path.resolve(__dirname, 'src/vendor'),\n      '~component': path.resolve(__dirname, 'src/components'),\n      '~config': path.resolve(__dirname, 'config'),\n    },\n    extensions: ['.tsx', '.ts', '.jsx', '.js'],\n    plugins: [new TsconfigPathsPlugin({ configFile: './tsconfig.json' })],\n  },\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["get ",(0,l.jsx)(n.code,{children:"baseUrl"}),"and ",(0,l.jsx)(n.code,{children:"paths"})," from ",(0,l.jsx)(n.code,{children:"tsconfig.json"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const TsconfigPathsPlugin = require('tsconfig-paths-webpack-plugin')\n\nmodule.exports = {\n  resolve: {\n    plugins: [new TsconfigPathsPlugin({ configFile: './tsconfig.json' })],\n  },\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"jsconfig.json"})," for vscode resolve path:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    // This must be specified if "paths" is set\n    "baseUrl": ".",\n    // Relative to "baseUrl"\n    "paths": {\n      "*": ["*", "src/*"]\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    "target": "es2017",\n    "allowSyntheticDefaultImports": false,\n    "baseUrl": "./",\n    "paths": {\n      "Config/*": ["src/config/*"],\n      "Components/*": ["src/components/*"],\n      "Ducks/*": ["src/ducks/*"],\n      "Shared/*": ["src/shared/*"],\n      "App/*": ["src/*"]\n    }\n  },\n  "exclude": ["node_modules", "dist"]\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"flags",children:"Flags"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"--progress"}),"\n",(0,l.jsx)(n.li,{children:"--colors"}),"\n",(0,l.jsx)(n.li,{children:"-p"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"source-map",children:"Source Map"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Devtool"}),(0,l.jsx)(n.th,{children:"Build"}),(0,l.jsx)(n.th,{children:"Rebuild"}),(0,l.jsx)(n.th,{children:"Production"}),(0,l.jsx)(n.th,{children:"Quality"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"(none) / false"}),(0,l.jsx)(n.td,{children:"fastest"}),(0,l.jsx)(n.td,{children:"fastest"}),(0,l.jsx)(n.td,{children:"yes"}),(0,l.jsx)(n.td,{children:"bundle"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"eval"}),(0,l.jsx)(n.td,{children:"fast"}),(0,l.jsx)(n.td,{children:"fastest"}),(0,l.jsx)(n.td,{children:"no"}),(0,l.jsx)(n.td,{children:"generated"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"eval-cheap-source-map"}),(0,l.jsx)(n.td,{children:"ok"}),(0,l.jsx)(n.td,{children:"fast"}),(0,l.jsx)(n.td,{children:"no"}),(0,l.jsx)(n.td,{children:"transformed"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"eval-cheap-module-source-map"}),(0,l.jsx)(n.td,{children:"slow"}),(0,l.jsx)(n.td,{children:"fast"}),(0,l.jsx)(n.td,{children:"no"}),(0,l.jsx)(n.td,{children:"lines only"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"eval-source-map"}),(0,l.jsx)(n.td,{children:"slowest"}),(0,l.jsx)(n.td,{children:"ok"}),(0,l.jsx)(n.td,{children:"no"}),(0,l.jsx)(n.td,{children:"lines + rows"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"output",children:"Output"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const path = require('node:path')\n\nmodule.exports = {\n  entry: {\n    'bod-cli.min': path.join(__dirname, './src/index.js'),\n    'bod-cli': path.join(__dirname, './src/index.js'),\n  },\n  output: {\n    path: path.join(__dirname, './dist'),\n    filename: '[name].[contenthash].js',\n    library: 'bod',\n    libraryExport: 'default',\n    libraryTarget: 'esm',\n    globalObject: 'this',\n  },\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"babel",children:"Babel"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const config = {\n  test: /\\.(js|mjs|jsx|ts|tsx)$/,\n  include: path.resolve('src'),\n  use: [\n    'thread-loader',\n    {\n      loader: require.resolve('babel-loader'),\n    },\n  ],\n  options: {\n    customize: require.resolve('babel-preset-react-app/webpack-overrides'),\n    plugins: [\n      [\n        require.resolve('babel-plugin-named-asset-import'),\n        {\n          loaderMap: {\n            svg: {\n              ReactComponent: '@svgr/webpack?-svgo,+titleProp,+ref![path]',\n            },\n          },\n        },\n      ],\n      ['lodash'],\n    ],\n    cacheDirectory: true,\n    cacheCompression: false,\n    compact: isEnvProduction,\n  },\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"css",children:"CSS"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"style-loader"})," \u5c06 CSS \u52a8\u6001\u6ce8\u5165\u5230 DOM \u4e2d (",(0,l.jsx)(n.code,{children:"document.createElement('style')"}),"), \u5bfc\u81f4 DOM \u91cd\u65b0\u6e32\u67d3."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"production"})," \u4e0b\u9700\u5229\u7528 ",(0,l.jsx)(n.code,{children:"Webpack"})," \u5c06 CSS \u63d0\u524d\u6253\u5305 (",(0,l.jsx)(n.code,{children:"mini-css-extract-plugin"}),"):","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4f18\u5148\u52a0\u8f7d critical CSS in ",(0,l.jsx)(n.code,{children:"<head>"}),"."]}),"\n",(0,l.jsx)(n.li,{children:"Lazy loading non-critical CSS."}),"\n",(0,l.jsx)(n.li,{children:"Split up non-initial page CSS."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Next.js"})," \u4e0d\u5141\u8bb8 ",(0,l.jsx)(n.code,{children:":global(.global-class)"}),":\n",(0,l.jsx)(n.code,{children:"modules.mode"})," \u8bbe\u7f6e\u4e3a ",(0,l.jsx)(n.a,{href:"https://github.com/vercel/next.js/blob/v12.1.6/packages/next/build/webpack/config/blocks/css/loaders/modules.ts#L42-L44",children:(0,l.jsx)(n.code,{children:"pure"})}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const CssMinimizerPlugin = require('css-minimizer-webpack-plugin')\nconst MiniCssExtractPlugin = require('mini-css-extract-plugin')\n\nconst devMode = process.env.NODE_ENV !== 'production'\n\nmodule.exports = {\n  module: {\n    rules: [\n      {\n        test: /.s?css$/,\n        exclude: /node_modules$/,\n        use: [\n          devMode ? 'style-loader' : MiniCssExtractPlugin.loader,\n          {\n            loader: 'css-loader',\n            options: {\n              modules: {\n                compileType: 'module',\n                localIdentName: '[local]__[hash:base64:5]',\n              },\n            },\n          },\n          'sass-loader',\n          {\n            loader: 'postcss-loader',\n            options: {\n              postcssOptions: {\n                plugins: [['autoprefixer']],\n              },\n            },\n          },\n        ],\n      },\n    ],\n  },\n  optimization: {\n    minimizer: [\n      // `...`,\n      new CssMinimizerPlugin(),\n    ],\n  },\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"static-assets",children:"Static Assets"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/tcoopman/image-webpack-loader",children:"ImageMin Loader"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"asset/resource"})," emits separate file and exports the URL\n(",(0,l.jsx)(n.code,{children:"file-loader"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"asset/inline"})," exports data URI of the asset\n(url-loader)."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"asset/source"})," exports source code of the asset\n(raw-loader)."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"asset"})," automatically chooses between exporting data URI and separate file\n(",(0,l.jsx)(n.code,{children:"url-loader"})," with asset size limit, default ",(0,l.jsx)(n.code,{children:"8kb"}),")."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const config = {\n  rules: [\n    {\n      test: /\\.(png|jpg|gif|jpeg|webp|svg|eot|ttf|woff|woff2)$/,\n      type: 'asset',\n      parser: {\n        dataUrlCondition: {\n          maxSize: 4 * 1024, // 4kb\n        },\n      },\n    },\n  ],\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"resource",children:"Resource"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const path = require('node:path')\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    filename: 'main.js',\n    path: path.resolve(__dirname, 'dist'),\n    assetModuleFilename: 'images/[hash][ext][query]',\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.png/,\n        type: 'asset/resource',\n      },\n      {\n        test: /\\.html/,\n        type: 'asset/resource',\n        generator: {\n          filename: 'static/[hash][ext][query]',\n        },\n      },\n    ],\n  },\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"import mainImage from './images/main.png'\n\nimg.src = mainImage // '/dist/151cfcfa1bd74779aadb.png'\n"})}),"\n",(0,l.jsx)(n.h3,{id:"inline",children:"Inline"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const path = require('node:path')\nconst svgToMiniDataURI = require('mini-svg-data-uri')\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    filename: 'main.js',\n    path: path.resolve(__dirname, 'dist'),\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.svg/,\n        type: 'asset/inline',\n        generator: {\n          dataUrl: (content) => {\n            content = content.toString()\n            return svgToMiniDataURI(content)\n          },\n        },\n      },\n    ],\n  },\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"import metroMap from './images/metro.svg'\n\nblock.style.background = `url(${metroMap})`\n// => url(data:image/svg+xml;base64,PHN2ZyB4bW0iaHR0cDo...vc3ZnPgo=)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"source",children:"Source"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const path = require('node:path')\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    filename: 'main.js',\n    path: path.resolve(__dirname, 'dist'),\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.txt/,\n        type: 'asset/source',\n      },\n    ],\n  },\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"import exampleText from './example.txt'\n\nblock.textContent = exampleText // 'Hello world'\n"})}),"\n",(0,l.jsx)(n.h2,{id:"thread",children:"Thread"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const config = {\n  rules: [\n    {\n      loader: 'thread-loader',\n      // loaders with equal options will share worker pools\n      options: {\n        // the number of spawned workers, defaults to (number of cpus - 1) or\n        // fallback to 1 when require('os').cpus() is undefined\n        workers: 2,\n\n        // number of jobs a worker processes in parallel\n        // defaults to 20\n        workerParallelJobs: 50,\n\n        // additional node.js arguments\n        workerNodeArgs: ['--max-old-space-size=1024'],\n\n        // Allow to respawn a dead worker pool\n        // respawning slows down the entire compilation\n        // and should be set to false for development\n        poolRespawn: false,\n\n        // timeout for killing the worker processes when idle\n        // defaults to 500 (ms)\n        // can be set to Infinity for watching builds to keep workers alive\n        poolTimeout: 2000,\n\n        // number of jobs the poll distributes to the workers\n        // defaults to 200\n        // decrease of less efficient but more fair distribution\n        poolParallelJobs: 50,\n\n        // name of the pool\n        // can be used to create different pools with elseWise identical options\n        name: 'my-pool',\n      },\n    },\n    // your expensive loader (e.g. babel-loader)\n  ],\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const threadLoader = require('thread-loader')\n\nthreadLoader.warmup(\n  {\n    // pool options, like passed to loader options\n    // must match loader options to boot the correct pool\n  },\n  [\n    // modules to load\n    // can be any module, i. e.\n    'babel-loader',\n    'babel-preset-es2015',\n    'sass-loader',\n  ]\n)\n"})}),"\n",(0,l.jsx)(n.h2,{id:"web-worker",children:"Web Worker"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://github.com/Webpack-contrib/worker-loader",children:"Worker Loader"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm i -D worker-loader\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"module.exports = {\n  module: {\n    rules: [\n      {\n        test: /\\.worker\\.js$/,\n        use: { loader: 'worker-loader' },\n      },\n    ],\n  },\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"plugins",children:"Plugins"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"module.exports = {\n  plugins: [\n    function () {\n      this.hooks.done.tap('done', (stats) => {\n        if (\n          stats.compilation.errors\n          && stats.compilation.errors.length\n          && !process.argv.includes('--watch')\n        ) {\n          // Process build errors.\n          process.exit(1)\n        }\n      })\n    },\n  ],\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const childProcess = require('node:child_process')\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n\nconst branch = childProcess\n  .execSync('git rev-parse --abbrev-ref HEAD')\n  .toString()\n  .replace(/\\s+/, '')\nconst version = branch.split('/')[1]\nconst scripts = [\n  'https://cdn.bootcss.com/react-dom/16.9.0-rc.0/umd/react-dom.production.min.js',\n  'https://cdn.bootcss.com/react/16.9.0/umd/react.production.min.js',\n]\n\nclass HotLoad {\n  apply(compiler) {\n    compiler.hooks.beforeRun.tap('UpdateVersion', (compilation) => {\n      compilation.options.output.publicPath = `./${version}/`\n    })\n\n    compiler.hooks.compilation.tap('HotLoadPlugin', (compilation) => {\n      HtmlWebpackPlugin.getHooks(compilation).alterAssetTags.tapAsync(\n        'HotLoadPlugin',\n        (data, cb) => {\n          scripts.forEach(src => [\n            data.assetTags.scripts.unshift({\n              tagName: 'script',\n              voidTag: false,\n              attributes: { src },\n            }),\n          ])\n          cb(null, data)\n        }\n      )\n    })\n  }\n}\n\nmodule.exports = HotLoad\n"})}),"\n",(0,l.jsx)(n.h3,{id:"code",children:"Code"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/jantimon/html-webpack-plugin",children:"HTML Plugin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/webpack-contrib/terser-webpack-plugin",children:"UglifyJS Terser Plugin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/javascript-obfuscator/webpack-obfuscator",children:"JavaScript Obfuscator"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/aackerman/circular-dependency-plugin",children:"Circular Dependency Plugin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/hipstersmoothie/react-docgen-typescript-plugin",children:"TypeScript React Components Properties Parser"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/webpack-contrib/mini-css-extract-plugin",children:"Mini CSS Extract Plugin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/webpack-contrib/css-minimizer-webpack-plugin",children:"CSS Minimizer Plugin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/FullHuman/purgecss",children:"CSS Tree Shaking"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"image",children:"Image"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/Klathmon/imagemin-webpack-plugin",children:"ImageMin Plugin"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"build",children:"Build"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/webpack-contrib/thread-loader",children:"Thread Loader"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/mzgoddard/hard-source-webpack-plugin",children:"Hard Source Plugin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/stephencookdev/speed-measure-webpack-plugin",children:"Speed Measure Plugin"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/webpack-contrib/compression-webpack-plugin",children:"Compression Plugin"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/survivejs/webpack-merge",children:"Webpack Merge"}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"gui",children:"GUI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/webpack-contrib/webpack-bundle-analyzer",children:"Bundle Analyzer"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/unjs/webpackbar",children:"WebpackBar: elegant progressbar and profiler"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/webpackmonitor/webpackmonitor",children:"Monitor"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/zouhir/jarvis",children:"Browser UI"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/FormidableLabs/webpack-dashboard",children:"CLI UI"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"migration",children:"Migration"}),"\n",(0,l.jsxs)(n.p,{children:["Make sure there's ",(0,l.jsx)(n.a,{href:"https://webpack.js.org/migrate/5",children:"no webpack deprecation warnings"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"node --trace-deprecation node_modules/webpack/bin/webpack.js\n"})}),"\n",(0,l.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://nystudio107.com/blog/an-annotated-webpack-4-config-for-frontend-web-development",children:"Webpack 4 Tutorial"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://juejin.cn/post/6870055445034172424",children:"Custom Plugin"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},52594:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/hot-module-replacement-82f47dbe6965841b8749d4bd4e96c869.jpg"},19178:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/webpack-workflow-ee67ac3ad9501be2751c5a180b3ee80b.png"},86145:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var r=s(57140);const l={},i=r.createContext(l);function t(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);