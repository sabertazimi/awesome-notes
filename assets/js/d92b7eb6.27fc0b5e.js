"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[91314],{14070:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"web/javascript/webrtc","title":"WebRTC","description":"Communication","source":"@site/content/web/javascript/webrtc.md","sourceDirName":"web/javascript","slug":"/web/javascript/webrtc","permalink":"/notes/web/javascript/webrtc","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/webrtc.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Network","permalink":"/notes/tags/network"},{"inline":true,"label":"WebRTC","permalink":"/notes/tags/web-rtc"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":52,"frontMatter":{"sidebar_position":52,"tags":["Web","JavaScript","ECMAScript","Network","WebRTC"]},"sidebar":"tutorialSidebar","previous":{"title":"WebSocket","permalink":"/notes/web/javascript/websocket"},"next":{"title":"Animations","permalink":"/notes/web/javascript/animation"}}');var r=i(35656),s=i(86145);const l={sidebar_position:52,tags:["Web","JavaScript","ECMAScript","Network","WebRTC"]},c="WebRTC",a={},o=[{value:"Communication",id:"communication",level:2},{value:"Protocol",id:"protocol",level:2},{value:"Performance",id:"performance",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"webrtc",children:"WebRTC"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const ice = {\n  iceServers: [\n    { url: 'stun:stun.l.google.com:19302' },\n    { url: 'turn:user@turnserver.com', credential: 'pass' },\n  ],\n}\nconst signalingChannel = new SignalingChannel()\nconst pc = new RTCPeerConnection(ice)\n\nnavigator.getUserMedia({ audio: true }, getStream, logError)\n\nfunction getStream(evt) {\n  pc.addstream(evt.stream)\n\n  const localVideo = document.querySelector('#local-video')\n  localVideo.src = window.URL.createObjectURL(evt.stream)\n\n  pc.createOffer((offer) => {\n    pc.setLocalDescription(offer)\n    signalingChannel.send(offer.sdp)\n  })\n}\n\npc.onicecandidate = function (evt) {\n  if (evt.candidate)\n    signalingChannel.send(evt.candidate)\n}\n\npc.oniceconnectionstatechange = function (evt) {\n  logStatus(`ICE connection state change: ${evt.target.iceConnectionState}`)\n}\n\npc.onaddstream = function (evt) {\n  const remoteVideo = document.querySelector('#remote-video')\n  remoteVideo.src = window.URL.createObjectURL(evt.stream)\n}\n\nsignalingChannel.onmessage = function (msg) {\n  if (msg.candidate)\n    pc.addIceCandidate(msg.candidate)\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"communication",children:"Communication"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/WebRTC_API",children:"Web Real-Time Communication"}),"\n(Web \u5b9e\u65f6\u901a\u4fe1, WebRTC) \u7531\u4e00\u7ec4\u6807\u51c6, \u534f\u8bae\u548c JavaScript API \u7ec4\u6210,\n\u7528\u4e8e\u5b9e\u73b0\u6d4f\u89c8\u5668\u4e4b\u95f4 (\u7aef\u5230\u7aef, P2P) \u7684\u97f3\u9891/\u89c6\u9891/\u6570\u636e\u5171\u4eab:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/MediaStream",children:"MediaStream"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/RTCPeerConnection",children:"RTCPeerConnection"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7ba1\u7406\u7a7f\u900f NAT \u7684\u5b8c\u6574 ICE \u5de5\u4f5c\u6d41."}),"\n",(0,r.jsx)(n.li,{children:"\u53d1\u9001\u81ea\u52a8 (STUN) \u6301\u4e45\u5316\u4fe1\u53f7."}),"\n",(0,r.jsx)(n.li,{children:"\u8ddf\u8e2a\u672c\u5730\u6d41."}),"\n",(0,r.jsx)(n.li,{children:"\u8ddf\u8e2a\u8fdc\u7a0b\u6d41."}),"\n",(0,r.jsx)(n.li,{children:"\u6309\u9700\u89e6\u53d1\u81ea\u52a8\u6d41\u534f\u5546."}),"\n",(0,r.jsx)(n.li,{children:"\u751f\u6210\u8fde\u63a5\u63d0\u8bae, \u63a5\u6536\u5e94\u7b54, \u5141\u8bb8\u67e5\u8be2\u8fde\u63a5\u7684\u5f53\u524d\u72b6\u6001\u7b49."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/RTCDataChannel",children:"RTCDataChannel"}),":\nDataChannel API \u7528\u4e8e\u5b9e\u73b0\u7aef\u5230\u7aef\u4e4b\u95f4\u7684\u4efb\u610f\u5e94\u7528\u6570\u636e\u4ea4\u6362 (\u7aef\u5230\u7aef\u4ea4\u6362\u7248\u672c\u7684 WebSocket)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"WebRTC Engine",src:i(74570).A+"",title:"WebRTC Engine",width:"1265",height:"933"})}),"\n",(0,r.jsx)(n.h2,{id:"protocol",children:"Protocol"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"WebRTC Layer Protocol",src:i(6264).A+"",title:"WebRTC Layer Protocol",width:"1837",height:"894"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"WebRTC \u4f7f\u7528 UDP \u4f5c\u4e3a\u4f20\u8f93\u5c42\u534f\u8bae: \u4f4e\u5ef6\u8fdf\u548c\u53ca\u65f6\u6027\u624d\u662f\u5173\u952e."}),"\n",(0,r.jsxs)(n.li,{children:["ICE: Interactive Connectivity Establishment (RFC 5245).","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"STUN: Session Traversal Utilities for NAT (RFC 5389)."}),"\n",(0,r.jsx)(n.li,{children:"TURN: Traversal Using Relays around NAT (RFC 5766)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"SDP: Session Description Protocol (RFC 4566)."}),"\n",(0,r.jsx)(n.li,{children:"DTLS: Datagram Transport Layer Security (RFC 6347)."}),"\n",(0,r.jsx)(n.li,{children:"SCTP: Stream Control Transport Protocol (RFC 4960)."}),"\n",(0,r.jsx)(n.li,{children:"SRTP: Secure Real-Time Transport Protocol (RFC 3711)."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u53d1\u4fe1\u670d\u52a1:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4f7f\u7528\u4f4e\u5ef6\u8fdf\u4f20\u8f93\u673a\u5236."}),"\n",(0,r.jsx)(n.li,{children:"\u63d0\u4f9b\u8db3\u591f\u7684\u5bb9\u91cf."}),"\n",(0,r.jsx)(n.li,{children:"\u5efa\u7acb\u8fde\u63a5\u540e, \u8003\u8651\u4f7f\u7528 DataChannel \u53d1\u4fe1."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u9632\u706b\u5899\u548c NAT \u7a7f\u900f:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u521d\u59cb\u5316 RTCPeerConnection \u65f6\u63d0\u4f9b STUN \u670d\u52a1\u5668."}),"\n",(0,r.jsx)(n.li,{children:"\u5c3d\u53ef\u80fd\u4f7f\u7528\u589e\u91cf ICE, \u867d\u7136\u53d1\u4fe1\u6b21\u6570\u591a, \u4f46\u5efa\u7acb\u8fde\u63a5\u901f\u5ea6\u5feb."}),"\n",(0,r.jsx)(n.li,{children:"\u63d0\u4f9b STUN \u670d\u52a1\u5668, \u4ee5\u5907\u7aef\u5230\u7aef\u8fde\u63a5\u5931\u8d25\u540e\u8f6c\u53d1\u6570\u636e."}),"\n",(0,r.jsx)(n.li,{children:"\u9884\u8ba1\u5e76\u4fdd\u8bc1 TURN \u8f6c\u53d1\u65f6\u5bb9\u91cf\u8db3\u591f\u7528."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6570\u636e\u5206\u53d1:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5bf9\u4e8e\u5927\u578b\u591a\u65b9\u901a\u4fe1, \u8003\u8651\u4f7f\u7528\u8d85\u7ea7\u8282\u70b9\u6216\u4e13\u7528\u7684\u4e2d\u95f4\u8bbe\u5907."}),"\n",(0,r.jsx)(n.li,{children:"\u4e2d\u95f4\u8bbe\u5907\u5728\u8f6c\u53d1\u6570\u636e\u524d, \u8003\u8651\u5148\u5bf9\u5176\u8fdb\u884c\u4f18\u5316\u6216\u538b\u7f29."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6570\u636e\u6548\u7387:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5bf9\u97f3\u9891\u548c\u89c6\u9891\u6d41\u6307\u5b9a\u9002\u5f53\u7684\u5a92\u4f53\u7ea6\u675f."}),"\n",(0,r.jsx)(n.li,{children:"\u4f18\u5316\u901a\u8fc7 DataChannel \u53d1\u9001\u7684\u4e8c\u8fdb\u5236\u51c0\u8377."}),"\n",(0,r.jsx)(n.li,{children:"\u8003\u8651\u538b\u7f29\u901a\u8fc7 DataChannel \u53d1\u9001\u7684 UTF-8 \u6570\u636e."}),"\n",(0,r.jsx)(n.li,{children:"\u76d1\u63a7 DataChannel \u7f13\u51b2\u6570\u636e\u7684\u91cf, \u540c\u65f6\u6ce8\u610f\u9002\u5e94\u7f51\u7edc\u6761\u4ef6\u53d8\u5316."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4ea4\u4ed8\u53ca\u53ef\u9760\u6027:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4f7f\u7528\u4e71\u5e8f\u4ea4\u4ed8\u907f\u514d\u961f\u9996\u963b\u585e."}),"\n",(0,r.jsx)(n.li,{children:"\u5982\u679c\u4f7f\u7528\u6709\u5e8f\u4ea4\u4ed8, \u628a\u6d88\u606f\u5927\u5c0f\u63a7\u5236\u5230\u6700\u5c0f, \u4ee5\u964d\u4f4e\u961f\u9996\u963b\u585e\u7684\u5f71\u54cd."}),"\n",(0,r.jsx)(n.li,{children:"\u53d1\u9001\u5c0f\u6d88\u606f (\u5c0f\u4e8e 1150 \u5b57\u8282), \u4ee5\u4fbf\u5c06\u5206\u6bb5\u5e94\u7528\u6d88\u606f\u9020\u6210\u7684\u4e22\u5305\u635f\u5931\u964d\u81f3\u6700\u4f4e."}),"\n",(0,r.jsxs)(n.li,{children:["\u5bf9\u90e8\u5206\u53ef\u9760\u4ea4\u4ed8:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u8bbe\u7f6e\u9002\u5f53\u7684\u91cd\u4f20\u6b21\u6570\u548c\u8d85\u65f6\u95f4\u9694."}),"\n",(0,r.jsx)(n.li,{children:"\u6b63\u786e\u7684\u8bbe\u7f6e\u53d6\u51b3\u4e8e\u6d88\u606f\u5927\u5c0f, \u5e94\u7528\u6570\u636e\u7c7b\u578b, \u7aef\u4e0e\u7aef\u4e4b\u95f4\u7684\u5ef6\u8fdf."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://hpbn.co/webrtc",children:"WebRTC Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://dzone.com/articles/webrtc-security-vulnerabilities-you-should-know-ab",children:"WebRTC Security List"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},74570:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/web-rtc-engine-3efa376d25cb54089770b343f38d02dc.png"},6264:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/web-rtc-layer-protocol-218599046ac438940de64e1bcafe902f.png"},86145:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var t=i(57140);const r={},s=t.createContext(r);function l(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);