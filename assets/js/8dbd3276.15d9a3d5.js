"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[77969],{5427:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"web/javascript/fetch","title":"Fetch","description":"- GET: read resources.","source":"@site/content/web/javascript/fetch.md","sourceDirName":"web/javascript","slug":"/web/javascript/fetch","permalink":"/notes/web/javascript/fetch","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/fetch.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Network","permalink":"/notes/tags/network"},{"inline":true,"label":"Fetch","permalink":"/notes/tags/fetch"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":50,"frontMatter":{"sidebar_position":50,"tags":["Web","JavaScript","ECMAScript","Network","Fetch"]},"sidebar":"tutorialSidebar","previous":{"title":"Observer","permalink":"/notes/web/javascript/observer"},"next":{"title":"WebSocket","permalink":"/notes/web/javascript/websocket"}}');var r=t(35656),l=t(86145);const i={sidebar_position:50,tags:["Web","JavaScript","ECMAScript","Network","Fetch"]},o="Fetch",a={},c=[{value:"JSON",id:"json",level:2},{value:"Form Data",id:"form-data",level:2},{value:"Abort Controller",id:"abort-controller",level:2},{value:"APIs",id:"apis",level:2},{value:"Streaming",id:"streaming",level:2},{value:"Axios",id:"axios",level:2},{value:"AJAX",id:"ajax",level:2},{value:"Data Format",id:"data-format",level:3},{value:"Cross Origin Request",id:"cross-origin-request",level:3},{value:"RESTful",id:"restful",level:2},{value:"Server-Sent Events",id:"server-sent-events",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"fetch",children:"Fetch"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"GET: read resources."}),"\n",(0,r.jsx)(n.li,{children:"POST: create resources."}),"\n",(0,r.jsx)(n.li,{children:"PUT: fully update resources."}),"\n",(0,r.jsx)(n.li,{children:"PATCH: partially update resources."}),"\n",(0,r.jsx)(n.li,{children:"DELETE: delete resources."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const response = await fetch('/api/names', {\n  headers: {\n    Accept: 'application/json',\n  },\n})\n\nconst response = await fetch('/api/names', {\n  method: 'POST',\n  body: JSON.stringify(object),\n  headers: {\n    'Content-Type': 'application/json',\n  },\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"json",children:"JSON"}),"\n",(0,r.jsx)(n.p,{children:"JSON (JavaScript Object Notation) methods:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const obj = JSON.parse(json)\nconst json = JSON.stringify(obj)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://exploringjs.com/impatient-js/ch_json.html#json-replacers-revivers",children:(0,r.jsx)(n.code,{children:"JSON.stringify(value, filter, space)"})}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Symbol"}),"/",(0,r.jsx)(n.code,{children:"function"}),"/",(0,r.jsx)(n.code,{children:"NaN"}),"/",(0,r.jsx)(n.code,{children:"Infinity"}),"/",(0,r.jsx)(n.code,{children:"undefined"}),": ",(0,r.jsx)(n.code,{children:"null"}),"/ignored."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"BitInt"}),": throw ",(0,r.jsx)(n.code,{children:"TypeError"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Circular reference object: throw ",(0,r.jsx)(n.code,{children:"TypeError"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"toJSON"})," method:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const obj = {\n  name: 'zc',\n  toJSON() {\n    return 'return toJSON'\n  },\n}\n\n// return toJSON\nconsole.log(JSON.stringify(obj))\n\n// \"2022-03-06T08:24:56.138Z\"\nJSON.stringify(new Date())\n"})}),"\n",(0,r.jsx)(n.h2,{id:"form-data",children:"Form Data"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const imageFormData = new FormData()\nconst imageInput = document.querySelector('input[type=\"file\"][multiple]')\nconst imageFiles = imageInput.files\n\nfor (const file of imageFiles)\n  imageFormData.append('image', file)\n\nfetch('/img-upload', {\n  method: 'POST',\n  body: imageFormData,\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"abort-controller",children:"Abort Controller"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const abortController = new AbortController()\n\nfetch('wikipedia.zip', { signal: abortController.signal }).catch(() =>\n  console.log('Aborted!')\n)\n\n// 10 \u6beb\u79d2\u540e\u4e2d\u65ad\u8bf7\u6c42\nsetTimeout(() => abortController.abort(), 10)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"apis",children:"APIs"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Headers",children:[(0,r.jsx)(n.code,{children:"Headers"})," object"]}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const myHeaders = new Headers()\nmyHeaders.append('Content-Type', 'text/xml')\nmyHeaders.get('Content-Type') // should return 'text/xml'\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Request",children:[(0,r.jsx)(n.code,{children:"Request"})," object"]}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const request = new Request('/api/names', {\n  method: 'POST',\n  body: JSON.stringify(object),\n  headers: {\n    'Content-Type': 'application/json',\n  },\n})\n\nconst response = await fetch(request)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Response",children:[(0,r.jsx)(n.code,{children:"Response"})," object"]}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'fetch(\'//foo.com\').then(console.log)\n// Response {\n//   body: (...)\n//   bodyUsed: false\n//   headers: Headers {}\n//   ok: true\n//   redirected: false\n//   status: 200\n//   statusText: "OK"\n//   type: "basic"\n//   url: "https://foo.com/"\n// }\n\nfetch(\'//foo.com/redirect-me\').then(console.log)\n// Response {\n//   body: (...)\n//   bodyUsed: false\n//   headers: Headers {}\n//   ok: true\n//   redirected: true\n//   status: 200\n//   statusText: "OK"\n//   type: "basic"\n//   url: "https://foo.com/redirected-url/"\n// }\n\nfetch(\'//foo.com/does-not-exist\').then(console.log)\n// Response {\n//   body: (...)\n//   bodyUsed: false\n//   headers: Headers {}\n//   ok: false\n//   redirected: true\n//   status: 404\n//   statusText: "Not Found"\n//   type: "basic"\n//   url: "https://foo.com/does-not-exist/"\n// }\n\nfetch(\'//foo.com/throws-error\').then(console.log)\n// Response {\n//   body: (...)\n//   bodyUsed: false\n//   headers: Headers {}\n//   ok: false\n//   redirected: true\n//   status: 500\n//   statusText: "Internal Server Error"\n//   type: "basic"\n//   url: "https://foo.com/throws-error/"\n// }\n'})}),"\n",(0,r.jsx)(n.h2,{id:"streaming",children:"Streaming"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Request"}),"/",(0,r.jsx)(n.code,{children:"Response"})," ",(0,r.jsx)(n.code,{children:"body"})," (",(0,r.jsx)(n.code,{children:"ReadableStream"}),") methods:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"text()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"json()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"formData()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"arrayBuffer()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"blob()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"bodyUsed"}),": \u5e03\u5c14\u503c, \u8868\u793a ",(0,r.jsx)(n.code,{children:"ReadableStream"})," \u662f\u5426\u5df2\u6444\u53d7 (",(0,r.jsx)(n.code,{children:"disturbed"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"fetch('https://fetch.spec.whatwg.org/')\n  .then(response => response.body)\n  .then((body) => {\n    const reader = body.getReader()\n\n    function processNextChunk({ value, done }) {\n      if (done)\n        return\n\n      console.log(value)\n      return reader.read().then(processNextChunk)\n    }\n\n    return reader.read().then(processNextChunk)\n  })\n// { value: Uint8Array{}, done: false }\n// { value: Uint8Array{}, done: false }\n// { value: Uint8Array{}, done: false }\n// ...\n\nfetch('https://fetch.spec.whatwg.org/')\n  .then(response => response.body)\n  .then(async (body) => {\n    const reader = body.getReader()\n\n    while (true) {\n      const { value, done } = await reader.read()\n\n      if (done)\n        break\n\n      console.log(value)\n    }\n  })\n// { value: Uint8Array{}, done: false }\n// { value: Uint8Array{}, done: false }\n// { value: Uint8Array{}, done: false }\n// ...\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"fetch('https://fetch.spec.whatwg.org/')\n  .then(response => response.body)\n  .then(async (body) => {\n    const reader = body.getReader()\n    const asyncIterable = {\n      [Symbol.asyncIterator]() {\n        return {\n          next() {\n            return reader.read()\n          },\n        }\n      },\n    }\n\n    for await (const chunk of asyncIterable)\n      console.log(chunk)\n  })\n// { value: Uint8Array{}, done: false }\n// { value: Uint8Array{}, done: false }\n// { value: Uint8Array{}, done: false }\n// ...\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'async function* streamGenerator(stream) {\n  const reader = stream.getReader()\n\n  try {\n    while (true) {\n      const { value, done } = await reader.read()\n\n      if (done)\n        break\n\n      yield value\n    }\n  } finally {\n    reader.releaseLock()\n  }\n}\n\nconst decoder = new TextDecoder()\n\nfetch(\'https://fetch.spec.whatwg.org/\')\n  .then(response => response.body)\n  .then(async (body) => {\n    for await (const chunk of streamGenerator(body))\n      console.log(decoder.decode(chunk, { stream: true }))\n  })\n// <!doctype html><html lang="en"> ...\n// whether a <a data-link-type="dfn" href="#concept-header" ...\n// result to <var>rangeValue</var>. ...\n// ...\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'fetch(\'https://fetch.spec.whatwg.org/\')\n  .then(response => response.body)\n  .then((body) => {\n    const reader = body.getReader()\n    // \u521b\u5efa\u7b2c\u4e8c\u4e2a\u6d41\n    return new ReadableStream({\n      async start(controller) {\n        try {\n          while (true) {\n            const { value, done } = await reader.read()\n\n            if (done)\n              break\n\n            // \u5c06\u4e3b\u4f53\u6d41\u7684\u5757\u63a8\u5230\u7b2c\u4e8c\u4e2a\u6d41\n            controller.enqueue(value)\n          }\n        } finally {\n          controller.close()\n          reader.releaseLock()\n        }\n      },\n    })\n  })\n  .then(secondaryStream => new Response(secondaryStream))\n  .then(response => response.text())\n  .then(console.log)\n// <!doctype html><html lang="en"><head><meta charset="utf-8"> ...\n'})}),"\n",(0,r.jsx)(n.h2,{id:"axios",children:"Axios"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.request(config)"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.get(url[, config])"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.delete(url[, config])"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.head(url[, config])"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.options(url[, config])"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.post(url[, data[, config]])"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.put(url[, data[, config]])"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.patch(url[, data[, config]])"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"client.getUri([config])"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const client = axios.create({\n  baseURL: 'https://some-domain.com/api/',\n  timeout: 1000,\n  headers: { 'X-Custom-Header': 'foobar' },\n})\n\n// Add a request interceptor\nclient.interceptors.request.use(\n  (config) => {\n    // Do something before request is sent.\n    return config\n  },\n  (error) => {\n    // Do something with request error.\n    return Promise.reject(error)\n  }\n)\n\nclient.interceptors.response.use(\n  (response) => {\n    // Any status code that lie within the range of 2xx trigger this function.\n    // Do something with response data.\n    return response\n  },\n  (error) => {\n    // Any status codes that falls outside the range of 2xx trigger this function.\n    // Do something with response error.\n    return Promise.reject(error)\n  }\n)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"ajax",children:"AJAX"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const XHR = (function () {\n  const standard = {\n    createXHR() {\n      return new XMLHttpRequest()\n    },\n  }\n  const newActionXObject = {\n    createXHR() {\n      return new ActionXObject('Msxml12.XMLHTTP')\n    },\n  }\n  const oldActionXObject = {\n    createXHR() {\n      return new ActionXObject('Microsoft.XMLHTTP')\n    },\n  }\n\n  // \u6839\u636e\u517c\u5bb9\u6027\u8fd4\u56de\u5bf9\u5e94\u7684\u5de5\u5382\u5bf9\u8c61\n  // \u6b64\u7acb\u5373\u51fd\u6570\u8fd0\u884c\u4e00\u6b21\u5373\u53ef\u5b8c\u6210\u517c\u5bb9\u6027\u68c0\u67e5, \u9632\u6b62\u91cd\u590d\u68c0\u67e5\n  if (standard.createXHR()) {\n    return standard\n  } else {\n    try {\n      newActionXObject.createXHR()\n      return newActionXObject\n    } catch (o) {\n      oldActionXObject.createXHR()\n      return oldActionXObject\n    }\n  }\n})()\n\nconst request = XHR.createXHR()\n\n// 3rd argument : async mode\nrequest.open('GET', 'example.txt', true)\n\nrequest.onreadystatechange = function () {\n  // do something\n  /*\n  switch(request.readyState) {\n    case 0: initialize\n    case 1: loading\n    case 2: loaded\n    case 3: transaction\n    case 4: complete\n  }\n  */\n  if (request.readyState === 4) {\n    const para = document.createElement('p')\n    const txt = document.createTextNode(request.responseText)\n    para.appendChild(txt)\n    document.getElementById('new').appendChild(para)\n  }\n}\n\nrequest.send(null)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"ajax({\n  url: './TestXHR.aspx', // \u8bf7\u6c42\u5730\u5740\n  type: 'POST', // \u8bf7\u6c42\u65b9\u5f0f\n  data: { name: 'super', age: 20 }, // \u8bf7\u6c42\u53c2\u6570\n  dataType: 'json',\n  success(response, xml) {\n    // \u6b64\u5904\u653e\u6210\u529f\u540e\u6267\u884c\u7684\u4ee3\u7801\n  },\n  fail(status) {\n    // \u6b64\u5904\u653e\u5931\u8d25\u540e\u6267\u884c\u7684\u4ee3\u7801\n  },\n})\n\nfunction ajax(options) {\n  options = options || {}\n  options.type = (options.type || 'GET').toUpperCase()\n  options.dataType = options.dataType || 'json'\n  const params = formatParams(options.data)\n  let xhr\n\n  // \u521b\u5efa - \u975eIE6 - \u7b2c\u4e00\u6b65\n  if (window.XMLHttpRequest) {\n    xhr = new XMLHttpRequest()\n  } else {\n    // IE6\u53ca\u5176\u4ee5\u4e0b\u7248\u672c\u6d4f\u89c8\u5668\n    xhr = new ActiveXObject('Microsoft.XMLHTTP')\n  }\n\n  // \u63a5\u6536 - \u7b2c\u4e09\u6b65\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState === 4) {\n      const status = xhr.status\n      if (status >= 200 && status < 300)\n        options.success && options.success(xhr.responseText, xhr.responseXML)\n      else\n        options.fail && options.fail(status)\n    }\n  }\n\n  // \u8fde\u63a5 \u548c \u53d1\u9001 - \u7b2c\u4e8c\u6b65\n  if (options.type === 'GET') {\n    xhr.open('GET', `${options.url}?${params}`, true)\n    xhr.send(null)\n  } else if (options.type === 'POST') {\n    xhr.open('POST', options.url, true)\n    // \u8bbe\u7f6e\u8868\u5355\u63d0\u4ea4\u65f6\u7684\u5185\u5bb9\u7c7b\u578b\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n    xhr.send(params)\n  }\n}\n\n// \u683c\u5f0f\u5316\u53c2\u6570\nfunction formatParams(data) {\n  const arr = []\n\n  for (const name in data)\n    arr.push(`${encodeURIComponent(name)}=${encodeURIComponent(data[name])}`)\n\n  arr.push(`v=${Math.random()}`.replace('.', ''))\n  return arr.join('&')\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function getJSON(url) {\n  return new Promise((resolve, reject) => {\n    const request = new XMLHttpRequest()\n\n    request.open('GET', url)\n\n    request.onload = function () {\n      try {\n        if (this.status === 200)\n          resolve(JSON.parse(this.response))\n        else\n          reject(new Error(`${this.status} ${this.statusText}`))\n      } catch (e) {\n        reject(e.message)\n      }\n    }\n\n    request.onerror = function () {\n      reject(new Error(`${this.status} ${this.statusText}`))\n    }\n\n    request.send()\n  })\n}\n\ngetJSON('data/sample.json')\n  .then((ninjas) => {\n    assert(ninjas !== null, 'Get data')\n  })\n  .catch(e => handleError(`Error: ${e}`))\n"})}),"\n",(0,r.jsx)(n.h3,{id:"data-format",children:"Data Format"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Format"}),(0,r.jsx)(n.th,{style:{textAlign:"right"},children:"Size (bytes)"}),(0,r.jsx)(n.th,{style:{textAlign:"right"},children:"Download (ms)"}),(0,r.jsx)(n.th,{style:{textAlign:"right"},children:"Parse (ms)"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Verbose XML"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"582,960"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"999.4"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"343.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Verbose JSON-P"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"487,913"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"598.2"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"0.0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Simple XML"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"437,960"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"475.1"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"83.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Verbose JSON"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"487,895"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"527.7"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"26.7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Simple JSON"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"392,895"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"498.7"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"29.0"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Simple JSON-P"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"392,913"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"454.0"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"3.1"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Array JSON"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"292,895"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"305.4"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"18.6"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Array JSON-P"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"292,912"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"316.0"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"3.4"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Custom Format (script insertion)"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"222,912"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"66.3"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"11.7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Custom Format (XHR)"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"222,892"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"63.1"}),(0,r.jsx)(n.td,{style:{textAlign:"right"},children:"14.5"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"cross-origin-request",children:"Cross Origin Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- HTML --\x3e\n<meta http-equiv="Access-Control-Allow-Origin" content="*" />\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"Response.Headers.Add('Access-Control-Allow-Origin', '*')\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"$.ajax({\n  url: 'http://map.oicqzone.com/gpsApi.php?lat=22.502412986242&lng=113.93832783228',\n  type: 'GET',\n  dataType: 'JSONP', // \u5904\u7406 AJAX \u8de8\u57df\u95ee\u9898.\n  success(data) {\n    $('body').append(`Name: ${data}`)\n  },\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"restful",children:"RESTful"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Client/Server architecture."}),"\n",(0,r.jsx)(n.li,{children:"Stateless."}),"\n",(0,r.jsx)(n.li,{children:"Cacheable."}),"\n",(0,r.jsx)(n.li,{children:"Layer system."}),"\n",(0,r.jsx)(n.li,{children:"Code via need."}),"\n",(0,r.jsx)(n.li,{children:"Isomorphic interface."}),"\n",(0,r.jsxs)(n.li,{children:["Design ",(0,r.jsx)(n.a,{href:"https://github.com/aisuhua/restful-api-design-references",children:"reference"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"server-sent-events",children:"Server-Sent Events"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Event source ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/EventSource",children:"API"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Server-sent events ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Server-sent_events/Using_server-sent_events",children:"API"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const source = new EventSource('/path/to/stream-url')\n\nsource.onopen = function () {}\n\nsource.onerror = function () {}\n\nsource.addEventListener('foo', (event) => {\n  processFoo(event.data)\n})\n\nsource.addEventListener('ping', (event) => {\n  processPing(JSON.parse(event.data).time)\n})\n\nsource.onmessage = function (event) {\n  log(event.id, event.data)\n  if (event.id === 'CLOSE')\n    source.close()\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},86145:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(57140);const r={},l=s.createContext(r);function i(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);