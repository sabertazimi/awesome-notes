"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[26370],{46429:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"web/react/redux/best-practices","title":"Best Practices","description":"- \u533a\u5206 Smart Component (know the state) \u548c Dump Component (stateless)","source":"@site/content/web/react/redux/best-practices.md","sourceDirName":"web/react/redux","slug":"/web/react/redux/best-practices","permalink":"/notes/web/react/redux/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/react/redux/best-practices.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"React","permalink":"/notes/tags/react"},{"inline":true,"label":"Redux","permalink":"/notes/tags/redux"},{"inline":true,"label":"State Management","permalink":"/notes/tags/state-management"},{"inline":true,"label":"Best Practice","permalink":"/notes/tags/best-practice"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":7,"frontMatter":{"sidebar_position":7,"tags":["Web","React","Redux","State Management","Best Practice"]},"sidebar":"tutorialSidebar","previous":{"title":"Performance","permalink":"/notes/web/react/redux/performance"},"next":{"title":"Internals","permalink":"/notes/web/react/redux/internals"}}');var s=n(35656),a=n(86145);const i={sidebar_position:7,tags:["Web","React","Redux","State Management","Best Practice"]},c="Best Practices",d={},l=[{value:"Necessity",id:"necessity",level:2},{value:"Style Guide",id:"style-guide",level:2},{value:"States",id:"states",level:2}];function o(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"best-practices",children:"Best Practices"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"\u533a\u5206 Smart Component (know the state) \u548c Dump Component (stateless)"}),"\n",(0,s.jsx)(t.li,{children:"Component \u91cc\u4e0d\u8981\u51fa\u73b0\u4efb\u4f55 async calls\uff0c\u4ea4\u7ed9 action creator \u6765\u505a"}),"\n",(0,s.jsx)(t.li,{children:"Reducer \u5c3d\u91cf\u7b80\u5355\uff0c\u590d\u6742\u7684\u4ea4\u7ed9 action creator"}),"\n",(0,s.jsx)(t.li,{children:"Reducer \u91cc return \u65b0 state \u7684\u65f6\u5019\uff1a"}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/gaearon/redux-devtools",children:"Redux Devtools"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/iraycd/React-Redux-Styleguide",children:"Redux React Style Guide"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/rematch/rematch",children:"Simple Redux API"})}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:'// add new item to state array\r\n// bad and does not work case "ADD":\r\nstate.push(newItem)\r\n// Good case "ADD":\r\nreturn [...state, newItem]\r\n\r\n// delete new item to state array\r\n// bad and does not work case "DELETE":\r\nstate.splice(index, 1)\r\n// Good case "DELETE":\r\nstate.slice(0, index).concat(state.slice(index + 1))\r\n\r\n// update new item to state array\r\n// First way case "EDIT":\r\nstate\r\n  .slice(0, index)\r\n  .concat([{ id: \'id\', value: \'newValue\' }])\r\n  .slice(index + 1)\r\n// Second way case "EDIT":\r\nstate.map((item) => {\r\n  if (item.id === \'id\') {\r\n    return {\r\n      ...item,\r\n      value: \'newValue\',\r\n    }\r\n  } else {\r\n    return item\r\n  }\r\n})\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Action creator: \u7528 promise/async/await \u4ee5\u53ca redux-thunk \u5b9e\u73b0\u5f02\u6b65\u64cd\u4f5c."}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// bad\r\nfunction loadTodo(id) {\r\n  return async (dispatch, getState) => {\r\n    // only fetch the todo if it isn't already loaded\r\n    if (!getState().todos.includes(id)) {\r\n      const todo = await fetch(`/todos/${id}`)\r\n      dispatch(addTodo(todo))\r\n    }\r\n  }\r\n}\r\n\r\n// good\r\nfunction loadTodo(id, todos) {\r\n  return async (dispatch) => {\r\n    // only fetch the todo if it isn't already loaded\r\n    if (!todos.includes(id)) {\r\n      const todo = await fetch(`/todos/${id}`)\r\n      dispatch(addTodo(todo))\r\n    }\r\n  }\r\n}\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"const fluxStandardAction = {\r\n  type: 'ADD_TODO',\r\n  payload: {\r\n    text: 'Do something',\r\n  },\r\n  meta,\r\n}\r\n\r\nconst fluxStandardAction = {\r\n  type: 'ADD_TODO',\r\n  payload: new Error('Error'),\r\n  error: true,\r\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"necessity",children:"Necessity"}),"\n",(0,s.jsx)(t.p,{children:"Necessity for importing Redux\r\n(\u72b6\u6001\u591a, \u53d8\u5316\u5feb, \u66f4\u65b0\u590d\u6742):"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Lots of state."}),"\n",(0,s.jsx)(t.li,{children:"Frequent update state."}),"\n",(0,s.jsx)(t.li,{children:"Complex update state."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"style-guide",children:"Style Guide"}),"\n",(0,s.jsxs)(t.p,{children:["Redux style ",(0,s.jsx)(t.a,{href:"https://redux.js.org/style-guide/style-guide",children:"guide"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Only one store per app."}),"\n",(0,s.jsx)(t.li,{children:"Avoid mutate state without ImmerJS."}),"\n",(0,s.jsx)(t.li,{children:"Avoid side effects in reducers."}),"\n",(0,s.jsx)(t.li,{children:"Avoid non-serializable values in state store."}),"\n",(0,s.jsx)(t.li,{children:"Normalize complex nested/relational state."}),"\n",(0,s.jsx)(t.li,{children:"Keep state minimal and derive additional values."}),"\n",(0,s.jsxs)(t.li,{children:["Split large data selection into multiple small ",(0,s.jsx)(t.code,{children:"useSelector"}),"."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"states",children:"States"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Remote state:\r\nAnything coming from backend, API, database, etc.,\r\ncould be handled by data-fetching library\r\nlike ",(0,s.jsx)(t.a,{href:"https://github.com/tanstack/query",children:"TanStack Query"})," or ",(0,s.jsx)(t.a,{href:"https://github.com/vercel/swr",children:"SWR"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Query params in URL state:\r\nIf your router doesn't support syncing those with local state,\r\nuse ",(0,s.jsx)(t.a,{href:"https://github.com/47ng/nuqs",children:"nuqs"})," and save yourself massive pain implementing that sync manually."]}),"\n",(0,s.jsxs)(t.li,{children:["Local state:\r\n\u4f5c\u4e3a\u7ec4\u4ef6\u5c40\u90e8\u72b6\u6001\u7ba1\u7406\u5668\u6765\u7528.\r\n\u5bf9\u4e8e\u53ea\u5f71\u54cd\u5355\u4e2a\u7ec4\u4ef6\u5b9e\u4f8b\u7684\u72b6\u6001,\r\n\u5e94\u4f5c\u4e3a Local State \u4ea4\u7531 ",(0,s.jsx)(t.code,{children:"useState"}),"/",(0,s.jsx)(t.code,{children:"useReducer"})," \u7ba1\u7406,\r\n\u800c\u4e0d\u662f\u5c06\u5176\u5e76\u5165 Global Store."]}),"\n",(0,s.jsxs)(t.li,{children:["Complex shared state:\r\nSplit state into different atoms\r\nwith ",(0,s.jsx)(t.a,{href:"https://github.com/pmndrs/zustand",children:"Zustand"})," or ",(0,s.jsx)(t.a,{href:"https://github.com/pmndrs/jotai",children:"JoTai"}),",\r\natoms can be imported for any specific component ",(0,s.jsx)(t.strong,{children:"without single-entry point"}),",\r\neach atom handling different app domain/context (reducer)."]}),"\n",(0,s.jsx)(t.li,{children:"Complex UI change: \u7528 component \u5f52\u4e00\u5316\u5904\u7406."}),"\n",(0,s.jsx)(t.li,{children:"Complex data input: \u7528 RxJS/observable \u5f52\u4e00\u5316\u5904\u7406."}),"\n",(0,s.jsx)(t.li,{children:"Complex state change: \u7528 action/state \u5f52\u4e00\u5316\u5904\u7406."}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},86145:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>c});var r=n(57140);const s={},a=r.createContext(s);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);