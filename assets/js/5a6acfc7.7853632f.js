"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[97971],{94265:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>b,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"web/devops/babel","title":"Babel","description":"Core","source":"@site/content/web/devops/babel.md","sourceDirName":"web/devops","slug":"/web/devops/babel","permalink":"/notes/web/devops/babel","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/devops/babel.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"DevOps","permalink":"/notes/tags/dev-ops"},{"inline":true,"label":"Babel","permalink":"/notes/tags/babel"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":11,"frontMatter":{"sidebar_position":11,"tags":["Web","DevOps","Babel"]},"sidebar":"tutorialSidebar","previous":{"title":"Linters","permalink":"/notes/web/devops/lint"},"next":{"title":"Webpack","permalink":"/notes/web/devops/webpack"}}');var r=s(35656),a=s(86145);const l={sidebar_position:11,tags:["Web","DevOps","Babel"]},i="Babel",o={},d=[{value:"Core",id:"core",level:2},{value:"Transform",id:"transform",level:2},{value:"Preset",id:"preset",level:2},{value:"CodeMod",id:"codemod",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"babel",children:"Babel"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"babel example.js -o compiled.js\nbabel src -d lib -s\n"})}),"\n",(0,r.jsx)(n.h2,{id:"core",children:"Core"}),"\n",(0,r.jsx)(n.p,{children:"\u63d0\u4f9b babel \u8f6c\u7801 API"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm install babel-core --save\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const babel = require('babel-core')\n\n// \u5b57\u7b26\u4e32\u8f6c\u7801\nbabel.transform('code();', options)\n// => { code, map, ast }\n\n// \u6587\u4ef6\u8f6c\u7801 (\u5f02\u6b65)\nbabel.transformFile('filename.js', options, (err, result) => {\n  process(err)\n  return result // => { code, map, ast }\n})\n\n// \u6587\u4ef6\u8f6c\u7801 (\u540c\u6b65)\nbabel.transformFileSync('filename.js', options)\n// => { code, map, ast }\n\n// Babel AST\u8f6c\u7801\nbabel.transformFromAst(ast, code, options)\n// => { code, map, ast }\n"})}),"\n",(0,r.jsx)(n.h2,{id:"transform",children:"Transform"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Visitor pattern with Babel."}),"\n",(0,r.jsxs)(n.li,{children:["Named ",(0,r.jsx)(n.code,{children:"babel-plugin-transform-xxx"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "main": "index.js"\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// index.js\nmodule.exports = (babel) => {\n  const t = babel.types\n  let isJSXExisted = false\n  let isMeactContextEnabled = false\n\n  return {\n    visitor: {\n      Program: {\n        exit(path) {\n          if (isJSXExisted === true && isMeactContextEnabled === false)\n            throw path.buildCodeFrameError(`Meact isn't in current context!`)\n        },\n      },\n      ImportDeclaration(path, state) {\n        if (path.node.specifiers[0].local.name === 'Meact')\n          isMeactContextEnabled = true\n      },\n      MemberExpression(path, state) {\n        if (\n          path.node.object.name === 'React'\n          && path.node.property.name === 'createElement'\n        ) {\n          isJSXExisted = true\n          path.replaceWith(\n            t.MemberExpression(\n              t.identifier('Meact'),\n              t.identifier('createElement')\n            )\n          )\n        }\n      },\n    },\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Babel plugins:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Define ",(0,r.jsx)(n.a,{href:"https://github.com/FormidableLabs/babel-plugin-transform-define",children:"plugin"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"preset",children:"Preset"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Just like ",(0,r.jsx)(n.code,{children:".babelrc.js"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Named ",(0,r.jsx)(n.code,{children:"babel-preset-xxx"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'// package.json\n{\n  "main": "index.js",\n  "dependencies": {\n    "babel-plugin-transform-meact-jsx": "^0.1.2",\n    "@babel/plugin-proposal-object-rest-spread": "^7.0.0",\n    "@babel/plugin-transform-react-jsx": "^7.0.0",\n    "@babel/plugin-transform-runtime": "^7.0.0",\n    "@babel/preset-env": "^7.0.0"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// index.js\nconst defaultTargets = {\n  android: 30,\n  chrome: 35,\n  edge: 14,\n  explorer: 9,\n  firefox: 52,\n  safari: 8,\n  ucandroid: 1,\n}\n\nfunction buildTargets(options) {\n  return Object.assign({}, defaultTargets, options.additionalTargets)\n}\n\nmodule.exports = function buildMeactPreset(context, options) {\n  const transpileTargets\n    = (options && options.targets) || buildTargets(options || {})\n\n  return {\n    presets: [\n      require('@babel/preset-env').default(null, {\n        targets: transpileTargets,\n        modules: false,\n      }),\n    ],\n    plugins: [\n      require('@babel/plugin-proposal-object-rest-spread'),\n      require('@babel/plugin-transform-react-jsx'),\n      require('babel-plugin-transform-meact-jsx'),\n      require('@babel/plugin-transform-runtime'),\n    ].filter(Boolean),\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"codemod",children:"CodeMod"}),"\n",(0,r.jsx)(n.p,{children:"Use Babel to refactor code:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/facebook/jscodeshift",children:"JSCodeshift"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/reactjs/react-codemod",children:"ReactCodemod"})}),"\n"]})]})}function b(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},86145:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>i});var t=s(57140);const r={},a=t.createContext(r);function l(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);