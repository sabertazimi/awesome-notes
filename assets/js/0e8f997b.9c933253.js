"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[75189],{57154:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"web/javascript/inheritance","title":"Inheritance","description":"Prototype Proxy","source":"@site/content/web/javascript/inheritance.md","sourceDirName":"web/javascript","slug":"/web/javascript/inheritance","permalink":"/notes/web/javascript/inheritance","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/inheritance.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Object","permalink":"/notes/tags/object"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":15,"frontMatter":{"sidebar_position":15,"tags":["Web","JavaScript","ECMAScript","Object"]},"sidebar":"tutorialSidebar","previous":{"title":"Property","permalink":"/notes/web/javascript/property"},"next":{"title":"Class","permalink":"/notes/web/javascript/class"}}');var t=r(35656),l=r(86145);const s={sidebar_position:15,tags:["Web","JavaScript","ECMAScript","Object"]},i="Inheritance",c={},a=[{value:"Prototype Proxy",id:"prototype-proxy",level:2},{value:"Class Simulation",id:"class-simulation",level:2},{value:"Composite",id:"composite",level:2},{value:"Clone",id:"clone",level:2},{value:"Shallow",id:"shallow",level:3},{value:"Deep",id:"deep",level:3},{value:"Global Object",id:"global-object",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"inheritance",children:"Inheritance"})}),"\n",(0,t.jsx)(n.h2,{id:"prototype-proxy",children:"Prototype Proxy"}),"\n",(0,t.jsx)(n.p,{children:"\u53ef\u7528\u4e8e\u6240\u6709\u7ee7\u627f\u6a21\u5f0f\u4e2d, \u51cf\u5c11\u5185\u5b58\u6d88\u8017:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"const inherit = (function () {\n  // \u51cf\u5c11\u7ee7\u627f\u8fc7\u7a0b\u4e2d\u7236\u7c7b\u7684\u5b9e\u4f8b\u5316,\u51cf\u5c11\u8d44\u6e90\u6d88\u8017\n  // \u5b9e\u4f8b\u5316\u4e00\u4e2a\u7a7a\u7c7b\u6240\u9700\u8d44\u6e90\u66f4\u5c11\n  const F = function () {}\n  return function (C, P) {\n    // c.__proto__ = C.prototype = f\n    // f.__proto__ = F.prototype\n    // F.prototype = P.prototype\n    // c.__proto__.__proto__ = f.__proto__ = P.prototype\n    F.prototype = P.prototype // f.__proto__ = F.prototype = P.prototype\n    C.prototype = new F() // C.prototype = f\n    C.prototype.constructor = C\n    C.super = P.prototype // \u6b64\u53e5\u53ef\u63d0\u9ad8\u4ee3\u7801\u7684\u91cd\u7528\u6027\n  }\n})()\n\nChild.prototype.add = function () {\n  return Child.super.add.call(this)\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"class-simulation",children:"Class Simulation"}),"\n",(0,t.jsx)(n.p,{children:"\u590d\u5236\u5f0f\u5730\u7ee7\u627f, \u5c06\u4f1a\u6d88\u8017\u5927\u91cf\u5185\u5b58\u5355\u5143:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"function classSim(Parent, props) {\n  // \u65b0\u7684\u6784\u9020\u51fd\u6570\n  const Child = function (...args) {\n    if (\n      Child.uber\n      && Object.prototype.hasOwnProperty.call(Child.uber, '_construct')\n    ) {\n      Child.uber._construct.apply(this, args)\n    }\n\n    if (Object.prototype.hasOwnProperty.call(Child.prototype, '_construct'))\n      Child.prototype._construct.apply(this, args)\n  }\n\n  // \u7c7b\u5f0f\u7ee7\u627f\n  Parent = Parent || Object\n\n  // \u4ee3\u7406\u6784\u9020\u51fd\u6570F\n  const F = function () {}\n  F.prototype = Parent.prototype\n  Child.prototype = new F()\n  Child.prototype.constructor = Child\n\n  // \u6dfb\u52a0\u5c5e\u6027\u4e0e\u65b9\u6cd5\n  for (const i in props) {\n    if (Object.prototype.hasOwnProperty.call(props, i))\n      Child.prototype[i] = props[i]\n  }\n\n  // return the \"class\"\n  return Child\n}\n\nconst SuperMan = classSim(Man, {\n  _construct(what) {\n    console.log('SuperMan\\'s constructor')\n  },\n  getName() {\n    const name = SuperMan.uber.getName.call(this)\n    return `I am ${name}`\n  },\n})\n"})}),"\n",(0,t.jsx)(n.h2,{id:"composite",children:"Composite"}),"\n",(0,t.jsxs)(n.p,{children:["\u539f\u578b\u7ee7\u627f (",(0,t.jsx)(n.strong,{children:"\u8bbe\u7f6e\u539f\u578b"}),")\n\u4e0e\u7c7b\u5f0f\u7ee7\u627f (",(0,t.jsx)(n.strong,{children:"\u501f\u7528\u6784\u9020\u51fd\u6570"}),")\n\u7ec4\u5408\u7ee7\u627f\u6a21\u5f0f:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"child.prototype = new Parent(); Child.prototype.constructor = Child"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Parent.apply(this, arguments)"}),": \u501f\u7528\u6784\u9020\u51fd\u6570\u53ef\u4ee5\u9632\u6b62\u5f15\u7528\u7c7b\u578b\u88ab\u8feb\u5171\u4eab."]}),"\n",(0,t.jsx)(n.li,{children:"\u6b64\u6a21\u5f0f\u4f1a\u8c03\u7528\u4e24\u6b21\u7236\u7c7b\u6784\u9020\u51fd\u6570, \u4f7f\u5f97\u5b50\u7c7b\u5c5e\u6027\u7ee7\u627f\u4e24\u6b21, \u5b58\u5728\u4e00\u5b9a\u7684\u6548\u7387\u95ee\u9898."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"function Parent(name) {\n  this.name = name || 'Adam'\n}\n// Adding functionality to the prototype\nParent.prototype.say = function () {\n  return this.name\n}\n\n// Child constructor\nfunction Child(...args) {\n  // \u89e3\u51b3\u5f15\u7528\u7c7b\u578b\u5171\u4eab\u95ee\u9898\n  Parent.apply(this, args)\n  this.childName = 'Child Name'\n}\n\n// Child.prototype = Object.create(Parent.prototype);\nChild.prototype = new Parent() // \u8bbe\u7f6e\u539f\u578b\u94fe,\u5efa\u7acb\u7ee7\u627f\u5173\u7cfb\nChild.prototype.constructor = Child // \u4f7f\u5f97 Prototype \u5bf9\u8c61\u4e0e Constructor \u5bf9\u8c61\u5f62\u6210\u95ed\u73af\n"})}),"\n",(0,t.jsx)(n.h2,{id:"clone",children:"Clone"}),"\n",(0,t.jsx)(n.h3,{id:"shallow",children:"Shallow"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"Object.assign"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enumerable: ",(0,t.jsx)(n.strong,{children:"\u53ef\u679a\u4e3e"}),"\u5c5e\u6027\u6269\u5c55."]}),"\n",(0,t.jsxs)(n.li,{children:["Own: ",(0,t.jsx)(n.strong,{children:"\u81ea\u6709"}),"\u5c5e\u6027\u6269\u5c55."]}),"\n",(0,t.jsxs)(n.li,{children:["Shallow: ",(0,t.jsx)(n.strong,{children:"\u6d45\u62f7\u8d1d"}),"\u6269\u5c55."]}),"\n",(0,t.jsxs)(n.li,{children:["Trigger ",(0,t.jsx)(n.code,{children:"sourceObj.set"})," and change ",(0,t.jsx)(n.code,{children:"sourceObj"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"const dest = {}\nconst src = { a: {} }\nObject.assign(dest, src)\n\n// \u6d45\u590d\u5236\u610f\u5473\u7740\u53ea\u4f1a\u590d\u5236\u5bf9\u8c61\u7684\u5f15\u7528\nconsole.log(dest) // { a :{} }\nconsole.log(dest.a === src.a) // true\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"..."})," object spread syntax:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enumerable: ",(0,t.jsx)(n.strong,{children:"\u53ef\u679a\u4e3e"}),"\u5c5e\u6027\u6269\u5c55."]}),"\n",(0,t.jsxs)(n.li,{children:["Own: ",(0,t.jsx)(n.strong,{children:"\u81ea\u6709"}),"\u5c5e\u6027\u6269\u5c55."]}),"\n",(0,t.jsxs)(n.li,{children:["Shallow: ",(0,t.jsx)(n.strong,{children:"\u6d45\u62f7\u8d1d"}),"\u6269\u5c55."]}),"\n",(0,t.jsxs)(n.li,{children:["Not copy prototype (",(0,t.jsx)(n.code,{children:"__proto__"}),")."]}),"\n",(0,t.jsx)(n.li,{children:"Not copy getter and setter."}),"\n",(0,t.jsxs)(n.li,{children:["Not trigger ",(0,t.jsx)(n.code,{children:"sourceObj.set"})," and not change ",(0,t.jsx)(n.code,{children:"sourceObj"})," (create new properties)."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// Shallow copy\nconst foo = { a: 1 }\nconst bar = { b: 2, c: { d: 3 } }\nconst foobar = { ...foo, ...bar }\nconsole.log(foobar.c === bar.c) // true\n\n// Not copy prototype (`__proto__`)\nclass MyClass {}\nconst original = new MyClass()\nassert.equal(original instanceof MyClass, true)\nconst copy = { ...original }\nassert.equal(copy instanceof MyClass, false)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"deep",children:"Deep"}),"\n",(0,t.jsx)(n.p,{children:"Recursively copy all properties of an object:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"function deepClone(original) {\n  if (Array.isArray(original)) {\n    return original.map(elem => deepClone(elem))\n  } else if (typeof original === 'object' && original !== null) {\n    return Object.fromEntries(\n      Object.entries(original).map(([key, value]) => [key, deepClone(value)])\n    )\n  } else {\n    // Primitive value: atomic, no need to copy\n    return original\n  }\n}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"function deepUpdate(original, keys, value) {\n  if (keys.length === 0)\n    return value\n\n  const currentKey = keys[0]\n\n  if (Array.isArray(original)) {\n    return original.map((v, index) =>\n      index === currentKey ? deepUpdate(v, keys.slice(1), value) : v\n    )\n  } else if (typeof original === 'object' && original !== null) {\n    return Object.fromEntries(\n      Object.entries(original).map(([k, v]) =>\n        k === currentKey ? [k, deepUpdate(v, keys.slice(1), value)] : [k, v]\n      )\n    )\n  } else {\n    // Primitive value\n    return original\n  }\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.code,{children:"JSON.parse(JSON.stringify(obj))"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Not copy prototype (",(0,t.jsx)(n.code,{children:"__proto__"}),")."]}),"\n",(0,t.jsx)(n.li,{children:"Not copy getter and setter."}),"\n",(0,t.jsx)(n.li,{children:"Not copy non-enumerable properties."}),"\n",(0,t.jsx)(n.li,{children:"Not copy Symbol properties."}),"\n",(0,t.jsx)(n.li,{children:"Not copy circular references."}),"\n",(0,t.jsxs)(n.li,{children:["Not copy ",(0,t.jsx)(n.code,{children:"undefined"}),", ",(0,t.jsx)(n.code,{children:"function"}),", ",(0,t.jsx)(n.code,{children:"symbol"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"const obj = { a: 1, b: { c: 2 } }\nconst clone = JSON.parse(JSON.stringify(obj))\nconsole.log(clone) // { a: 1, b: { c: 2 } }\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/structuredClone",children:(0,t.jsx)(n.code,{children:"window.structuredClone()"})}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// Create an object with a value and a circular reference to itself.\nconst original = { name: 'MDN' }\noriginal.itself = original\n\n// Clone it\nconst clone = structuredClone(original)\n\nconsole.assert(clone !== original) // the objects are not the same (not same identity)\nconsole.assert(clone.name === 'MDN') // they do have the same values\nconsole.assert(clone.itself === clone) // and the circular reference is preserved\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'const room1 = {\n  people: [\'Alan\', \'Bob\'],\n}\n\nconst room2 = structuredClone(room1)\n\nroom2.people.push(\'Charlie\')\nroom1.people.pop()\n\nconsole.log(room2.people) // ["Alan", "Bob", "Charlie"]\nconsole.log(room1.people) // ["Alan"]\n'})}),"\n",(0,t.jsx)(n.h2,{id:"global-object",children:"Global Object"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://exploringjs.com/deep-js/ch_global-scope.html",children:(0,t.jsx)(n.img,{alt:"Global Scope",src:r(92551).A+"",width:"1447",height:"823"})})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// \u7acb\u5373\u51fd\u6570\u6a21\u5f0f:\n// \u6b64\u65f6\u8fd4\u56de\u503c\u4e0d\u662f\u51fd\u6570\u672c\u8eab, \u800c\u662f\u51fd\u6570\u6267\u884c\u540e\u7684 return \u8bed\u53e5\u8fd4\u56de\u503c.\nconst global = (function () {\n  // \u8fd4\u56de\u5168\u5c40\u5bf9\u8c61\n  return this\n})()\n"})}),"\n",(0,t.jsx)(n.p,{children:"Global Object \u5c5e\u6027:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"undefined."}),"\n",(0,t.jsx)(n.li,{children:"NaN."}),"\n",(0,t.jsx)(n.li,{children:"Infinity."}),"\n",(0,t.jsx)(n.li,{children:"Object."}),"\n",(0,t.jsx)(n.li,{children:"Array."}),"\n",(0,t.jsx)(n.li,{children:"Function."}),"\n",(0,t.jsx)(n.li,{children:"Boolean."}),"\n",(0,t.jsx)(n.li,{children:"String."}),"\n",(0,t.jsx)(n.li,{children:"Number."}),"\n",(0,t.jsx)(n.li,{children:"Date."}),"\n",(0,t.jsx)(n.li,{children:"RegExp."}),"\n",(0,t.jsx)(n.li,{children:"Symbol."}),"\n",(0,t.jsx)(n.li,{children:"Error."}),"\n",(0,t.jsx)(n.li,{children:"EvalError."}),"\n",(0,t.jsx)(n.li,{children:"RangeError."}),"\n",(0,t.jsx)(n.li,{children:"ReferenceError."}),"\n",(0,t.jsx)(n.li,{children:"SyntaxError."}),"\n",(0,t.jsx)(n.li,{children:"TypeError."}),"\n",(0,t.jsx)(n.li,{children:"URIError."}),"\n",(0,t.jsx)(n.li,{children:"encodeURI."}),"\n",(0,t.jsx)(n.li,{children:"encodeURIComponent."}),"\n",(0,t.jsx)(n.li,{children:"decodeURI."}),"\n",(0,t.jsx)(n.li,{children:"decodeURIComponent."}),"\n",(0,t.jsx)(n.li,{children:"eval."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:";(function () {\n  // Grab browser's default global variables.\n  const iframe = window.document.createElement('iframe')\n  iframe.src = 'about:blank'\n  window.document.body.appendChild(iframe)\n  const browserGlobals = Object.keys(iframe.contentWindow)\n  window.document.body.removeChild(iframe)\n\n  // Get the global variables added at runtime by filtering out the browser's\n  // default global variables from the current window object.\n  const runtimeGlobals = Object.keys(window).filter((key) => {\n    const isFromBrowser = browserGlobals.includes(key)\n    return !isFromBrowser\n  })\n\n  console.log('Runtime globals', runtimeGlobals)\n})()\n"})})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},92551:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/global-scope-1c99e41217be6d08f2578d375fd7efd2.png"},86145:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>i});var o=r(57140);const t={},l=o.createContext(t);function s(e){const n=o.useContext(l);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);