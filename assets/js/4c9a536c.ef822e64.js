"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[44427],{78048:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"web/testing/jest","title":"Jest","description":"Installation","source":"@site/content/web/testing/jest.md","sourceDirName":"web/testing","slug":"/web/testing/jest","permalink":"/notes/web/testing/jest","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/testing/jest.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"Testing","permalink":"/notes/tags/testing"},{"inline":true,"label":"Jest","permalink":"/notes/tags/jest"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"tags":["Web","Testing","Jest"]},"sidebar":"tutorialSidebar","previous":{"title":"Methodology","permalink":"/notes/web/testing/methodology"},"next":{"title":"Cypress","permalink":"/notes/web/testing/cypress"}}');var r=t(35656),i=t(86145);const o={sidebar_position:2,tags:["Web","Testing","Jest"]},a="Jest",l={},c=[{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Snapshots",id:"snapshots",level:2},{value:"Asynchronous",id:"asynchronous",level:2},{value:"Mocks",id:"mocks",level:2},{value:"Utils",id:"utils",level:3},{value:"Module",id:"module",level:3},{value:"Date",id:"date",level:3},{value:"APIs",id:"apis",level:3},{value:"Internals",id:"internals",level:2},{value:"Runtime Sandbox",id:"runtime-sandbox",level:3},{value:"Test Runner",id:"test-runner",level:3},{value:"Native Runner",id:"native-runner",level:3},{value:"Performance",id:"performance",level:2},{value:"Plugins",id:"plugins",level:2},{value:"Best Practices",id:"best-practices",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"jest",children:"Jest"})}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm i -D jest ts-jest @types/jest react-test-renderer\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"jest.config.js"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { pathsToModuleNameMapper } = require('ts-jest/utils')\nconst { compilerOptions } = require('./tsconfig.json')\n\nconst paths = pathsToModuleNameMapper(compilerOptions.paths, {\n  prefix: '<rootDir>/',\n})\n\n/** @type {import('ts-jest/dist/types').InitialOptionsTsJest} */\nmodule.exports = {\n  roots: ['<rootDir>/src'],\n  collectCoverage: true,\n  coverageDirectory: 'coverage',\n  transform: {\n    '^.+\\\\.jsx?$': '<rootDir>/jest.transformer.js',\n    '^.+\\\\.tsx?$': 'ts-jest',\n  },\n  transformIgnorePatterns: ['node_modules/(?!(gatsby)/)'],\n  moduleFileExtensions: ['ts', 'tsx', 'js', 'jsx', 'json', 'node'],\n  moduleNameMapper: {\n    '.+\\\\.(css|styl|less|sass|scss)$': 'identity-obj-proxy',\n    '.+\\\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$':\n      '<rootDir>/__mocks__/jest.mock.js',\n    ...paths,\n    '^@components/(.*)$': '<rootDir>/src/components/$1',\n    '^@hooks/(.*)$': '<rootDir>/src/hooks/$1',\n    '^@layouts/(.*)$': '<rootDir>/src/layouts/$1',\n    '^@types/(.*)$': '<rootDir>/src/types/$1',\n  },\n  testPathIgnorePatterns: ['node_modules', '\\\\.cache', '<rootDir>.*/build'],\n  testRegex: '(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$',\n  globals: {\n    'window': {},\n    'ts-jest': {\n      tsConfig: './tsconfig.json',\n    },\n  },\n  testURL: 'http://localhost',\n  testEnvironment: 'jsdom',\n  setupFiles: ['<rootDir>/jest.env.setup.js'],\n  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],\n  setupTestFrameworkScriptFile: '<rootDir>/src/setupEnzyme.ts',\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"jest.env.setup.js"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import path from 'node:path'\nimport dotenv from 'dotenv'\n\nconsole.log(`============ env-setup Loaded ===========`)\ndotenv.config({\n  path: path.resolve(process.cwd(), 'tests', 'settings', '.test.env'),\n})\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"jest.setup.js"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Mock missing JSDOM functions."}),"\n",(0,r.jsx)(n.li,{children:"Inject more expect DOM assertion."}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/testing-library/jest-dom",children:"Jest DOM Expect API"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import '@testing-library/jest-dom'\n\n// Global/Window object Stubs for Jest\nwindow.matchMedia\n  = window.matchMedia\n    || function () {\n      return {\n        matches: false,\n        addListener() {},\n        removeListener() {},\n      }\n    }\n\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(), // deprecated\n    removeListener: jest.fn(), // deprecated\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n})\n\nwindow.requestAnimationFrame = function (callback) {\n  setTimeout(callback)\n}\n\nwindow.cancelAnimationFrame = window.clearTimeout\n\nwindow.localStorage = {\n  getItem() {},\n  setItem() {},\n}\n\nObject.values = () => []\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"vitest.config.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import react from '@vitejs/plugin-react'\nimport { defineConfig } from 'vite'\n\nexport default defineConfig({\n  plugins: [react()],\n  test: {\n    environment: 'jsdom',\n    globals: true,\n    setupFiles: './tests/setup.ts',\n  },\n})\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"tests/setup.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import * as matchers from '@testing-library/jest-dom/matchers'\nimport { cleanup } from '@testing-library/react'\nimport { afterEach, expect } from 'vitest'\n\nexpect.extend(matchers)\n\nafterEach(() => {\n  cleanup()\n})\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"setupEnzyme.ts"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { configure } from 'enzyme'\nimport * as EnzymeAdapter from 'enzyme-adapter-react-16'\n\nconfigure({ adapter: new EnzymeAdapter() })\n"})}),"\n",(0,r.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"describe"})," block."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"test"})," statement."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"it"})," statement."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"test.todo"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Skip empty todo tests."}),"\n",(0,r.jsx)(n.li,{children:"Skip temporary broken tests."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { fireEvent, render, screen } from '@testing-library/react'\nimport LandingNav from './LandingNav'\n\ndescribe('LandingNav', () => {\n  test('should expanded when clicked', () => {\n    render(<LandingNav />)\n\n    expect(screen.getByRole('navigation')).toHaveStyle(\n      'transform: translateX(-100%) translateZ(0);'\n    )\n    expect(screen.getByRole('banner')).toHaveStyle('opacity: 0')\n\n    fireEvent.click(screen.getByTestId('hamburger-icon'))\n\n    expect(screen.getByRole('navigation')).toHaveStyle(\n      'transform: translateX(0%) translateZ(0);'\n    )\n    expect(screen.getByRole('banner')).toHaveStyle('opacity: 0.8')\n\n    fireEvent.click(screen.getByTestId('hamburger-button'))\n\n    expect(screen.getByRole('navigation')).toHaveStyle(\n      'transform: translateX(-100%) translateZ(0);'\n    )\n    expect(screen.getByRole('banner')).toHaveStyle('opacity: 0')\n  })\n})\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"userEvent"})," instead of ",(0,r.jsx)(n.code,{children:"fireEvent"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import userEvent from '@testing-library/user-event'\n\n// setup userEvent\nfunction setup(jsx) {\n  return {\n    user: userEvent.setup(),\n    ...render(jsx),\n  }\n}\n\ndescribe('Form', () => {\n  it('should save correct data on submit', async () => {\n    const mockSave = jest.fn()\n    const { user } = setup(<Form saveData={mockSave} />)\n\n    await user.type(screen.getByRole('textbox', { name: 'Name' }), 'Test')\n    await user.click(screen.getByRole('button', { name: 'Sign up' }))\n\n    expect(mockSave).toHaveBeenLastCalledWith({ ...defaultData, name: 'Test' })\n  })\n})\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"findBy"})," instead of ",(0,r.jsx)(n.code,{children:"waitFor"})," + ",(0,r.jsx)(n.code,{children:"getBy"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"describe('ListPage', () => {\n  it('renders without breaking', async () => {\n    render(<ListPage />)\n    expect(\n      await screen.findByRole('heading', { name: 'List of items' }),\n    ).toBeInTheDocument()\n  })\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"snapshots",children:"Snapshots"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"When you run jest first time,\nit will produce an snapshot file."}),"\n",(0,r.jsx)(n.li,{children:"The next time run the tests,\nrendered output will be compared to previously created snapshot."}),"\n",(0,r.jsxs)(n.li,{children:["If change is expected,\nuse ",(0,r.jsx)(n.code,{children:"jest -u"})," to overwrite existing snapshot."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import { fireEvent, render, screen } from '@testing-library/react'\nimport ThemeSwitch from './ThemeSwitch'\n\ndescribe('ThemeSwitch', () => {\n  test('should switch dark mode when clicked', () => {\n    const { container } = render(<ThemeSwitch />)\n\n    fireEvent.click(screen.getByTestId('toggle-wrapper'))\n\n    expect(container).toMatchSnapshot()\n  })\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"asynchronous",children:"Asynchronous"}),"\n",(0,r.jsxs)(n.p,{children:["Jest async ",(0,r.jsx)(n.a,{href:"https://jestjs.io/docs/tutorial-async",children:"guide"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"await expect(asyncCall()).resolves.toEqual('Expected')\nawait expect(asyncCall()).rejects.toThrowError()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"mocks",children:"Mocks"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Mocks",src:t(17021).A+"",title:"Mocks",width:"1166",height:"879"})}),"\n",(0,r.jsx)(n.h3,{id:"utils",children:"Utils"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"__mocks__"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jest.createMockFromModule('moduleName')"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jest.requireActual('moduleName')"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"spyOn"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jest.spyOn().mockImplementation"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jest.spyOn().mockReturnValue"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jest.spyOn().mockReturnValueOnce"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jest.spyOn().mockResolvedValue"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jest.spyOn().mockRejectedValue"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"mockModule.mockClear"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"mockModule.mockReset"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"mockModule.mockRestore"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"module",children:"Module"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'// react-dom.js\nconst reactDom = jest.requireActual(\'react-dom\')\n\nfunction mockCreatePortal(element, target) {\n  return (\n    <div>\n      <div id="content">{element}</div>\n      <div id="target" data-target-tag-name={target.tagName}></div>\n    </div>\n  )\n}\n\nreactDom.createPortal = mockCreatePortal\n\nmodule.exports = reactDom\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// gatsby.js\nconst gatsby = jest.requireActual('gatsby')\n\nmodule.exports = {\n  ...gatsby,\n  graphql: jest.fn(),\n  Link: jest\n    .fn()\n    .mockImplementation(\n      ({\n        activeClassName,\n        activeStyle,\n        getProps,\n        innerRef,\n        partiallyActive,\n        ref,\n        replace,\n        to,\n        ...rest\n      }) =>\n        React.createElement('a', {\n          ...rest,\n          href: to,\n        })\n    ),\n  StaticQuery: jest.fn(),\n  useStaticQuery: jest.fn(),\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"date",children:"Date"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"jest\n  .spyOn(Date.prototype, 'toISOString')\n  .mockReturnValue('2020-06-20T13:37:00.000Z')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"apis",children:"APIs"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { rest } from 'msw'\nimport { setupServer } from 'msw/node'\n\nconst handlers = [\n  rest.get('https://mysite.com/api/role', async (req, res, ctx) => {\n    res(ctx.status(200), ctx.json({ userType: 'user' }))\n  }),\n]\n\nconst server = setupServer(...handlers)\n\nexport default server\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import server from './mockServer/server'\n\nbeforeAll(() => {\n  server.listen()\n})\n\nafterEach(() => {\n  server.resetHandlers()\n})\n\nafterAll(() => {\n  server.close()\n})\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import type { UserRoleType } from './apis/user'\nimport { render, screen } from '@testing-library/react'\nimport { rest } from 'msw'\nimport AuthButton from './components/AuthButton'\nimport server from './mockServer/server'\n\nfunction setup(userType: UserRoleType) {\n  server.use(\n    rest.get('https://mysite.com/api/role', async (req, res, ctx) => {\n      return res(ctx.status(200), ctx.json({ userType }))\n    })\n  )\n}\n\ndescribe('AuthButton', () => {\n  it('should render user text', async () => {\n    setup('user')\n\n    render(<AuthButton>Hello</AuthButton>)\n\n    expect(await screen.findByText('Hello User')).toBeInTheDocument()\n  })\n\n  it('should render admin text', async () => {\n    setup('admin')\n\n    render(<AuthButton>Hello</AuthButton>)\n\n    expect(await screen.findByText('Hello Admin')).toBeInTheDocument()\n  })\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"internals",children:"Internals"}),"\n",(0,r.jsx)(n.h3,{id:"runtime-sandbox",children:"Runtime Sandbox"}),"\n",(0,r.jsxs)(n.p,{children:["Running tests in\n",(0,r.jsx)(n.a,{href:"https://2ality.com/2022/04/shadow-realms.html#use-cases-for-shadowrealms",children:(0,r.jsx)(n.code,{children:"ShadowRealms"})}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// demo.test.js\nimport { test } from './TestLib.js'\n\ntest('succeeds', () => {\n  assert.equal(3, 3)\n})\n\ntest('fails', () => {\n  assert.equal(1, 3)\n})\n\n// This statement can add by `babel`.\n\nexport default true\n\n// TestLib.js\nconst testSuites = []\n\nexport function test(description, callback) {\n  testSuites.push({ description, callback })\n}\n\nexport function runTests() {\n  const testResults = []\n\n  for (const testSuite of testSuites) {\n    try {\n      testSuite.callback()\n      testResults.push(`${testSuite.description}: OK\\n`)\n    } catch (err) {\n      testResults.push(`${testSuite.description}: ${err}\\n`)\n    }\n  }\n\n  return testResults.join('')\n}\n\n// TestRunner.js\nasync function runTestModule(moduleSpecifier) {\n  const sr = new ShadowRealm()\n  await sr.importValue(moduleSpecifier, 'default')\n  const runTests = await sr.importValue('./TestLib.js', 'runTests')\n  const result = runTests()\n  console.log(result)\n}\n\nawait runTestModule('./demo.test.js')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"test-runner",children:"Test Runner"}),"\n",(0,r.jsxs)(n.p,{children:["A simple\n",(0,r.jsx)(n.a,{href:"https://github.com/typicode/xv",children:"test runner"}),"\nimplementation:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { promises as fs } from 'node:fs'\nimport { basename, dirname, join } from 'node:path'\nimport { pathToFileURL } from 'node:url'\n\nasync function* walk(dir: string): AsyncGenerator<string> {\n  for await (const d of await fs.opendir(dir)) {\n    const entry = join(dir, d.name)\n\n    if (d.isDirectory())\n      yield* walk(entry)\n    else if (d.isFile())\n      yield entry\n  }\n}\n\nasync function runTestFile(file: string): Promise<void> {\n  for (const value of Object.values(\n    await import(pathToFileURL(file).toString())\n  )) {\n    if (typeof value === 'function') {\n      try {\n        await value()\n      } catch (e) {\n        console.error(e instanceof Error ? e.stack : e)\n        process.exit(1)\n      }\n    }\n  }\n}\n\nasync function run(arg = '.') {\n  if ((await fs.lstat(arg)).isFile())\n    return runTestFile(arg)\n\n  for await (const file of walk(arg)) {\n    if (\n      !dirname(file).includes('node_modules')\n      && (basename(file) === 'test.js' || file.endsWith('.test.js'))\n    ) {\n      console.log(file)\n      await runTestFile(file)\n    }\n  }\n}\n\nrun(process.argv[2])\n"})}),"\n",(0,r.jsx)(n.h3,{id:"native-runner",children:"Native Runner"}),"\n",(0,r.jsxs)(n.p,{children:["Implement component testing with\n",(0,r.jsxs)(n.a,{href:"https://whistlr.info/2022/test-react-builtin",children:["native ",(0,r.jsx)(n.code,{children:"node:test"})," module"]}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:"import assert from 'node:assert'\nimport test from 'node:test'\nimport { cleanup, render } from '@testing-library/react'\nimport jsdom from 'jsdom'\n\nconst j = new jsdom.JSDOM(undefined, {\n  url: 'http://localhost', // Many APIs are confused without being \"on a real URL\"\n  pretendToBeVisual: true, // This adds dummy requestAnimationFrame and friends\n})\n\n// We need to add everything on JSDOM's window object to global scope.\n// We don't add anything starting with _, or anything that's already there.\nObject.getOwnPropertyNames(j.window)\n  .filter(k => !k.startsWith('_') && !(k in globalThis))\n  .forEach(k => (globalThis[k] = j.window[k]))\n\n// Finally, tell React 18+ that we are not really a browser.\nglobalThis.IS_REACT_ACT_ENVIRONMENT = true\n\nfunction reactTest(name, fn) {\n  return test(name, () => {\n    cleanup() // always cleanup first\n    return fn()\n  })\n}\n\nexport default function FooComponent({ text }: { text: string }) {\n  return (\n    <div>\n      Hello\n      {' '}\n      <span data-testid=\"hold\">{text}</span>\n    </div>\n  )\n}\n\nreactTest('test component', () => {\n  const result = render(<FooComponent name={Sam} />)\n  assert.strictEqual(result.getByTestId('hold').textContent, 'Sam')\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Jest"})," \u7684\u6574\u4f53\u67b6\u6784, \u5176\u4e2d\u6709 3 \u4e2a\u5730\u65b9\u6bd4\u8f83\u8017\u6027\u80fd:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u751f\u6210\u865a\u62df\u6587\u4ef6\u7cfb\u7edf (",(0,r.jsx)(n.code,{children:"jest-haste-map"}),"): \u5728\u8dd1\u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u4f1a\u5f88\u6162."]}),"\n",(0,r.jsx)(n.li,{children:"\u591a\u7ebf\u7a0b: \u751f\u6210\u65b0\u7ebf\u7a0b\u8017\u8d39\u7684\u8d44\u6e90."}),"\n",(0,r.jsxs)(n.li,{children:["\u6587\u4ef6\u8f6c\u8bd1: ",(0,r.jsx)(n.code,{children:"Jest"})," \u4f1a\u5728\u6267\u884c\u5230\u8be5\u6587\u4ef6\u518d\u5bf9\u5b83\u8fdb\u884c\u8f6c\u8bd1. \u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"esbuild-jest"}),"/",(0,r.jsx)(n.code,{children:"@swc/jest"})," \u52a0\u901f\u8f6c\u8bd1."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"plugins",children:"Plugins"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Jest debug ",(0,r.jsx)(n.a,{href:"https://github.com/nvh95/jest-preview",children:"tool"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Jest visual regression testing ",(0,r.jsx)(n.a,{href:"https://github.com/americanexpress/jest-image-snapshot",children:"tool"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Avoid ",(0,r.jsx)(n.a,{href:"https://semaphoreci.com/blog/flaky-react",children:"flaky testing"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.a,{href:"https://claritydev.net/blog/improving-react-testing-library-tests#use-userevent-instead-of-fireevent",children:(0,r.jsx)(n.code,{children:"userEvent"})}),"\ninstead of ",(0,r.jsx)(n.code,{children:"fireEvent"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.a,{href:"https://claritydev.net/blog/improving-react-testing-library-tests#simplify-the-waitfor-queries-with-findby",children:(0,r.jsx)(n.code,{children:"findBy"})}),"\ninstead of ",(0,r.jsx)(n.code,{children:"waitFor"})," + ",(0,r.jsx)(n.code,{children:"getBy"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},17021:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/mocks-51e403791fb4c1707d7887fed858b90f.png"},86145:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(57140);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);