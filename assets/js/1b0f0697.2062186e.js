"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[66542],{67333:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"web/javascript/engine","title":"Engine","description":"Variables Lifecycle","source":"@site/content/web/javascript/engine.md","sourceDirName":"web/javascript","slug":"/web/javascript/engine","permalink":"/notes/web/javascript/engine","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/engine.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Engine","permalink":"/notes/tags/engine"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":30,"frontMatter":{"sidebar_position":30,"tags":["Web","JavaScript","ECMAScript","Engine"]},"sidebar":"tutorialSidebar","previous":{"title":"Style Guide","permalink":"/notes/web/javascript/style-guide"},"next":{"title":"BOM","permalink":"/notes/web/javascript/bom"}}');var r=i(35656),l=i(86145);const t={sidebar_position:30,tags:["Web","JavaScript","ECMAScript","Engine"]},o="Engine",c={},a=[{value:"Variables Lifecycle",id:"variables-lifecycle",level:2},{value:"Execution Context",id:"execution-context",level:2},{value:"Global",id:"global",level:3},{value:"Function",id:"function",level:3},{value:"Event Loop",id:"event-loop",level:2},{value:"Browser",id:"browser",level:3},{value:"Node.js",id:"nodejs",level:3},{value:"V8",id:"v8",level:2},{value:"Object Shape",id:"object-shape",level:3},{value:"Inline Cache",id:"inline-cache",level:3},{value:"Object Structure",id:"object-structure",level:3},{value:"Garbage Collection",id:"garbage-collection",level:3},{value:"Scavenge",id:"scavenge",level:3},{value:"Mark-Sweep-Compact",id:"mark-sweep-compact",level:3},{value:"Stop-The-World",id:"stop-the-world",level:3},{value:"Performance",id:"performance",level:3},{value:"Browser Engine",id:"browser-engine",level:2},{value:"RenderingNG",id:"renderingng",level:2},{value:"Architecture",id:"architecture",level:3},{value:"Pipeline",id:"pipeline",level:3},{value:"Render Process",id:"render-process",level:3},{value:"HTML Parser",id:"html-parser",level:3},{value:"CSS Parser",id:"css-parser",level:3},{value:"Layout Engine",id:"layout-engine",level:3},{value:"Paint Engine",id:"paint-engine",level:3},{value:"Video Engine",id:"video-engine",level:3},{value:"Scrolling Performance",id:"scrolling-performance",level:3},{value:"Animation Performance",id:"animation-performance",level:3},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"engine",children:"Engine"})}),"\n",(0,r.jsx)(n.h2,{id:"variables-lifecycle",children:"Variables Lifecycle"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Creation phase (",(0,r.jsx)(n.strong,{children:"Hoisting"}),")","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Declaration phase: \u5728\u4f5c\u7528\u57df\u4e2d\u6ce8\u518c\u53d8\u91cf"}),"\n",(0,r.jsxs)(n.li,{children:["Initialization phase: \u5206\u914d\u5185\u5b58, \u5728\u4f5c\u7528\u57df\u4e2d\u7ed1\u5b9a\u53d8\u91cf (",(0,r.jsx)(n.code,{children:"undefined"}),")"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Execution phase/Assignment phase"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"execution-context",children:"Execution Context"}),"\n",(0,r.jsx)(n.h3,{id:"global",children:"Global"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create global object (",(0,r.jsx)(n.code,{children:"window"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Create ",(0,r.jsx)(n.code,{children:"this"})," object (refer to ",(0,r.jsx)(n.code,{children:"window"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Declare and initialize variable/function (",(0,r.jsx)(n.code,{children:"undefined"}),"),\nsetup memory space for them."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"function",children:"Function"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create arguments object."}),"\n",(0,r.jsxs)(n.li,{children:["Create ",(0,r.jsx)(n.code,{children:"this"})," object."]}),"\n",(0,r.jsxs)(n.li,{children:["Declare and initialize variable(",(0,r.jsx)(n.code,{children:"undefined"}),")/function, store them into memory."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c JavaScript \u5f15\u64ce\u5728\u51fd\u6570\u6267\u884c\u4e0a\u4e0b\u6587\u4e2d\u627e\u4e0d\u5230\u53d8\u91cf,\n\u5b83\u4f1a\u5728\u6700\u8fd1\u7684\u7236\u7ea7\u6267\u884c\u4e0a\u4e0b\u6587\u4e2d\u67e5\u627e\u8be5\u53d8\u91cf.\n\u8fd9\u4e2a\u67e5\u627e\u94fe\u5c06\u4f1a\u4e00\u76f4\u6301\u7eed, \u76f4\u5230\u5f15\u64ce\u67e5\u627e\u5230\u5168\u5c40\u6267\u884c\u4e0a\u4e0b\u6587.\n\u8fd9\u79cd\u60c5\u51b5\u4e0b, \u5982\u679c\u5168\u5c40\u6267\u884c\u4e0a\u4e0b\u6587\u4e5f\u6ca1\u6709\u8be5\u53d8\u91cf, \u90a3\u4e48\u5c06\u4f1a\u629b\u51fa\u5f15\u7528\u9519\u8bef (Reference Error).\n\u5b50\u51fd\u6570",(0,r.jsx)(n.strong,{children:"\u5305\u542b"}),"\u5b83\u7236\u7ea7\u51fd\u6570\u7684\u53d8\u91cf\u73af\u5883, \u628a\u8fd9\u4e2a\u6982\u5ff5\u79f0\u4e3a",(0,r.jsx)(n.strong,{children:"\u95ed\u5305(Closure)"}),",\n\u5373\u4f7f\u7236\u7ea7\u51fd\u6570\u6267\u884c\u73af\u5883\u5df2\u7ecf\u4ece\u6267\u884c\u6808\u5f39\u51fa\u4e86, \u5b50\u51fd\u6570\u8fd8\u662f\u53ef\u4ee5\u8bbf\u95ee\u7236\u7ea7\u51fd\u6570\u53d8\u91cf x (\u901a\u8fc7\u4f5c\u7528\u57df\u94fe)."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Scope Chain",src:i(37984).A+"",title:"Scope Chain",width:"1383",height:"865"})}),"\n",(0,r.jsx)(n.h2,{id:"event-loop",children:"Event Loop"}),"\n",(0,r.jsx)(n.h3,{id:"browser",children:"Browser"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Event Loop",src:i(48874).A+"",title:"Event Loop",width:"392",height:"740"})}),"\n",(0,r.jsxs)(n.p,{children:["The job of the ",(0,r.jsx)(n.strong,{children:"event loop"})," is to look into the call stack\nand determine if the call stack is empty or not.\nIf the ",(0,r.jsx)(n.strong,{children:"call stack"})," is empty,\nit looks into the ",(0,r.jsx)(n.strong,{children:"ES6 job queue"})," and ",(0,r.jsx)(n.strong,{children:"message queue"})," to see\nif there\u2019s any pending call back waiting to be executed:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["ES6 job queue: used by ",(0,r.jsx)(n.code,{children:"Promises"})," (higher priority)."]}),"\n",(0,r.jsxs)(n.li,{children:["Message queue: used by ",(0,r.jsx)(n.code,{children:"setTimeout"}),", ",(0,r.jsx)(n.code,{children:"DOM events"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["\u5fae\u4efb\u52a1 MicroTask (Jobs), \u6709\u7279\u6743, \u53ef\u4ee5\u63d2\u961f:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"process.nextTick"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Promises.then"})," (",(0,r.jsx)(n.strong,{children:"Promise \u6784\u9020\u51fd\u6570\u662f\u540c\u6b65\u51fd\u6570"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Object.observer"}),", ",(0,r.jsx)(n.code,{children:"MutationObserver"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"catch finally"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5b8f\u4efb\u52a1 MacroTask (Tasks), \u6ca1\u6709\u7279\u6743:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"scripts"}),": \u6574\u4f53\u811a\u672c\u89c6\u4f5c\u4e00\u4e2a\u5b8f\u4efb\u52a1."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MessageChannel"}),", ",(0,r.jsx)(n.code,{children:"postMessage"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"setImmediate"}),", ",(0,r.jsx)(n.code,{children:"I/O"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"setTimeout"}),", ",(0,r.jsx)(n.code,{children:"setInterval"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XHR"})," callback function."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"requestAnimationFrame"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["UI interaction ",(0,r.jsx)(n.code,{children:"events"})," callback function."]}),"\n",(0,r.jsx)(n.li,{children:"UI rendering."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"MicroTask \u4f18\u5148\u4e8e MacroTask."}),"\n",(0,r.jsx)(n.li,{children:"\u6d4f\u89c8\u5668\u4e3a\u4e86\u80fd\u591f\u4f7f\u5f97 JS \u5185\u90e8 (macro)task \u4e0e DOM \u4efb\u52a1\u80fd\u591f\u6709\u5e8f\u7684\u6267\u884c,\n\u4f1a\u5728\u4e00\u4e2a (macro)task \u6267\u884c\u7ed3\u675f\u540e, \u5728\u4e0b\u4e00\u4e2a (macro)task \u6267\u884c\u5f00\u59cb\u524d, \u5bf9\u9875\u9762\u8fdb\u884c\u91cd\u65b0\u6e32\u67d3.\n\u5f53 JS \u5f15\u64ce\u4ece\u4efb\u52a1\u961f\u5217\u4e2d\u53d6\u51fa\u4e00\u4e2a\u5b8f\u4efb\u52a1\u6765\u6267\u884c, \u5982\u679c\u6267\u884c\u8fc7\u7a0b\u4e2d\u6709\u9047\u5230\u5fae\u4efb\u52a1,\n\u90a3\u4e48\u6267\u884c\u5b8c\u8be5\u5b8f\u4efb\u52a1\u5c31\u4f1a\u53bb\u6267\u884c\u5b8f\u4efb\u52a1\u5185\u7684\u6240\u6709\u5fae\u4efb\u52a1, \u7136\u540e\u66f4\u65b0 UI.\n\u540e\u9762\u5c31\u662f\u518d\u4ece\u4efb\u52a1\u961f\u5217\u4e2d\u53d6\u51fa\u4e0b\u4e00\u4e2a\u5b8f\u4efb\u52a1\u6765\u7ee7\u7eed\u6267\u884c, \u4ee5\u6b64\u7c7b\u63a8."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Event Loop"})," \u4e0e ",(0,r.jsx)(n.code,{children:"Call Stack"})," \u6709\u4e14\u4ec5\u6709\u4e00\u4e2a, ",(0,r.jsx)(n.code,{children:"Task/Job/Message Queue"})," \u53ef\u4ee5\u6709\u591a\u4e2a."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Event Loop",type:"tip",children:(0,r.jsx)(n.p,{children:"\u5b8f\u4efb\u52a1\u961f\u5217\u53d6\u5b8f\u4efb\u52a1 -> \u6267\u884c 1 \u4e2a\u5b8f\u4efb\u52a1 -> \u68c0\u67e5\u5fae\u4efb\u52a1\u961f\u5217\u5e76\u6267\u884c\u6240\u6709\u5fae\u4efb\u52a1\n-> requestAnimationFrame -> \u6d4f\u89c8\u5668\u91cd\u6392/\u91cd\u7ed8 -> requestIdleCallback\n-> \u5b8f\u4efb\u52a1\u961f\u5217\u53d6\u5b8f\u4efb\u52a1"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Event Loop"})," simple model:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"for (const macroTask of macroTaskQueue) {\n  // 1. Handle current MacroTask.\n  runTask(macroTask)\n\n  // 2. Handle all MicroTasks.\n  for (const microTask of microTaskQueue)\n    runTask(microTask)\n\n  // 3. Handle Animation Frame.\n  if (shouldRepaint()) {\n    if (!animationFrameCallbackQueue.isEmpty()) {\n      const animationTasks = animationFrameCallbackQueue.copyTasks()\n\n      for (const animationTask of animationTasks)\n        runTask(animationTask)\n    }\n\n    repaint()\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Using ",(0,r.jsx)(n.code,{children:"setTimeout"})," with ",(0,r.jsx)(n.code,{children:"0"})," seconds timer\nhelps to defer execution of ",(0,r.jsx)(n.code,{children:"Promise"})," and ",(0,r.jsx)(n.code,{children:"bar"})," until the ",(0,r.jsx)(n.strong,{children:"stack"})," is ",(0,r.jsx)(n.strong,{children:"empty"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function bar() {\n  console.log('bar')\n}\n\nfunction baz() {\n  console.log('baz')\n}\n\nfunction foo() {\n  console.log('foo')\n  setTimeout(bar, 0)\n  new Promise((resolve, reject) => {\n    resolve('Promise resolved')\n  })\n    .then(res => console.log(res))\n    .catch(err => console.log(err))\n  baz()\n}\n\nfoo()\n\n// foo\n// baz\n// Promised resolved\n// bar\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"process.nextTick()"})," run before ",(0,r.jsx)(n.code,{children:"Promise.then()"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"console.log('1')\n\nsetTimeout(() => {\n  console.log(2)\n  Promise.resolve().then(() => {\n    console.log(3)\n    process.nextTick(() => {\n      console.log(4)\n    })\n  })\n})\n\nPromise.resolve().then(() => {\n  console.log(5)\n  setTimeout(() => {\n    console.log(6)\n  })\n  Promise.resolve().then(() => {\n    console.log(7)\n  })\n})\n\nprocess.nextTick(() => {\n  console.log(8)\n  process.nextTick(() => {\n    console.log(9)\n  })\n})\n\nconsole.log('10')\n// 1 10 8 9 5 7 2 3 4 6\n"})}),"\n",(0,r.jsx)(n.p,{children:"Promise \u6784\u9020\u51fd\u6570\u672c\u8eab\u662f\u540c\u6b65\u51fd\u6570:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"console.log('script start')\n\nconst promise1 = new Promise((resolve) => {\n  console.log('promise1')\n  resolve()\n  console.log('promise1 end')\n}).then(() => {\n  console.log('promise2')\n})\n\nsetTimeout(() => {\n  console.log('setTimeout')\n})\n\nconsole.log('script end')\n\n// \u8f93\u51fa\u987a\u5e8f:\n// script start\n// promise1\n// promise1 end\n// script end\n// promise2\n// setTimeout.\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"await a(); b()"})," \u7b49\u4ef7\u4e8e ",(0,r.jsx)(n.code,{children:"Promise(a()).then(b())"}),",\n",(0,r.jsx)(n.code,{children:"a"})," \u662f\u540c\u6b65\u6267\u884c, ",(0,r.jsx)(n.code,{children:"b"})," \u662f MicroTask:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"async function async1() {\n  console.log('async1 start')\n  await async2()\n  console.log('async1 end')\n}\n\nasync function async2() {\n  console.log('async2')\n}\n\nconsole.log('script start')\n\nsetTimeout(() => {\n  console.log('setTimeout')\n}, 0)\n\nasync1()\n\nnew Promise((resolve) => {\n  console.log('promise1')\n  resolve()\n}).then(() => {\n  console.log('promise2')\n})\n\nconsole.log('script end')\n\n// script start\n// async1 start\n// async2\n// promise1\n// script end\n// async1 end\n// promise2\n// setTimeout\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f53\u8c03\u7528\u6808\u6ca1\u6709\u540c\u6b65\u51fd\u6570\u65f6, \u6e05\u7a7a MicroTask \u4efb\u52a1\u961f\u5217\u91cc\u7684\u51fd\u6570,\n\u518d\u4ece MacroTask \u4efb\u52a1\u961f\u5217\u91cc\u53d6\u51fa\u4e00\u4e2a\u51fd\u6570\u6267\u884c (\u7b2c\u4e8c\u6b21 Event Loop):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"function test() {\n  console.log('start')\n\n  setTimeout(() => {\n    console.log('children2')\n    Promise.resolve().then(() => {\n      console.log('children2-1')\n    })\n  }, 0)\n\n  setTimeout(() => {\n    console.log('children3')\n    Promise.resolve().then(() => {\n      console.log('children3-1')\n    })\n  }, 0)\n\n  Promise.resolve().then(() => {\n    console.log('children1')\n  })\n\n  console.log('end')\n}\n\ntest()\n\n// start\n// end\n// children1\n// children2\n// children2-1\n// children3\n// children3-1\n"})}),"\n",(0,r.jsx)(n.h3,{id:"nodejs",children:"Node.js"}),"\n",(0,r.jsx)(n.p,{children:"Node.js can run I/O operations in a non-blocking way,\nmeaning other code (and even other I/O operations) can be executed\nwhile an I/O operation is in progress."}),"\n",(0,r.jsxs)(n.p,{children:["Instead of having to ",(0,r.jsx)(n.strong,{children:"wait"})," for an I/O operation to complete\n(and essentially waste CPU cycles sitting idle),\nNode.js can use the time to execute other tasks."]}),"\n",(0,r.jsxs)(n.p,{children:["When the I/O operation completes,\n",(0,r.jsx)(n.strong,{children:"event loop"})," give back control to the piece of code\nthat is waiting for the result of that I/O operation."]}),"\n",(0,r.jsxs)(n.p,{children:["The Node.js execution model was designed to cater to the needs of most web servers,\nwhich tend to be ",(0,r.jsx)(n.strong,{children:"I/O-intensive"})," (due to non-blocking I/O)."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"console.log('glob1')\n\nsetTimeout(() => {\n  console.log('timeout1')\n  process.nextTick(() => {\n    console.log('timeout1_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('timeout1_promise')\n    resolve()\n  }).then(() => {\n    console.log('timeout1_then')\n  })\n})\n\nsetImmediate(() => {\n  console.log('immediate1')\n  process.nextTick(() => {\n    console.log('immediate1_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('immediate1_promise')\n    resolve()\n  }).then(() => {\n    console.log('immediate1_then')\n  })\n})\n\nprocess.nextTick(() => {\n  console.log('glob1_nextTick')\n})\nnew Promise((resolve) => {\n  console.log('glob1_promise')\n  resolve()\n}).then(() => {\n  console.log('glob1_then')\n})\n\nsetTimeout(() => {\n  console.log('timeout2')\n  process.nextTick(() => {\n    console.log('timeout2_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('timeout2_promise')\n    resolve()\n  }).then(() => {\n    console.log('timeout2_then')\n  })\n})\n\nprocess.nextTick(() => {\n  console.log('glob2_nextTick')\n})\nnew Promise((resolve) => {\n  console.log('glob2_promise')\n  resolve()\n}).then(() => {\n  console.log('glob2_then')\n})\n\nsetImmediate(() => {\n  console.log('immediate2')\n  process.nextTick(() => {\n    console.log('immediate2_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('immediate2_promise')\n    resolve()\n  }).then(() => {\n    console.log('immediate2_then')\n  })\n})\n\nconsole.log('glob2')\n\n// glob1\n// glob1_promise\n// glob2_promise\n// glob2\n// glob1_nextTick\n// glob2_nextTick\n// glob1_then\n// glob2_then\n// timeout1\n// timeout1_promise\n// timeout1_nextTick\n// timeout1_then\n// timeout2\n// timeout2_promise\n// timeout2_nextTick\n// timeout2_then\n// immediate1\n// immediate1_promise\n// immediate1_nextTick\n// immediate1_then\n// immediate2\n// immediate2_promise\n// immediate2_nextTick\n// immediate2_then\n"})}),"\n",(0,r.jsx)(n.h2,{id:"v8",children:"V8"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"source code (parser) AST (interpreter) bytecode"}),"\n",(0,r.jsx)(n.li,{children:"send profiling data from bytecode to optimizing compiler, generate optimized code"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ignition"})," interpreter"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"TurboFan"})," optimizing compiler (2 for SpiderMonkey/Edge, 3 for Safari)"]}),"\n",(0,r.jsxs)(n.li,{children:["JavaScript implementation ",(0,r.jsx)(n.a,{href:"https://notes.eatonphil.com/javascript-implementations.html",children:"list"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"object-shape",children:"Object Shape"}),"\n",(0,r.jsxs)(n.p,{children:["V8 object ",(0,r.jsx)(n.a,{href:"https://mathiasbynens.be/notes/shapes-ics",children:"shapes"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// o1 and o2 have the same shape\n// JSObject(1, 2) => Shape('x', 'y')\n// JSObject(3, 4) => Shape('x', 'y')\n// 'x' => 0 Offset, Writable, Enumerable, Configurable\n// 'y' => 1 Offset, Writable, Enumerable, Configurable\nconst o1 = { x: 1, y: 2 }\nconst o2 = { x: 3, y: 4 }\n"})}),"\n",(0,r.jsx)(n.p,{children:"Shape transform:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// Shape chain: Shape(empty) => Shape(x) => Shape(x, y)\nconst o = {}\no.x = 1\no.y = 2\n\n// Shape chain: Shape(empty) => Shape(y) => Shape(y, x)\nconst o = {}\no.y = 2\no.x = 1\n\n// Shape chain: Shape(x)\nconst o = { x: 1 }\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Array shape: ",(0,r.jsx)(n.code,{children:"Shape('length'), 'length' => 0 Offset, Writable"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"inline-cache",children:"Inline Cache"}),"\n",(0,r.jsxs)(n.p,{children:["V8 use ",(0,r.jsx)(n.a,{href:"https://blog.frontend-almanac.com/js-optimisation-ic",children:"ICs"}),"\nto memorize information (same shape) where to find properties on objects:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"always initialize objects in the same way (generate the same shape)"}),"\n",(0,r.jsx)(n.li,{children:"don't add property to objects dynamically (invalid inline cache)"}),"\n",(0,r.jsx)(n.li,{children:"don't mess with property attributes of array elements"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["V8 \u4e3a\u4e86\u63d0\u9ad8\u5bf9\u8c61\u5c5e\u6027\u7684\u8bbf\u95ee\u6548\u7387, \u5c06\u5c5e\u6027\u5206\u4e3a",(0,r.jsx)(n.a,{href:"https://v8.dev/blog/fast-properties",children:"\u591a\u79cd\u7c7b\u578b"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6392\u5e8f\u5c5e\u6027 (elements): \u7b26\u5408\u6570\u7ec4\u7d22\u5f15\u7c7b\u578b\u7684\u5c5e\u6027 (\u6b63\u6574\u6570), \u5b58\u50a8\u4e3a\u7ebf\u6027\u7ed3\u6784, \u53ef\u5feb\u901f\u8bbf\u95ee."}),"\n",(0,r.jsx)(n.li,{children:"\u5e38\u89c4\u5c5e\u6027 (properties): \u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u5c5e\u6027 (\u5305\u62ec\u8d1f\u6570/\u6d6e\u70b9\u6570/Symbol), \u5b58\u50a8\u4e3a\u7ebf\u6027\u7ed3\u6784, \u53ef\u5feb\u901f\u8bbf\u95ee."}),"\n",(0,r.jsx)(n.li,{children:"\u6162\u5c5e\u6027: \u5c5e\u6027\u9700\u8981\u53cd\u590d\u589e\u5220\u65f6, \u4f1a\u5c06\u5c5e\u6027\u5b58\u50a8\u7c7b\u578b\u4ece\u7ebf\u6027\u7ed3\u6784 (\u5feb\u5c5e\u6027) \u6539\u4e3a\u5b57\u5178\u7ed3\u6784 (\u6162\u5c5e\u6027)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"object-structure",children:"Object Structure"}),"\n",(0,r.jsxs)(n.p,{children:["Basic ",(0,r.jsx)(n.a,{href:"https://blog.frontend-almanac.com/js-object-structure",children:"object structure"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Every object in JavaScript has its main internal class\nand a ",(0,r.jsx)(n.a,{href:"https://v8.dev/docs/hidden-classes",children:"hidden class"})," that describes its shape."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://v8.dev/docs/hidden-classes",children:"Hidden classes"}),"\ninherit from each other and are organized into class trees.\nThe shape of an object ",(0,r.jsx)(n.code,{children:"{ a: 1 }"})," will be the parent\nfor the shape of an object ",(0,r.jsx)(n.code,{children:"{ a: 1, b: 2 }"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The order of properties matters.\nObjects ",(0,r.jsx)(n.code,{children:"{ a: 1, b: 2 }"})," and ",(0,r.jsx)(n.code,{children:"{ b: 2, a: 1 }"})," will have two different shapes."]}),"\n",(0,r.jsx)(n.li,{children:"A subclass holds a reference to the superclass\nand information about what has changed (transition)."}),"\n",(0,r.jsx)(n.li,{children:"In the class tree of each object,\nthe number of levels is not less than the number of properties in the object."}),"\n",(0,r.jsx)(n.li,{children:"The fastest properties of an object will be those declared at initialization,\nin-object property faster than external property."}),"\n",(0,r.jsxs)(n.li,{children:["Atypical changes in the object's structure, such as property removal (",(0,r.jsx)(n.code,{children:"delete"}),"),\ncan lead to a change in the storage type of properties to a slower one."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'const obj1 = { a: undefined }\nobj1.a = 1 // <- "a" - in-object property.\n\nconst obj2 = {}\nobj2.a = 1 // <- "a" - external property.\n\n// Change storage type to NameDictionary.\nconst obj1 = { a: 1, b: 2 }\ndelete obj1.a\n\n// Storage type is not changed.\nconst obj2 = { a: 1, b: 2 }\nobj2.a = undefined\n'})}),"\n",(0,r.jsxs)(n.p,{children:["An array is a regular class whose structure looks like ",(0,r.jsx)(n.code,{children:"{ length: [W__] }"}),".\nThe elements of the array are stored in special structures,\nand references to these structures are placed inside the object:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Adding or removing elements from the array\n",(0,r.jsx)(n.strong,{children:"does not"})," lead to an increase in the class tree."]}),"\n",(0,r.jsxs)(n.li,{children:["The use of atypical keys in an array,\nsuch as non-numeric keys or keys outside the range ",(0,r.jsx)(n.code,{children:"[0 .. 2**32 - 2]"}),",\nleads to the creation of new shapes in the class tree."]}),"\n",(0,r.jsx)(n.li,{children:"Attempting to modify an array element's attribute\nwill result in a switch to a slower storage type."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// 1. New element of the array doesn't extends the shapes tree.\nconst arr = []\narr[0] = 1\n\n// 2. Leads to the shapes tree generation:\n// { length } => { length, [-1] } => { length, [-1], [2**32 - 1] }.\nconst arr = []\narr[-1] = 1\narr[2 ** 32 - 1] = 2\n\n// 3. Modify element's attribute result in switch to slower storage type.\nconst arr = [1, 2, 3]\n// { elements: {\n//   #0: 1,\n//   #1: 2,\n//   #2: 3\n// }}\n\nObject.defineProperty(arr, '0', { writable: false })\n// { elements: {\n//   #0: { value: 1, attrs: [_EC] },\n//   #1: { value: 2, attrs: [WEC] },\n//   #2: { value: 3, attrs: [WEC] }\n// }}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"garbage-collection",children:"Garbage Collection"}),"\n",(0,r.jsxs)(n.p,{children:["V8 ",(0,r.jsx)(n.a,{href:"https://mp.weixin.qq.com/s/VbAUPGt3sUVzEQHxWYmlBw",children:"garbage collection"}),"\n\u5206\u4ee3\u5783\u573e\u56de\u6536\u7b97\u6cd5, \u5c06\u5806\u5206\u4e3a\u4e24\u4e2a\u7a7a\u95f4:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u65b0\u751f\u4ee3: \u5b58\u653e\u77ed\u5468\u671f\u5bf9\u8c61, \u7a7a\u95f4\u5c0f, \u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"Scavenge"})," \u56de\u6536\u7b97\u6cd5, \u526f\u5783\u573e\u56de\u6536\u5668."]}),"\n",(0,r.jsxs)(n.li,{children:["\u8001\u751f\u4ee3: \u5b58\u653e\u957f\u5468\u671f\u5bf9\u8c61, \u7a7a\u95f4\u5927, \u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"Mark-Sweep-Compact"})," \u56de\u6536\u7b97\u6cd5, \u4e3b\u5783\u573e\u56de\u6536\u5668."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scavenge",children:"Scavenge"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7a7a\u95f4\u6362\u65f6\u95f4\u7b97\u6cd5 (\u590d\u5236\u7b97\u6cd5)."}),"\n",(0,r.jsx)(n.li,{children:"\u6807\u8bb0\u6d3b\u52a8\u5bf9\u8c61\u548c\u975e\u6d3b\u52a8\u5bf9\u8c61."}),"\n",(0,r.jsx)(n.li,{children:"\u590d\u5236 from-space \u4e2d\u7684\u6d3b\u52a8\u5bf9\u8c61\u5230 to-space \u4e2d\u5e76\u8fdb\u884c\u6392\u5e8f."}),"\n",(0,r.jsx)(n.li,{children:"\u6e05\u9664 from-space \u4e2d\u7684\u6240\u6709\u5bf9\u8c61."}),"\n",(0,r.jsx)(n.li,{children:"\u5c06 from-space \u548c to-space \u8fdb\u884c\u89d2\u8272\u4e92\u6362, \u7b49\u5f85\u4e0b\u4e00\u6b21 GC."}),"\n",(0,r.jsx)(n.li,{children:"\u65b0\u751f\u4ee3\u5bf9\u8c61\u664b\u5347 (\u8ba1\u7b97\u5b58\u6d3b\u5468\u671f, \u521d\u59cb\u4e3a nursery \u5b50\u4ee3):\nallocation -> nursery \u5b50\u4ee3 -> intermediate \u5b50\u4ee3 -> \u8001\u751f\u4ee3."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"mark-sweep-compact",children:"Mark-Sweep-Compact"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u8001\u751f\u4ee3\u7a7a\u95f4\u5927, \u65e0\u6cd5\u4f7f\u7528\u7a7a\u95f4\u6362\u65f6\u95f4 (\u590d\u5236) \u7b97\u6cd5."}),"\n",(0,r.jsx)(n.li,{children:"\u6807\u8bb0\u9636\u6bb5: \u5bf9\u8001\u751f\u4ee3\u5bf9\u8c61\u8fdb\u884c\u7b2c\u4e00\u6b21\u626b\u63cf, \u5bf9\u6d3b\u52a8\u5bf9\u8c61\u8fdb\u884c\u6807\u8bb0."}),"\n",(0,r.jsx)(n.li,{children:"\u6e05\u7406\u9636\u6bb5: \u5bf9\u8001\u751f\u4ee3\u5bf9\u8c61\u8fdb\u884c\u7b2c\u4e8c\u6b21\u626b\u63cf, \u6e05\u9664\u672a\u6807\u8bb0\u7684\u5bf9\u8c61."}),"\n",(0,r.jsx)(n.li,{children:"\u538b\u7f29\u9636\u6bb5: \u6bcf\u6b21\u6e05\u7406\u5b8c\u975e\u6d3b\u52a8\u5bf9\u8c61, \u628a\u5269\u4e0b\u6d3b\u52a8\u5bf9\u8c61\u6574\u7406\u5230\u5185\u5b58\u7684\u4e00\u4fa7, \u56de\u6536\u6389\u8fb9\u754c\u4e0a\u7684\u5185\u5b58 (\u4ee5\u5907\u540e\u7eed\u5927\u5bf9\u8c61\u8001\u751f\u4ee3)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"stop-the-world",children:"Stop-The-World"}),"\n",(0,r.jsx)(n.p,{children:"\u5783\u573e\u56de\u6536\u4f18\u5148\u4e8e\u4ee3\u7801\u6267\u884c, \u4f1a\u5148\u505c\u6b62\u4ee3\u7801\u7684\u6267\u884c,\n\u7b49\u5230\u5783\u573e\u56de\u6536\u5b8c\u6bd5, \u518d\u6267\u884c JS \u4ee3\u7801, \u6210\u4e3a\u5168\u505c\u987f."}),"\n",(0,r.jsx)(n.p,{children:"Orinoco \u4f18\u5316 (\u4f18\u5316\u5168\u505c\u987f\u73b0\u8c61):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Incremental marking (time slice): ",(0,r.jsx)(n.code,{children:"JS + Mark + JS + Mark ..."}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Lazy sweeping."}),"\n",(0,r.jsx)(n.li,{children:"Concurrent GC."}),"\n",(0,r.jsx)(n.li,{children:"Parallel GC."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/thlorenz/deoptigate",children:"Deoptigate"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/thlorenz/turbolizer",children:"Turbolizer"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/thlorenz/v8-map-processor",children:"v8 map processor"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/thlorenz/v8-perf",children:"v8 perf"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"browser-engine",children:"Browser Engine"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Chrome: Blink (fork of ",(0,r.jsx)(n.code,{children:"WebCore"})," component from ",(0,r.jsx)(n.code,{children:"WebKit"}),") + V8."]}),"\n",(0,r.jsx)(n.li,{children:"Edge: Trident/EdgeHTML + Chakra -> Chromium."}),"\n",(0,r.jsx)(n.li,{children:"Firefox: Gecko + SpiderMonkey."}),"\n",(0,r.jsxs)(n.li,{children:["Safari: Webkit (fork of ",(0,r.jsx)(n.code,{children:"KHTML"})," and ",(0,r.jsx)(n.code,{children:"KJS"})," from ",(0,r.jsx)(n.code,{children:"KDE"}),") + JavaScriptCore (Nitro)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Browser process architecture:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u6d4f\u89c8\u5668\u8fdb\u7a0b:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Singleton."}),"\n",(0,r.jsx)(n.li,{children:"\u6d4f\u89c8\u5668\u754c\u9762\u663e\u793a, \u63d0\u4f9b\u7528\u6237\u4ea4\u4e92, e.g. \u524d\u8fdb/\u540e\u9000."}),"\n",(0,r.jsx)(n.li,{children:"\u5b50\u8fdb\u7a0b\u7ba1\u7406."}),"\n",(0,r.jsx)(n.li,{children:"\u7f51\u7edc\u8d44\u6e90\u7ba1\u7406."}),"\n",(0,r.jsx)(n.li,{children:"\u5b58\u50a8\u7ba1\u7406."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u7f51\u7edc\u8fdb\u7a0b:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Singleton."}),"\n",(0,r.jsx)(n.li,{children:"\u4e3b\u8981\u8d1f\u8d23\u9875\u9762\u7684\u7f51\u7edc\u8d44\u6e90\u52a0\u8f7d."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#viz-process",children:[(0,r.jsx)(n.code,{children:"Viz"})," process"]}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Singleton."}),"\n",(0,r.jsx)(n.li,{children:"\u5b9e\u73b0 3D CSS, \u7ed8\u5236 UI \u754c\u9762."}),"\n",(0,r.jsx)(n.li,{children:"GPU main thread:\nrasters display lists and video frames into GPU texture tiles,\ndraws compositor frames to screen using GPU,\nOut-of-Process display compositor, raster and iframes (OOP-D, OOP-R, OOPIFs)."}),"\n",(0,r.jsxs)(n.li,{children:["Display compositor thread:\n",(0,r.jsx)(n.strong,{children:"aggregates and optimizes"})," compositing from render processes and browser process."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6e32\u67d3\u8fdb\u7a0b:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6838\u5fc3\u4efb\u52a1\u662f\u5c06 HTML/CSS \u548c JavaScript \u8f6c\u6362\u4e3a\u7528\u6237\u53ef\u4ee5\u4e0e\u4e4b\u4ea4\u4e92\u7684\u7f51\u9875 (\u9875\u9762\u6e32\u67d3, \u811a\u672c\u6267\u884c, \u4e8b\u4ef6\u5904\u7406)."}),"\n",(0,r.jsx)(n.li,{children:"\u6392\u7248\u5f15\u64ce Blink \u548c JavaScript \u5f15\u64ce V8 \u90fd\u662f\u8fd0\u884c\u5728\u8be5\u8fdb\u7a0b\u4e2d."}),"\n",(0,r.jsx)(n.li,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b, Chrome \u4f1a\u4e3a\u6bcf\u4e2a Tab \u6807\u7b7e\u521b\u5efa\u4e00\u4e2a\u6e32\u67d3\u8fdb\u7a0b."}),"\n",(0,r.jsxs)(n.li,{children:["Within a single browser tab,\nframes (",(0,r.jsx)(n.code,{children:"<iframe>"}),") from different sites are always in different render processes\n(OOPIFs, ",(0,r.jsx)(n.a,{href:"https://www.chromium.org/developers/design-documents/oop-iframes",children:"Out-of-Process iframes"}),"),\nbut frames (",(0,r.jsx)(n.code,{children:"<iframe>"}),") from same site are always in same render process."]}),"\n",(0,r.jsx)(n.li,{children:"\u51fa\u4e8e\u5b89\u5168\u8003\u8651, \u6e32\u67d3\u8fdb\u7a0b\u90fd\u662f\u8fd0\u884c\u5728\u6c99\u7bb1\u6a21\u5f0f\u4e0b."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"\u63d2\u4ef6\u8fdb\u7a0b:\n\u4e3b\u8981\u662f\u8d1f\u8d23\u63d2\u4ef6\u7684\u8fd0\u884c, \u56e0\u63d2\u4ef6\u6613\u5d29\u6e83, \u6240\u4ee5\u9700\u8981\u901a\u8fc7\u9694\u79bb\u4ee5\u4fdd\u8bc1\u63d2\u4ef6\u8fdb\u7a0b\u5d29\u6e83\u4e0d\u4f1a\u5bf9\u6d4f\u89c8\u5668\u548c\u9875\u9762\u9020\u6210\u5f71\u54cd."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"renderingng",children:"RenderingNG"}),"\n",(0,r.jsx)(n.p,{children:"Chromium rendering engine."}),"\n",(0,r.jsx)(n.h3,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng",children:(0,r.jsx)(n.img,{alt:"RenderingNG Architecture",src:i(63550).A+"",width:"1252",height:"1235"})})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"RenderingNG"})," key goals:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng/#reliability",children:"Reliability"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng/#scalable-performance",children:"Scalable Performance"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng/#extensibility-the-right-tools-for-the-job",children:"Extensibility"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"RenderingNG"})," key changes:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Uniform point of entry:\nalways enter the pipeline at the beginning\n(no longer possible to enter the pipeline starting at an intermediate phase)."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Functional"})," stages:\neach stage should have well-defined inputs and outputs,\nand its behavior should be functional."]}),"\n",(0,r.jsx)(n.li,{children:"Constant inputs:\ninputs should be effectively constant while the stage is running."}),"\n",(0,r.jsx)(n.li,{children:"Immutable outputs:\noutputs should be immutable for the remainder of the rendering update."}),"\n",(0,r.jsx)(n.li,{children:"Checkpoint consistency:\nrendering data produced thus far should be in a self-consistent state\nat the end of each stage."}),"\n",(0,r.jsx)(n.li,{children:"De-duplication of work:\nonly compute each thing once."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"pipeline",children:"Pipeline"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture",children:"RenderingNG"}),"\n",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#the-pipeline-stages",children:"pipeline"}),"\n(green ",(0,r.jsx)(n.code,{children:"main"})," thread -> yellow ",(0,r.jsx)(n.code,{children:"compositor"})," thread -> orange ",(0,r.jsx)(n.code,{children:"Viz"})," process):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Animate."}),"\n",(0,r.jsx)(n.li,{children:"Style."}),"\n",(0,r.jsx)(n.li,{children:"Layout."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/blinkng/#the-pre-paint-phase",children:"Pre-paint"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Scroll."}),"\n",(0,r.jsx)(n.li,{children:"Paint."}),"\n",(0,r.jsx)(n.li,{children:"Commit."}),"\n",(0,r.jsx)(n.li,{children:"Layerize."}),"\n",(0,r.jsx)(n.li,{children:"Raster, decode and paint worklet (GPU hardware acceleration)."}),"\n",(0,r.jsx)(n.li,{children:"Activate."}),"\n",(0,r.jsx)(n.li,{children:"Aggregate (GPU hardware acceleration)."}),"\n",(0,r.jsx)(n.li,{children:"Draw (GPU hardware acceleration)."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#rendering-pipeline-structure",children:(0,r.jsx)(n.img,{alt:"RenderingNG Pipeline",src:i(13987).A+"",width:"845",height:"1344"})})}),"\n",(0,r.jsxs)(n.p,{children:["Stages of the rendering pipeline can be skipped if they aren't needed:\nScrolling and visual effects animation can skip ",(0,r.jsx)(n.code,{children:"layout"}),", ",(0,r.jsx)(n.code,{children:"pre-paint"})," and ",(0,r.jsx)(n.code,{children:"paint"}),".\nIf ",(0,r.jsx)(n.code,{children:"layout"}),", ",(0,r.jsx)(n.code,{children:"pre-paint"}),", and ",(0,r.jsx)(n.code,{children:"paint"})," can be skipped for visual effects,\nthey can be run entirely on ",(0,r.jsx)(n.code,{children:"compositor"})," thread and ",(0,r.jsxs)(n.strong,{children:["skip ",(0,r.jsx)(n.code,{children:"main"})," thread"]}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"render-process",children:"Render Process"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Download HTML."}),"\n",(0,r.jsx)(n.li,{children:"Parser/Script."}),"\n",(0,r.jsx)(n.li,{children:"DOM and CSSOM Construction."}),"\n",(0,r.jsx)(n.li,{children:"Render Tree = DOM Tree + Styled Tree."}),"\n",(0,r.jsx)(n.li,{children:"Layout."}),"\n",(0,r.jsx)(n.li,{children:"Paint."}),"\n",(0,r.jsx)(n.li,{children:"Composite."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#threads",children:(0,r.jsx)(n.img,{alt:"Render Process",src:i(52994).A+"",width:"845",height:"587"})})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["GUI \u6e32\u67d3\u7ebf\u7a0b (",(0,r.jsxs)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#render-process-main-thread-components",children:[(0,r.jsx)(n.code,{children:"main"})," thread"]}),"):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Parse ",(0,r.jsx)(n.code,{children:"HTML"}),"/",(0,r.jsx)(n.code,{children:"CSS"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Construct ",(0,r.jsx)(n.code,{children:"DOM"})," tree, ",(0,r.jsx)(n.code,{children:"CSSOM"})," tree and ",(0,r.jsx)(n.code,{children:"RenderObject"})," tree."]}),"\n",(0,r.jsx)(n.li,{children:"Layout render tree."}),"\n",(0,r.jsx)(n.li,{children:"Paint render tree."}),"\n",(0,r.jsxs)(n.li,{children:["Send information to GPU (Composite render tree):\nseparating\n",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#render-process-main-thread-components",children:(0,r.jsx)(n.code,{children:"main"})}),"\nand\n",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#render-process-compositor-thread-structure",children:(0,r.jsx)(n.code,{children:"compositor"})}),"\nthreads is critically important for\n",(0,r.jsx)(n.code,{children:"performance isolation"})," of animation and scrolling from main thread work."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["JS \u5f15\u64ce\u7ebf\u7a0b:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["JS \u5185\u6838\u8fd0\u884c\u7ebf\u7a0b, \u8d1f\u8d23\u89e3\u6790 ",(0,r.jsx)(n.code,{children:"JavaScript"})," \u811a\u672c, \u8fd0\u884c\u4ee3\u7801."]}),"\n",(0,r.jsx)(n.li,{children:"\u4e00\u4e2a Tab \u9875 (\u6e32\u67d3\u8fdb\u7a0b) \u4e2d\u53ea\u6709\u4e00\u4e2a JS \u5f15\u64ce\u7ebf\u7a0b\u5728\u8fd0\u884c JS \u7a0b\u5e8f."}),"\n",(0,r.jsx)(n.li,{children:"JS \u5f15\u64ce\u4e00\u76f4\u7b49\u5f85\u7740\u4efb\u52a1\u961f\u5217\u4e2d\u4efb\u52a1\u7684\u5230\u6765, \u7136\u540e\u52a0\u4ee5\u5904\u7406."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4e8b\u4ef6\u89e6\u53d1\u7ebf\u7a0b:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u8d1f\u8d23\u63a7\u5236\u4e8b\u4ef6\u5faa\u73af."}),"\n",(0,r.jsx)(n.li,{children:"JS \u5f15\u64ce\u7ebf\u7a0b\u89e6\u53d1 MacroTask/MicroTask, \u4e8b\u4ef6\u7ebf\u7a0b\u5c06\u4efb\u52a1\u6dfb\u52a0\u5230\u4efb\u52a1\u961f\u5217, \u7b49\u5f85 JS \u5f15\u64ce\u7ebf\u7a0b\u6267\u884c."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5b9a\u65f6\u89e6\u53d1\u5668\u7ebf\u7a0b:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"setInterval"})," \u4e0e ",(0,r.jsx)(n.code,{children:"setTimeout"})," \u6267\u884c\u7ebf\u7a0b."]}),"\n",(0,r.jsx)(n.li,{children:"\u6b64\u7ebf\u7a0b\u8ba1\u65f6\u5e76\u89e6\u53d1\u5b9a\u65f6\u5668\u4efb\u52a1, \u8ba1\u65f6\u5b8c\u6bd5\u540e, \u4e8b\u4ef6\u7ebf\u7a0b\u5c06\u5b9a\u65f6\u5668\u4efb\u52a1\u6dfb\u52a0\u5230\u4efb\u52a1\u961f\u5217, \u7b49\u5f85 JS \u5f15\u64ce\u7ebf\u7a0b\u6267\u884c."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u5f02\u6b65 HTTP \u8bf7\u6c42\u7ebf\u7a0b:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XMLHttpRequest"})," \u8fde\u63a5\u540e, \u901a\u8fc7\u6d4f\u89c8\u5668\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u5f02\u6b65 HTTP \u8bf7\u6c42\u7ebf\u7a0b."]}),"\n",(0,r.jsx)(n.li,{children:"\u5f53\u68c0\u6d4b\u5230 HTTP \u8bf7\u6c42\u72b6\u6001\u53d8\u66f4\u65f6, \u6b64\u7ebf\u7a0b\u4ea7\u751f\u72b6\u6001\u53d8\u66f4\u4e8b\u4ef6,\n\u5e76\u5c06 HTTP \u54cd\u5e94\u5904\u7406\u51fd\u6570 (\u7528\u6237\u56de\u8c03\u51fd\u6570) \u6dfb\u52a0\u5230\u4efb\u52a1\u961f\u5217, \u7b49\u5f85 JS \u5f15\u64ce\u7ebf\u7a0b\u6267\u884c."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"GUI and JS Thread",type:"danger",children:(0,r.jsx)(n.p,{children:"GUI \u6e32\u67d3\u7ebf\u7a0b\u4e0e JS \u5f15\u64ce\u7ebf\u7a0b\u4e92\u65a5."})}),"\n",(0,r.jsxs)(n.admonition,{title:"Multi-threads Architecture",type:"tip",children:[(0,r.jsx)(n.p,{children:"Threads help achieve:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Performance isolation and responsiveness in spite of slow tasks."}),"\n",(0,r.jsx)(n.li,{children:"Helper threads:\nsending long-running subtasks off to additional threads,\nto keep parent thread responsive to other requests happening simultaneously."}),"\n",(0,r.jsx)(n.li,{children:"Multiple buffering:\nshowing previously rendered content while rendering new content,\nto hide latency of rendering."}),"\n",(0,r.jsx)(n.li,{children:"Pipeline parallelization:\nrunning rendering pipeline in multiple places simultaneously\n(fast scrolling and animation)."}),"\n"]})]}),"\n",(0,r.jsx)(n.h3,{id:"html-parser",children:"HTML Parser"}),"\n",(0,r.jsx)(n.p,{children:"DTD is context-sensitive grammar.\nUse State Machine pattern to implement a tokenizer:"}),"\n",(0,r.jsx)(n.admonition,{title:"Tokenizer",type:"tip",children:(0,r.jsx)(n.p,{children:"Data -> Tag Open -> Tag Name -> Tag Close -> Data."})}),"\n",(0,r.jsx)(n.p,{children:"tokenizer send tokens to constructor, constructing DOM tree:"}),"\n",(0,r.jsx)(n.admonition,{title:"DOM Tree Constructor",type:"tip",children:(0,r.jsx)(n.p,{children:"initial -> before HTML -> before head -> in head -> after head\n-> in body -> after body -> after after body -> EOF token."})}),"\n",(0,r.jsx)(n.p,{children:"HTML parser performance:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<= 1500"})," DOM nodes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<= 60"})," children nodes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<= 32"})," levels."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"css-parser",children:"CSS Parser"}),"\n",(0,r.jsx)(n.p,{children:"CSS is context-free grammar.\nWebkit use flex/bison (bottom-to-up), Gecko use up-to-bottom."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ruleSet\n  : selector [ ',' S* selector ]*\n    '{' S* declaration [ ';' S* declaration ]* '}' S*\n  ;\nselector\n  : simple_selector [ combinator selector | S+ [ combinator? selector ]? ]?\n  ;\nsimple_selector\n  : element_name [ HASH | class | attrib | pseudo ]*\n  | [ HASH | class | attrib | pseudo ]+\n  ;\nclass\n  : '.' IDENT\n  ;\nelement_name\n  : IDENT | '*'\n  ;\nattrib\n  : '[' S* IDENT S* [ [ '=' | INCLUDES | DASHMATCH ] S*\n    [ IDENT | STRING ] S* ] ']'\n  ;\npseudo\n  : ':' [ IDENT | FUNCTION S* [IDENT S*] ')' ]\n  ;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"layout-engine",children:"Layout Engine"}),"\n",(0,r.jsxs)(n.p,{children:["\u4e3a\u907f\u514d\u5bf9\u6240\u6709\u7ec6\u5c0f\u66f4\u6539\u90fd\u8fdb\u884c\u6574\u4f53\u5e03\u5c40, \u6d4f\u89c8\u5668\u91c7\u7528\u4e86\u4e00\u79cd ",(0,r.jsx)(n.code,{children:"dirty bit"})," \u7cfb\u7edf.\n\u5982\u679c\u67d0\u4e2a\u5448\u73b0\u5668\u53d1\u751f\u4e86\u66f4\u6539, \u6216\u8005\u5c06\u81ea\u8eab\u53ca\u5176\u5b50\u4ee3\u6807\u6ce8\u4e3a ",(0,r.jsx)(n.code,{children:"dirty"}),", \u5219\u9700\u8981\u8fdb\u884c\u5e03\u5c40:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7236\u5448\u73b0\u5668\u786e\u5b9a\u81ea\u5df1\u7684\u5bbd\u5ea6."}),"\n",(0,r.jsxs)(n.li,{children:["\u7236\u5448\u73b0\u5668\u4f9d\u6b21\u5904\u7406\u5b50\u5448\u73b0\u5668, \u5e76\u4e14:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u653e\u7f6e\u5b50\u5448\u73b0\u5668 (\u8bbe\u7f6e ",(0,r.jsx)(n.code,{children:"(x, y)"})," \u5750\u6807)."]}),"\n",(0,r.jsx)(n.li,{children:"\u5982\u679c\u6709\u5fc5\u8981, \u8c03\u7528\u5b50\u5448\u73b0\u5668\u7684\u5e03\u5c40 (\u5982\u679c\u5b50\u5448\u73b0\u5668\u662f dirty \u7684, \u6216\u8005\u8fd9\u662f\u5168\u5c40\u5e03\u5c40, \u6216\u51fa\u4e8e\u5176\u4ed6\u67d0\u4e9b\u539f\u56e0),\n\u8fd9\u4f1a\u8ba1\u7b97\u5b50\u5448\u73b0\u5668\u7684\u9ad8\u5ea6."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"\u7236\u5448\u73b0\u5668\u6839\u636e\u5b50\u5448\u73b0\u5668\u7684\u7d2f\u52a0\u9ad8\u5ea6\u4ee5\u53ca\u8fb9\u8ddd\u548c\u8865\u767d\u7684\u9ad8\u5ea6\u6765\u8bbe\u7f6e\u81ea\u8eab\u9ad8\u5ea6, \u6b64\u503c\u4e5f\u53ef\u4f9b\u7236\u5448\u73b0\u5668\u7684\u7236\u5448\u73b0\u5668\u4f7f\u7528."}),"\n",(0,r.jsxs)(n.li,{children:["\u5c06\u5176 ",(0,r.jsx)(n.code,{children:"dirty \u4f4d"})," \u8bbe\u7f6e\u4e3a ",(0,r.jsx)(n.code,{children:"false"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"RenderingNG"})," ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng",children:"layout engine"}),"\ngenerate\n",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-data-structures/#the-immutable-fragment-tree",children:"immutable fragment tree"}),"\nand\n",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-data-structures/#inline-fragment-items",children:"immutable flat list"}),".\nIt helps mitigate layout bugs including:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#correctness",children:"Correctness"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#under-invalidation",children:"Under-invalidation"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#over-invalidation-and-performance",children:"Over-invalidation"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#hysteresis",children:"Hysteresis"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"paint-engine",children:"Paint Engine"}),"\n",(0,r.jsx)(n.p,{children:"Paint order:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u80cc\u666f\u989c\u8272."}),"\n",(0,r.jsx)(n.li,{children:"\u80cc\u666f\u56fe\u7247."}),"\n",(0,r.jsx)(n.li,{children:"\u8fb9\u6846."}),"\n",(0,r.jsx)(n.li,{children:"\u5b50\u4ee3."}),"\n",(0,r.jsx)(n.li,{children:"\u8f6e\u5ed3."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-data-structures/#property-trees",children:"Property trees"}),"\nare data structures that explain how visual and scrolling effects apply to DOM elements.\nEvery web document has four separate property trees:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Transform tree represents CSS transforms and scrolling."}),"\n",(0,r.jsx)(n.li,{children:"Clip tree represents overflow clips."}),"\n",(0,r.jsx)(n.li,{children:"Effect tree represents all other visual effects:\nopacity, filters, masks, blend modes, and other kinds of clips such as clip-path."}),"\n",(0,r.jsx)(n.li,{children:"Scroll tree represents information about scrolling,.\nsuch as how scrolls chain together"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"JavaScript \u963b\u585e\u6e32\u67d3:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u6e32\u67d3\u8fdb\u7a0b (",(0,r.jsx)(n.code,{children:"Render"})," process) \u4e2d\u4e3b\u7ebf\u7a0b (",(0,r.jsx)(n.code,{children:"main"})," thread) ",(0,r.jsx)(n.code,{children:"Layout"})," \u9636\u6bb5\u4e0e ",(0,r.jsx)(n.code,{children:"Paint"})," \u9636\u6bb5\u4e0d\u8d1f\u8d23\u5b9e\u9645\u7684\u7ed8\u5236\u64cd\u4f5c:\n",(0,r.jsx)(n.code,{children:"Layout"})," \u9636\u6bb5\u6267\u884c ",(0,r.jsx)(n.code,{children:"Update Layer Tree"}),", \u66f4\u65b0\u6bcf\u5c42\u4fe1\u606f,\n",(0,r.jsx)(n.code,{children:"Paint"})," \u9636\u6bb5\u6574\u7406\u6bcf\u5c42\u9875\u9762\u7684\u7ed8\u5236\u4fe1\u606f, \u6784\u5efa\u7ed8\u5236\u5217\u8868."]}),"\n",(0,r.jsxs)(n.li,{children:["\u4ee5\u4e0a\u9636\u6bb5\u7684\u6570\u636e\u6700\u7ec8\u4f1a\u4ea4\u7ed9\n\u6e32\u67d3\u8fdb\u7a0b (",(0,r.jsx)(n.code,{children:"Render"})," process) \u4e2d\u5408\u6210\u7ebf\u7a0b (",(0,r.jsx)(n.code,{children:"compositor"})," thread) \u4e0e ",(0,r.jsx)(n.code,{children:"Viz"})," process \u6267\u884c\u5b9e\u9645\u7684\u7ed8\u5236\u64cd\u4f5c."]}),"\n",(0,r.jsxs)(n.li,{children:["JavaScript \u963b\u585e\u4e86\u540c\u5728\u4e3b\u7ebf\u7a0b\u7684 ",(0,r.jsx)(n.code,{children:"Layout"})," \u9636\u6bb5\u4e0e ",(0,r.jsx)(n.code,{children:"Paint"})," \u9636\u6bb5,\n\u95f4\u63a5\u963b\u585e\u4e86 ",(0,r.jsx)(n.code,{children:"compositor"})," thread \u4e0e ",(0,r.jsx)(n.code,{children:"Viz"})," process \u7684\u7ed8\u5236\u64cd\u4f5c."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"video-engine",children:"Video Engine"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/videong",children:(0,r.jsx)(n.img,{alt:"RenderingNG Video Engine",src:i(53561).A+"",width:"845",height:"474"})})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Each video talks directly to ",(0,r.jsx)(n.code,{children:"Viz"})," process:\nvideo rendering is largely decoupled from ",(0,r.jsx)(n.code,{children:"RenderingNG"})," main rendering pipeline."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scrolling-performance",children:"Scrolling Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cached GPU textures and display lists:\nhelp battery life and animation frame rate for scrolling."}),"\n",(0,r.jsx)(n.li,{children:"Every possible scroll is threaded:\ndon't have to depend on the JavaScript and layout thread."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"animation-performance",children:"Animation Performance"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#an-example-in-practice",children:(0,r.jsx)(n.img,{alt:"RenderingNG Transform Animation",src:i(26393).A+"",width:"845",height:"516"})})}),"\n",(0,r.jsxs)(n.p,{children:["CSS transform animation only runs on ",(0,r.jsx)(n.code,{children:"compositor"})," thread and ",(0,r.jsx)(n.code,{children:"Viz"})," process."]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Chromium rendering engine: ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/blog/renderingng",children:"RenderingNG"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Chromium ",(0,r.jsx)(n.code,{children:"RenderingNG"})," ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/blog/renderingng-architecture",children:"architecture"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Chromium ",(0,r.jsx)(n.code,{children:"RenderingNG"})," ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/blog/renderingng-data-structures",children:"key data structures"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Chromium ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/blog/videong",children:"video engine architecture"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Chromium ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng",children:"layout engine architecture"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Chromium ",(0,r.jsx)(n.code,{children:"Blink"})," ",(0,r.jsx)(n.a,{href:"https://developer.chrome.com/articles/blinkng",children:"architecture"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Web platform ",(0,r.jsx)(n.a,{href:"https://wpt.fyi",children:"tests"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Google Chrome platform feature ",(0,r.jsx)(n.a,{href:"https://github.com/GoogleChrome/chromium-dashboard",children:"status"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Mozilla Firefox platform feature ",(0,r.jsx)(n.a,{href:"https://github.com/mozilla/standards-positions",children:"status"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Thin wrappers around ",(0,r.jsx)(n.a,{href:"https://polypane.app/blog/not-all-browser-apis-are-web-apis",children:"native APIs"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["JavaScript ",(0,r.jsx)(n.a,{href:"https://buttondown.com/whatever_jamie/archive/the-many-many-many-javascript-runtimes-of-the-last-decade",children:"runtimes"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},37984:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/context-stack-and-scope-chain-1fe54b80b91bd079b55a126e7d2fec4a.png"},48874:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/event-loop-55376b882d25e724423d4dc9883cf416.jpg"},52994:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/render-process-d33647f97a751f3e6601f1209758c41f.webp"},26393:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/rendering-ng-animation-ebbf3b677788319cd6f78d7c148ef594.webp"},13987:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/rendering-ng-pipeline-fb49aa882cd3041e0db55f2b47c728f7.webp"},53561:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/rendering-ng-video-engine-7c8d28a5bf1cda6a76d9eebe34c97031.webp"},63550:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/rendering-ng-9f126cf8c6b7acb6bbb8fedb207599bb.webp"},86145:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var s=i(57140);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);