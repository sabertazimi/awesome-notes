"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[21116],{66e3:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"web/performance/monitoring","title":"Monitoring","description":"\u524d\u7aef\u6027\u80fd\u76d1\u63a7\u5206\u4e3a\u4e24\u79cd\u65b9\u5f0f,","source":"@site/content/web/performance/monitoring.md","sourceDirName":"web/performance","slug":"/web/performance/monitoring","permalink":"/notes/web/performance/monitoring","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/performance/monitoring.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"Performance","permalink":"/notes/tags/performance"},{"inline":true,"label":"Monitoring","permalink":"/notes/tags/monitoring"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":7,"frontMatter":{"sidebar_position":7,"tags":["Web","Performance","Monitoring"]},"sidebar":"tutorialSidebar","previous":{"title":"Loading","permalink":"/notes/web/performance/loading"},"next":{"title":"Web Vitals","permalink":"/notes/web/performance/vitals"}}');var l=t(35656),r=t(86145);const s={sidebar_position:7,tags:["Web","Performance","Monitoring"]},d="Monitoring",c={},o=[{value:"Synthetic",id:"synthetic",level:2},{value:"Real User",id:"real-user",level:2},{value:"Methods",id:"methods",level:2},{value:"APIs",id:"apis",level:2},{value:"Statistics",id:"statistics",level:2},{value:"Reporting",id:"reporting",level:2},{value:"Image Beacon",id:"image-beacon",level:3},{value:"References",id:"references",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"monitoring",children:"Monitoring"})}),"\n",(0,l.jsx)(n.p,{children:"\u524d\u7aef\u6027\u80fd\u76d1\u63a7\u5206\u4e3a\u4e24\u79cd\u65b9\u5f0f,\n\u4e00\u79cd\u53eb\u505a\u5408\u6210\u76d1\u63a7 (Synthetic Monitoring, SYN),\n\u53e6\u4e00\u79cd\u662f\u771f\u5b9e\u7528\u6237\u76d1\u63a7 (Real User Monitoring, RUM)."}),"\n",(0,l.jsx)(n.h2,{id:"synthetic",children:"Synthetic"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4e00\u4e2a\u6a21\u62df\u573a\u666f\u91cc, \u53bb\u63d0\u4ea4\u4e00\u4e2a\u9700\u8981\u505a\u6027\u80fd\u5ba1\u8ba1\u7684\u9875\u9762,\n\u901a\u8fc7\u4e00\u7cfb\u5217\u7684\u5de5\u5177/\u89c4\u5219\u53bb\u8fd0\u884c\u4f60\u7684\u9875\u9762, \u63d0\u53d6\u4e00\u4e9b\u6027\u80fd\u6307\u6807, \u5f97\u51fa\u4e00\u4e2a\u5ba1\u8ba1\u62a5\u544a."}),"\n",(0,l.jsx)(n.p,{children:"\u5e38\u89c1\u7684\u5de5\u5177\u6709 Google \u7684 Lighthouse, WebPageTest, PageSpeed \u7b49"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f18\u70b9"}),(0,l.jsx)(n.th,{style:{textAlign:"center"},children:"\u7f3a\u70b9"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9e\u73b0\u7b80\u5355"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"\u65e0\u6cd5\u8fd8\u539f\u5168\u90e8\u771f\u5b9e\u573a\u666f"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u80fd\u91c7\u96c6\u5230\u4e30\u5bcc\u7684\u6570\u636e, \u5982\u786c\u4ef6\u6307\u6807\u6216\u7011\u5e03\u56fe"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"\u767b\u5f55\u7b49\u573a\u666f\u9700\u8981\u989d\u5916\u89e3\u51b3"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e0d\u5f71\u54cd\u771f\u5b9e\u7528\u6237\u7684\u8bbf\u95ee\u6027\u80fd"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"\u5355\u6b21\u6570\u636e\u4e0d\u591f\u7a33\u5b9a"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u53ef\u4ee5\u63d0\u4f9b\u9875\u9762\u52a0\u8f7d\u5e7b\u706f\u7247\u7b49\u53ef\u89c6\u5316\u5206\u6790\u9014\u5f84"}),(0,l.jsx)(n.td,{style:{textAlign:"center"},children:"\u6570\u636e\u91cf\u8f83\u5c0f, \u65e0\u6cd5\u53d1\u6325\u66f4\u5927\u4ef7\u503c"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"real-user",children:"Real User"}),"\n",(0,l.jsx)(n.p,{children:"\u7528\u6237\u5728\u9875\u9762\u8bbf\u95ee\u4e4b\u540e\u5c31\u4f1a\u4ea7\u751f\u5404\u79cd\u5404\u6837\u7684\u6027\u80fd\u6307\u6807,\n\u4e4b\u540e\u4f1a\u5c06\u8fd9\u4e9b\u6027\u80fd\u6307\u6807\u4e0a\u4f20\u7684\u6211\u4eec\u7684\u65e5\u5fd7\u670d\u52a1\u5668\u4e0a,\n\u8fdb\u884c\u6570\u636e\u7684\u63d0\u8d77\u6e05\u6d17\u52a0\u5de5,\n\u6700\u540e\u5728\u76d1\u63a7\u5e73\u53f0\u4e0a\u8fdb\u884c\u5c55\u793a\u548c\u5206\u6790\u7684\u4e00\u4e2a\u8fc7\u7a0b."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u771f\u5b9e\u7528\u6237\u76d1\u63a7\u7684\u4f18\u7f3a\u70b9"}),"\n"]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u4f18\u70b9"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u7f3a\u70b9"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u9700\u914d\u7f6e\u6a21\u62df\u6761\u4ef6, \u5b8c\u5168\u8fd8\u539f\u771f\u5b9e\u573a\u666f"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5f71\u54cd\u771f\u5b9e\u7528\u6237\u7684\u8bbf\u95ee\u6027\u80fd\u53ca\u6d41\u91cf\u6d88\u8017"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e0d\u5b58\u5728\u767b\u5f55\u7b49\u9700\u8981\u989d\u5916\u89e3\u51b3\u7684\u573a\u666f"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u6cd5\u91c7\u96c6\u786c\u4ef6\u76f8\u5173\u6307\u6807"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u6570\u636e\u6837\u672c\u8db3\u591f\u5e9e\u5927, \u53ef\u4ee5\u51cf\u5c11\u7edf\u8ba1\u8bef\u5dee"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u6cd5\u91c7\u96c6\u5b8c\u6574\u7684\u8d44\u6e90\u52a0\u8f7d\u7011\u5e03\u56fe"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u65b0\u5e74\u6570\u636e\u53ef\u4e0e\u5176\u5b83\u6570\u636e\u5173\u8054, \u4ea7\u751f\u66f4\u5927\u4ef7\u503c"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u65e0\u6cd5\u53ef\u89c6\u5316\u5c55\u793a\u52a0\u8f7d\u8fc7\u7a0b"})]})]})]}),"\n",(0,l.jsx)(n.admonition,{title:"SYN vs RUM",type:"tip",children:(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u5bf9\u6bd4\u9879"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u5408\u6210\u76d1\u63a7"}),(0,l.jsx)(n.th,{style:{textAlign:"left"},children:"\u771f\u5b9e\u7528\u6237\u76d1\u63a7"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9e\u73b0\u96be\u5ea6\u53ca\u6210\u672c"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u8f83\u4f4e"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u8f83\u9ad8"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u91c7\u96c6\u6570\u636e\u4e30\u5bcc\u5ea6"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u4e30\u5bcc"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u57fa\u7840"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u6570\u636e\u6837\u672c\u91cf"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u8f83\u5c0f"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5927(\u89c6\u4e1a\u52a1\u4f53\u91cf)"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u9002\u5408\u573a\u666f"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9a\u6027\u5206\u6790, \u5c0f\u6570\u636e\u91cf\u5206\u6790"}),(0,l.jsx)(n.td,{style:{textAlign:"left"},children:"\u5b9a\u91cf\u5206\u6790, \u4e1a\u52a1\u6570\u636e\u6df1\u5ea6\u6316\u6398"})]})]})]})}),"\n",(0,l.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u771f\u5b9e\u7528\u6237\u6027\u80fd\u6570\u636e\u91c7\u96c6\u65f6, \u8981\u5173\u6ce8\u56db\u4e2a\u65b9\u9762\u7684\u4e1c\u897f:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4f7f\u7528\u6807\u51c6\u7684 API."}),"\n",(0,l.jsx)(n.li,{children:"\u5b9a\u4e49\u5408\u9002\u7684\u6307\u6807."}),"\n",(0,l.jsx)(n.li,{children:"\u91c7\u96c6\u6b63\u786e\u7684\u6570\u636e."}),"\n",(0,l.jsx)(n.li,{children:"\u4e0a\u62a5\u5173\u8054\u7684\u7ef4\u5ea6."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"apis",children:"APIs"}),"\n",(0,l.jsx)(n.p,{children:"\u91c7\u96c6\u6027\u80fd\u6570\u636e\u65f6\u5148\u62b9\u5e73 Navigation Timing spec \u5dee\u5f02\n\u4f18\u5148\u4f7f\u7528 PerformanceTimeline API\n(\u5728\u590d\u6742\u573a\u666f, \u4ea6\u53ef\u8003\u8651\u4f18\u5148\u4f7f\u7528 PerformanceObserver):"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u91cd\u5b9a\u5411\u8017\u65f6 = redirectEnd - redirectStart."}),"\n",(0,l.jsx)(n.li,{children:"DNS \u67e5\u8be2\u8017\u65f6 = domainLookupEnd - domainLookupStart."}),"\n",(0,l.jsx)(n.li,{children:"TCP \u94fe\u63a5\u8017\u65f6 = connectEnd - connectStart."}),"\n",(0,l.jsx)(n.li,{children:"HTTP \u8bf7\u6c42\u8017\u65f6 = responseEnd - responseStart."}),"\n",(0,l.jsx)(n.li,{children:"\u89e3\u6790 DOM \u6811\u8017\u65f6 = domComplete - domInteractive."}),"\n",(0,l.jsx)(n.li,{children:"\u767d\u5c4f\u65f6\u95f4 = responseStart - navigationStart."}),"\n",(0,l.jsx)(n.li,{children:"DOMReady \u65f6\u95f4 = domContentLoadedEventEnd - navigationStart."}),"\n",(0,l.jsx)(n.li,{children:"onload \u65f6\u95f4 = loadEventEnd - navigationStart."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"statistics",children:"Statistics"}),"\n",(0,l.jsx)(n.p,{children:"First Meaningful Paint: \u9996\u6b21\u6709\u6548\u6e32\u67d3\u65f6\u957f,\n\u5b83\u7684\u4e00\u4e2a\u6838\u5fc3\u7684\u60f3\u6cd5\u662f\u6e32\u67d3\u5e76\u4e0d\u4e00\u5b9a\u4ee3\u8868\u7740\u7528\u6237\u770b\u5230\u4e86\u4e3b\u8981\u5185\u5bb9,\nLoad \u4e5f\u4e0d\u4e00\u5b9a\u4ee3\u8868\u7528\u6237\u770b\u5230\u4e3b\u8981\u5185\u5bb9.\n\u5047\u8bbe\u5f53\u4e00\u4e2a\u7f51\u9875\u7684 DOM \u7ed3\u6784\u53d1\u751f\u5267\u70c8\u7684\u53d8\u5316\u7684\u65f6\u5019,\n\u5c31\u662f\u8fd9\u4e2a\u7f51\u9875\u4e3b\u8981\u5185\u5bb9\u51fa\u73b0\u7684\u65f6\u5019,\n\u90a3\u4e48\u5728\u8fd9\u6837\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9\u4e0a,\n\u5c31\u662f\u7528\u6237\u770b\u5230\u4e3b\u8981\u5185\u5bb9\u7684\u4e00\u4e2a\u65f6\u95f4\u70b9."}),"\n",(0,l.jsx)(n.p,{children:"\u5b83\u7684\u4f18\u70b9\u662f\u76f8\u5bf9\u6821\u51c6\u7684\u4f30\u7b97\u51fa\u5185\u5bb9\u6e32\u67d3\u65f6\u95f4, \u8d34\u8fd1\u7528\u6237\u611f\u77e5.\n\u4f46\u7f3a\u70b9\u662f\u65e0\u539f\u751f API \u652f\u6301, \u7b97\u6cd5\u63a8\u5bfc\u65f6 DOM \u8282\u70b9\u542b\u6743\u91cd."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"First Paint (FP): 0 ~ 1 ~ 2.5s."}),"\n",(0,l.jsx)(n.li,{children:"First Meaningful Paint (FMP)"}),"\n",(0,l.jsx)(n.li,{children:"First Contentful Paint (FCP): 0 ~ 2 ~ 4s."}),"\n",(0,l.jsx)(n.li,{children:"Largest Contentful Paint (LCP): 0 ~ 2.5 ~ 4s."}),"\n",(0,l.jsx)(n.li,{children:"Interaction to Next Paint (INP): 0 ~ 0.2 ~ 0.5s."}),"\n",(0,l.jsx)(n.li,{children:"Cumulative Layout Shift (CLS): 0 ~ 0.1 ~ 0.25."}),"\n",(0,l.jsx)(n.li,{children:"Time to Interactive (TTI): 0 ~ 3.8 ~ 7.3s."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"reporting",children:"Reporting"}),"\n",(0,l.jsx)(n.p,{children:"\u4e0d\u540c\u7684\u9875\u9762\u64cd\u4f5c/\u9875\u9762\u6253\u5f00\u65b9\u5f0f/\u6d4f\u89c8\u5668\u73af\u5883\u90fd\u4f1a\u5bf9\u6211\u4eec\u9875\u9762\u52a0\u8f7d\u7684\u6027\u80fd\u4f1a\u6709\u5f71\u54cd,\n\u9700\u8981\u4e0a\u62a5\u8fd9\u4e9b\u7ef4\u5ea6\u7684\u6570\u636e, \u4ee5\u4fbf\u6df1\u5165\u6027\u80fd\u5206\u6790:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5f53\u524d\u9875\u9762\u662f\u5426\u53ef\u89c1."}),"\n",(0,l.jsx)(n.li,{children:"\u9875\u9762\u52a0\u8f7d\u65b9\u5f0f: \u76f4\u63a5\u6253\u5f00/\u5237\u65b0\u6253\u5f00/\u524d\u8fdb\u540e\u9000\u6253\u5f00."}),"\n",(0,l.jsx)(n.li,{children:"\u662f\u5426\u542f\u7528 HTTP2."}),"\n",(0,l.jsx)(n.li,{children:"\u662f\u5426\u542f\u7528 Service Worker."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u89e3\u51b3\u4e0a\u62a5\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u95ee\u9898\u6709\u4ee5\u4e0b\u65b9\u6848:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5ef6\u8fdf\u5408\u5e76\u4e0a\u62a5: \u5ef6\u8fdf\u5230 ",(0,l.jsx)(n.code,{children:"onload"})," \u4e8b\u4ef6\u540e, \u5e76\u5408\u5e76\u591a\u4e2a\u4e0a\u62a5\u8bf7\u6c42."]}),"\n",(0,l.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,l.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Beacon_API",children:"Beacon API"}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Sent reliably (even if page unload)."}),"\n",(0,l.jsx)(n.li,{children:"Sent asynchronously."}),"\n",(0,l.jsx)(n.li,{children:"Not impact loading of next page."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"post"})," \u4e0a\u62a5."]}),"\n",(0,l.jsxs)(n.li,{children:["Prefer ",(0,l.jsx)(n.code,{children:"visibilitychange"}),"/",(0,l.jsx)(n.code,{children:"pagehide"})," event.\n",(0,l.jsx)(n.code,{children:"unload"}),"/",(0,l.jsx)(n.code,{children:"beforeunload"})," event not precise for mobile users:\ne.g. switch to another app not trigger ",(0,l.jsx)(n.code,{children:"unload"})," event."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"document.addEventListener('DOMContentLoaded', () => {\n  console.log('DOM \u6302\u8f7d\u65f6\u95f4: ', Date.now() - timerStart)\n\n  // \u6027\u80fd\u65e5\u5fd7\u4e0a\u62a5...\n})\n\nwindow.addEventListener('load', () => {\n  console.log('\u6240\u6709\u8d44\u6e90\u52a0\u8f7d\u5b8c\u6210\u65f6\u95f4: ', Date.now() - timerStart)\n\n  // \u6027\u80fd\u65e5\u5fd7\u4e0a\u62a5...\n})\n\ndocument.addEventListener('visibilitychange', () => {\n  if (document.visibilityState === 'hidden') {\n    const obj = { user: 1 }\n    const blob = new Blob([JSON.stringify(obj, null, 2)], {\n      type: 'application/json',\n    })\n    navigator.sendBeacon('/log', blob)\n  }\n})\n"})}),"\n",(0,l.jsx)(n.h3,{id:"image-beacon",children:"Image Beacon"}),"\n",(0,l.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"GIF"})," \u56fe\u7247\u8fdb\u884c\u524d\u7aef\u76d1\u63a7\u4e0a\u62a5:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u8de8\u57df\u53cb\u597d: ",(0,l.jsx)(n.code,{children:"img"})," \u5929\u7136\u652f\u6301\u8de8\u57df."]}),"\n",(0,l.jsxs)(n.li,{children:["\u8282\u7701\u7f51\u7edc\u8d44\u6e90:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u56fe\u7247\u8bf7\u6c42\u4e0d\u5360\u7528 AJAX \u8bf7\u6c42\u9650\u989d."}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"GIF"})," \u7b80\u5355\u5b89\u5168, \u4f53\u79ef\u5c0f, \u5bf9\u7f51\u9875\u5185\u5bb9\u51e0\u4e4e\u65e0\u5f71\u54cd,\n\u76f8\u8f83 ",(0,l.jsx)(n.code,{children:"BMP"}),"/",(0,l.jsx)(n.code,{children:"PNG"}),", \u53ef\u4ee5\u8282\u7ea6 ",(0,l.jsx)(n.code,{children:"41%"}),"/",(0,l.jsx)(n.code,{children:"35%"})," \u7f51\u7edc\u8d44\u6e90."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4e0d\u4f1a\u963b\u585e\u9875\u9762\u52a0\u8f7d, \u4e0d\u5f71\u54cd\u7528\u6237\u4f53\u9a8c:\n\u53ea\u9700 ",(0,l.jsx)(n.code,{children:"new Image()"})," \u5bf9\u8c61,\n\u901a\u8fc7 ",(0,l.jsx)(n.code,{children:"onerror"})," \u548c ",(0,l.jsx)(n.code,{children:"onload"})," \u4e8b\u4ef6\u6765\u68c0\u6d4b\u53d1\u9001\u72b6\u6001,\n\u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u9700 ",(0,l.jsx)(n.code,{children:"append"})," \u5230 ",(0,l.jsx)(n.code,{children:"DOM"})," \u4e2d."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const thisPage = window.location.href\nconst referringPage = document.referrer ? document.referrer : 'none'\nconst beacon = new Image()\nbeacon.src = `http://www.example.com/logger/beacon.gif?page=${encodeURI(thisPage)}&ref=${encodeURI(referringPage)}`\n"})}),"\n",(0,l.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Performance monitoring data collection and report ",(0,l.jsx)(n.a,{href:"https://zhuanlan.zhihu.com/p/420330110",children:"case"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["Performance monitoring real world ",(0,l.jsx)(n.a,{href:"https://juejin.cn/post/7078512301665419295",children:"case"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["Dangerous performance cheating ",(0,l.jsx)(n.a,{href:"https://performance.shopify.com/blogs/blog/don-t-get-scammed-by-fake-performance-experts-and-apps",children:"hacks"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},86145:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>d});var i=t(57140);const l={},r=i.createContext(l);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);