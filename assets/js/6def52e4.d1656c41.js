"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[49154],{45873:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"programming/android/device","title":"Device","description":"Map","source":"@site/content/programming/android/device.md","sourceDirName":"programming/android","slug":"/programming/android/device","permalink":"/notes/programming/android/device","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/programming/android/device.md","tags":[{"inline":true,"label":"Programming","permalink":"/notes/tags/programming"},{"inline":true,"label":"Android","permalink":"/notes/tags/android"},{"inline":true,"label":"Device","permalink":"/notes/tags/device"},{"inline":true,"label":"Map","permalink":"/notes/tags/map"},{"inline":true,"label":"Sensor","permalink":"/notes/tags/sensor"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":21,"frontMatter":{"sidebar_position":21,"tags":["Programming","Android","Device","Map","Sensor"]},"sidebar":"tutorialSidebar","previous":{"title":"Media","permalink":"/notes/programming/android/media"},"next":{"title":"NetWork","permalink":"/notes/programming/android/network"}}');var i=t(35656),a=t(86145);const o={sidebar_position:21,tags:["Programming","Android","Device","Map","Sensor"]},s="Device",d={},c=[{value:"Map",id:"map",level:2},{value:"Sensor",id:"sensor",level:2},{value:"Light",id:"light",level:3},{value:"Accelerometer",id:"accelerometer",level:3},{value:"Orientation",id:"orientation",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"device",children:"Device"})}),"\n",(0,i.jsx)(n.h2,{id:"map",children:"Map"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class MainActivity extends Activity {\n\n  public static final int SHOW_LOCATION = 0;\n\n  private TextView positionTextView;\n\n  private LocationManager locationManager;\n\n  private String provider;\n\n  @Override\n  protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n    positionTextView = (TextView) findViewById(R.id.position_text_view);\n    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);\n    // \u83b7\u53d6\u6240\u6709\u53ef\u7528\u7684\u4f4d\u7f6e\u63d0\u4f9b\u5668\n    List<String> providerList = locationManager.getProviders(true);\n    if (providerList.contains(LocationManager.GPS_PROVIDER)) {\n      provider = LocationManager.GPS_PROVIDER;\n    } else if (providerList.contains(LocationManager.NETWORK_PROVIDER)) {\n      provider = LocationManager.NETWORK_PROVIDER;\n    } else {\n      // \u5f53\u6ca1\u6709\u53ef\u7528\u7684\u4f4d\u7f6e\u63d0\u4f9b\u5668\u65f6\uff0c\u5f39\u51faToast\u63d0\u793a\u7528\u6237\n      Toast.makeText(this, "No location provider to use",\n          Toast.LENGTH_SHORT).show();\n      return;\n    }\n    Location location = locationManager.getLastKnownLocation(provider);\n    if (location != null) {\n      // \u663e\u793a\u5f53\u524d\u8bbe\u5907\u7684\u4f4d\u7f6e\u4fe1\u606f\n      showLocation(location);\n    }\n    locationManager.requestLocationUpdates(provider, 5000, 1,\n        locationListener);\n  }\n\n  protected void onDestroy() {\n    super.onDestroy();\n    if (locationManager != null) {\n      // \u5173\u95ed\u7a0b\u5e8f\u65f6\u5c06\u76d1\u542c\u5668\u79fb\u9664\n      locationManager.removeUpdates(locationListener);\n    }\n  }\n\n  LocationListener locationListener = new LocationListener() {\n\n    @Override\n    public void onStatusChanged(String provider, int status, Bundle extras) {\n    }\n\n    @Override\n    public void onProviderEnabled(String provider) {\n    }\n\n    @Override\n    public void onProviderDisabled(String provider) {\n    }\n\n    @Override\n    public void onLocationChanged(Location location) {\n      // \u66f4\u65b0\u5f53\u524d\u8bbe\u5907\u7684\u4f4d\u7f6e\u4fe1\u606f\n      showLocation(location);\n    }\n  };\n\n  private void showLocation(final Location location) {\n    new Thread(new Runnable() {\n      @Override\n      public void run() {\n        try {\n          // \u7ec4\u88c5\u53cd\u5411\u5730\u7406\u7f16\u7801\u7684\u63a5\u53e3\u5730\u5740\n          StringBuilder url = new StringBuilder();\n          url.append("https://maps.googleapis.com/maps/api/geocode/json?latlng=");\n          url.append(location.getLatitude()).append(",")\n              .append(location.getLongitude());\n          url.append("&sensor=false");\n          HttpClient httpClient = new DefaultHttpClient();\n          HttpGet httpGet = new HttpGet(url.toString());\n          // \u5728\u8bf7\u6c42\u6d88\u606f\u5934\u4e2d\u6307\u5b9a\u8bed\u8a00\uff0c\u4fdd\u8bc1\u670d\u52a1\u5668\u4f1a\u8fd4\u56de\u4e2d\u6587\u6570\u636e\n          httpGet.addHeader("Accept-Language", "zh-CN");\n          HttpResponse httpResponse = httpClient.execute(httpGet);\n          if (httpResponse.getStatusLine().getStatusCode() == 200) {\n            HttpEntity entity = httpResponse.getEntity();\n            String response = EntityUtils.toString(entity, "utf-8");\n            JSONObject jsonObject = new JSONObject(response);\n            // \u83b7\u53d6results\u8282\u70b9\u4e0b\u7684\u4f4d\u7f6e\u4fe1\u606f\n            JSONArray resultArray = jsonObject.getJSONArray("results");\n            if (resultArray.length() > 0) {\n              JSONObject subObject = resultArray.getJSONObject(0);\n              // \u53d6\u51fa\u683c\u5f0f\u5316\u540e\u7684\u4f4d\u7f6e\u4fe1\u606f\n              String address = subObject.getString("formatted_address");\n              Message message = new Message();\n              message.what = SHOW_LOCATION;\n              message.obj = address;\n              handler.sendMessage(message);\n            }\n          }\n        } catch (Exception e) {\n          e.printStackTrace();\n        }\n      }\n    }).start();\n  }\n\n  private Handler handler = new Handler() {\n\n    public void handleMessage(Message msg) {\n      switch (msg.what) {\n      case SHOW_LOCATION:\n        String currentPosition = (String) msg.obj;\n        positionTextView.setText(currentPosition);\n        break;\n      default:\n        break;\n      }\n    }\n\n  };\n\n}\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"sensor",children:"Sensor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"SensorManager sensorManager = (SensorManager)getSystemService(Context.SENSOR_SERVICE);\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"SensorEventListener listener = new SensorEventListener() {\n    @Override\n    public void onAccuracyChanged(Sensor sensor, int accuracy) {\n    }\n    @Override\n    public void onSensorChanged(SensorEvent event) {\n    }\n};\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"sensorManager.registerListener(listener, sensor, SensorManager.SENSOR_DELAY_NORMAL);\nsensorManager.unregisterListener(listener);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"light",children:"Light"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"accelerometer",children:"Accelerometer"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"orientation",children:"Orientation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION);\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},86145:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var r=t(57140);const i={},a=r.createContext(i);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);