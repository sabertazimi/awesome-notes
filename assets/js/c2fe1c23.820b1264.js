"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[17262],{77140:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"web/vue/options","title":"Options","description":"Parent component options:","source":"@site/content/web/vue/options.md","sourceDirName":"web/vue","slug":"/web/vue/options","permalink":"/notes/web/vue/options","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/vue/options.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"Vue","permalink":"/notes/tags/vue"},{"inline":true,"label":"Internals","permalink":"/notes/tags/internals"},{"inline":true,"label":"Options","permalink":"/notes/tags/options"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":22,"frontMatter":{"tags":["Web","Vue","Internals","Options"],"sidebar_position":22},"sidebar":"tutorialSidebar","previous":{"title":"Core","permalink":"/notes/web/vue/architecture"},"next":{"title":"Lifecycle","permalink":"/notes/web/vue/lifecycle"}}');var s=t(35656),o=t(86145);const r={tags:["Web","Vue","Internals","Options"],sidebar_position:22},c="Options",d={},l=[{value:"Merge",id:"merge",level:2},{value:"Normalize",id:"normalize",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"options",children:"Options"})}),"\n",(0,s.jsx)(n.p,{children:"Parent component options:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"vm.$options = {\n  components: {\n    KeepAlive,\n    Transition,\n    TransitionGroup,\n    ...UserRegisterComponents,\n  },\n  created: [\n    function created() {\n      console.log('parent created')\n    },\n  ],\n  directives: {\n    model,\n    show,\n    ...userCustomDirectives,\n  },\n  filters: {},\n  _base: function Vue(options) {},\n  el: '#app',\n  render: function _render(h) {},\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Children component options:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"vm.$options = {\n  parent: Vue /* \u7236Vue\u5b9e\u4f8b */,\n  propsData: undefined,\n  _componentTag: undefined,\n  _parentVnode: VNode /* \u7236VNode\u5b9e\u4f8b */,\n  _renderChildren: undefined,\n  __proto__: {\n    components: {\n      KeepAlive,\n      Transition,\n      TransitionGroup,\n      ...UserRegisterComponents,\n    },\n    directives: {\n      model,\n      show,\n      ...userCustomDirectives,\n    },\n    filters: {},\n    _base: function Vue(options) {},\n  },\n  created: [\n    function created() {\n      console.log('parent created')\n    },\n    function created() {\n      console.log('child created')\n    },\n  ],\n  directives: {\n    model,\n    show,\n    ...userCustomDirectives,\n  },\n  filters: {},\n  _base: function Vue(options) {},\n  el: '#app',\n  render: function _render(h) {},\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"core/instance/state.js/initProps()"}),": ",(0,s.jsx)(n.code,{children:"this.XXX"})," -> ",(0,s.jsx)(n.code,{children:"this._props.XXX"}),".\n",(0,s.jsx)(n.code,{children:"core/instance/state.js/initData()"}),": ",(0,s.jsx)(n.code,{children:"this.XXX"})," -> ",(0,s.jsx)(n.code,{children:"this._data.XXX"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"merge",children:"Merge"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"mergeOptions"})," (",(0,s.jsx)(n.code,{children:"core/util/options.js"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"el"}),"/",(0,s.jsx)(n.code,{children:"propsData"})," \u9009\u9879\u4f7f\u7528\u9ed8\u8ba4\u7684\u5408\u5e76\u7b56\u7565 ",(0,s.jsx)(n.code,{children:"defaultStrategy"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"data"})," \u9009\u9879, \u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"mergeDataOrFn"})," \u51fd\u6570\u8fdb\u884c\u5904\u7406, \u6700\u7ec8\u7ed3\u679c\u662f ",(0,s.jsx)(n.code,{children:"data"})," \u9009\u9879\u5c06\u53d8\u6210\u4e00\u4e2a\u51fd\u6570, \u4e14\u8be5\u51fd\u6570\u7684\u6267\u884c\u7ed3\u679c\u4e3a\u771f\u6b63\u7684\u6570\u636e\u5bf9\u8c61."]}),"\n",(0,s.jsx)(n.li,{children:"\u5bf9\u4e8e\u751f\u547d\u5468\u671f\u94a9\u5b50\u9009\u9879, \u5c06\u5408\u5e76\u6210\u6570\u7ec4, \u4f7f\u5f97\u7236\u5b50\u9009\u9879\u4e2d\u7684\u94a9\u5b50\u51fd\u6570\u90fd\u80fd\u591f\u88ab\u6267\u884c."}),"\n",(0,s.jsxs)(n.li,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"directives"}),"/",(0,s.jsx)(n.code,{children:"filters"})," \u4ee5\u53ca ",(0,s.jsx)(n.code,{children:"components"})," \u7b49\u8d44\u6e90\u9009\u9879,\n\u7236\u5b50\u9009\u9879\u5c06\u4ee5\u539f\u578b\u94fe\u7684\u5f62\u5f0f\u88ab\u5904\u7406, \u6b63\u662f\u56e0\u4e3a\u8fd9\u6837\u6211\u4eec\u624d\u80fd\u591f\u5728\u4efb\u4f55\u5730\u65b9\u90fd\u4f7f\u7528\u5185\u7f6e\u7ec4\u4ef6\u6216\u6307\u4ee4\u7b49."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"watch"})," \u9009\u9879\u7684\u5408\u5e76\u5904\u7406, \u7c7b\u4f3c\u4e8e\u751f\u547d\u5468\u671f\u94a9\u5b50, \u5982\u679c\u7236\u5b50\u9009\u9879\u90fd\u6709\u76f8\u540c\u7684\u89c2\u6d4b\u5b57\u6bb5, \u5c06\u88ab\u5408\u5e76\u4e3a\u6570\u7ec4, \u8fd9\u6837\u89c2\u5bdf\u8005\u90fd\u5c06\u88ab\u6267\u884c."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"props"}),"/",(0,s.jsx)(n.code,{children:"methods"}),"/",(0,s.jsx)(n.code,{children:"inject"}),"/",(0,s.jsx)(n.code,{children:"computed"})," \u9009\u9879, \u7236\u5b50\u9009\u9879\u59cb\u7ec8\u53ef\u7528, \u4f46\u662f\u5b50\u9009\u9879\u4f1a\u8986\u76d6\u540c\u540d\u7684\u7236\u9009\u9879\u5b57\u6bb5\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"provide"})," \u9009\u9879, \u5176\u5408\u5e76\u7b56\u7565\u4f7f\u7528\u4e0e ",(0,s.jsx)(n.code,{children:"data"})," \u9009\u9879\u76f8\u540c\u7684 ",(0,s.jsx)(n.code,{children:"mergeDataOrFn"})," \u51fd\u6570\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u6700\u540e, \u4ee5\u4e0a\u6ca1\u6709\u63d0\u53ca\u5230\u7684\u9009\u9879\u90fd\u5c06\u4f7f\u9ed8\u8ba4\u9009\u9879 ",(0,s.jsx)(n.code,{children:"defaultStrategy"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["\u6700\u6700\u540e, \u9ed8\u8ba4\u8ba4\u5408\u5e76\u7b56\u7565\u51fd\u6570 ",(0,s.jsx)(n.code,{children:"defaultStrategy"})," \u7684\u7b56\u7565\u662f: \u53ea\u8981\u5b50\u9009\u9879\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"undefined"})," \u5c31\u4f7f\u7528\u5b50\u9009\u9879, \u5426\u5219\u4f7f\u7528\u7236\u9009\u9879\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"/**\n * Merge two option objects into a new one.\n * Core utility used in both instantiation and inheritance.\n */\nexport function mergeOptions(\n  parent: object,\n  child: object,\n  vm?: Component\n): object {\n  if (typeof child === 'function')\n    child = child.options\n\n  normalizeProps(child, vm)\n  normalizeInject(child, vm)\n  normalizeDirectives(child)\n\n  const extendsFrom = child.extends\n\n  if (extendsFrom)\n    parent = mergeOptions(parent, extendsFrom, vm)\n\n  if (child.mixins) {\n    for (let i = 0, l = child.mixins.length; i < l; i++)\n      parent = mergeOptions(parent, child.mixins[i], vm)\n  }\n\n  const options = {}\n  let key\n\n  for (key in parent) mergeField(key)\n\n  for (key in child) {\n    if (!hasOwn(parent, key))\n      mergeField(key)\n  }\n\n  return options\n}\n\nfunction mergeField(key) {\n  const strategy = strategies[key] || defaultStrategy\n  options[key] = strategy(parent[key], child[key], vm, key)\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"normalize",children:"Normalize"}),"\n",(0,s.jsx)(n.p,{children:"Props:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export default {\n  props: {\n    someData1: {\n      type: Number,\n    },\n    someData2: {\n      type: String,\n      default: '',\n    },\n  },\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Injects:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export default {\n  inject: {\n    data1: { from: 'data1' },\n    d2: { from: 'data2' },\n    data3: { from: 'data3', someProperty: 'someValue' },\n  },\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Directives:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"for (const key in dirs) {\n  const def = dirs[key]\n  if (typeof def === 'function')\n    dirs[key] = { bind: def, update: def }\n}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},86145:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var i=t(57140);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);